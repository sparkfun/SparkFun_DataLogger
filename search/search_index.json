{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"<p>Placeholder file for index redirect functionality.</p>"},{"location":"adv-system-update/","title":"System Update","text":"<p>This sections outline methods to update the firmware on the DataLoggerIoT.</p> <p>When this menu item is selected, the following menu is presented:</p> <p></p> <p>System Update Menu</p> <p>The following functionality is available from this menu:</p>"},{"location":"adv-system-update/#functions","title":"Functions","text":""},{"location":"adv-system-update/#device-restart","title":"Device Restart","text":"<p>This option is used to restart the device. When selected, the user is prompted to validate the selection. If <code>Y</code> is entered, the device is restarted.</p>"},{"location":"adv-system-update/#factory-reset","title":"Factory Reset","text":"<p>A factory reset will move the boot firmware of the device to the firmware imaged installed at the factory and erase any on-board stored settings on the device. This is helpful if an update fails, or an update has issues that prevent proper operations.</p> <p>When selected, the user is presented a prompt to continue. To launch a factory reset, the value of <code>Y</code> should be entered. To abort the update, enter <code>n</code> or press the <code>Esc</code> key.</p> <p></p> <p>When a <code>Y</code> is entered, the system performs the following:</p> <ul> <li>Set the boot image to the Factory installed firmware</li> <li>Erase any settings stored in the on-board flash memory</li> <li>Reboot the device</li> </ul> <p></p> <p>Once complete, the DataLoggerIoT is running the original firmware it shipped with. To update to a later version, the <code>Firmware Update</code> options of this menu are used.</p>"},{"location":"adv-system-update/#update-firmware-sd-card","title":"Update Firmware - SD Card","text":"<p>This action enables the ability to update the onboard firmware to an image file contained an SD card. This user is presented a list of available firmware images files contained in root directory of the on-board SD card, and updates the board to the selected file.</p> <p>To download the latest firmware and update through the microSD card, you will need to head to the GitHub repository containing the firmware. Select the firmware version and download.</p> <p>Once downloaded, insert the microSD card into a card reader or USB adapter. Then move the files into the memory card's root directory. Below shows an image of v01.00.01 and v01.00.02 on a Windows OS.</p> <p></p> <p>Once the files are copied to the memory card, eject the microSD card from your computer. Insert the card back into the DataLogger IoT's microSD card socket. Connect the DataLogger IoT to your computer using a USB cable and bring up the DataLoggerIoT menu system and navigate to the <code>System Update</code> options.</p> <p>To update from the SD card, select the <code>Update Firmware - SD Card</code> entry. The system will now list available firmware versions to update to.</p> <p></p> <p>Available Firmware Images on the SD Card</p> <p>The system will search the root directory of the on-board SD card for available firmware files. The firmware files are selected using the following criteria:</p> <ul> <li>The file is contained in the root \"/\" folder of the SD card.</li> <li>The filename has a \".bin\" extension.</li> <li>The filename starts with a specified name prefix. The prefix is optional and is set by the developers at SparkFun using this action.</li> </ul> <p>Once a file is selected, the system new firmware is read off the SD card and written to the device. When complete, the system is restarted using the new firmware image.</p> <p></p> <p>Firmware Updating from SD Card</p>"},{"location":"adv-system-update/#update-firmware-ota","title":"Update Firmware - OTA","text":"<p>This action enables the ability to update the onboard firmware to an image file contained on an update server, which is accessed via the WiFi network the system is connected to. This Over-The-Air (OTA) capability contacts the systems update server and searches for newer firmware (later version) for the specific board.</p> <p>When this option is selected, the system will contact the update server and search for available upgrade firmware, selecting the latest version available. If a newer version is found, a prompt is presented to confirm the upgrade.</p> <p></p> <p>NOTE For the upgrade option to occur, a the system must be connected to a network and have access to the firmware OTA server.</p> <p>Typing <code>Y</code> (or hitting enter) starts the update operation. As the firmware is downloaded, the percent complete status is updated. If connectivity fails during the download, the operation is halted and the update aborted.</p> <p></p> <p>Once the update file is downloaded, it is verified as being the correct file. Once verified, the system is rebooted and starts using the new firmware image. You will notice the firmware version change as the DataLogger IoT initializes.</p> <p></p>"},{"location":"adv-system-update/#if-the-firmware-is-overwritten-by-an-arduino-sketch","title":"If the Firmware is overwritten by an Arduino Sketch","text":"<p>Flashing an Arduino sketch to a DataLogger IoT board removes the ability for easy firmware updates and will require a full low-level flash of the latest software, which includes the bootloader and partition map for the device. These files are now provided as part of the DataLogger IoT firmware updates.</p> <p>To perform this level of update, please view the Build and Update Instructions</p>"},{"location":"contribute/","title":"Contribute","text":""},{"location":"contribute/#contribute","title":"Contribute","text":""},{"location":"contribute/#improve-our-documentation","title":"Improve our Documentation","text":"<p>All of this documentation can be modified by you! Please help us make it better.</p> <ul> <li>These pages are contained in the <code>docs</code> folder of the SparkFun DataLogger IoT repository.</li> </ul>"},{"location":"contribute/#submit-a-correction","title":"Submit a Correction","text":"<ol> <li>Fork this repo</li> <li>Add your corrections or improvements to the markdown file</li> <li>File a pull request with your changes, and enjoy making the words worlds world a better place.<ul> <li>Once received, the documentation specialist will automatically be notified.</li> <li>We will review your suggested improvements to make sure they are correct and fit within our documentation standards.</li> </ul> </li> </ol>"},{"location":"contribute/#improve-our-hardware-design","title":"Improve our Hardware Design","text":"<p>This hardware design is open-source! Please help us make it better.</p> <ul> <li>Our board design files are contained in the <code>Hardware</code> folder of the SparkFun DataLogger IoT repository.</li> </ul>"},{"location":"contribute/#submit-a-design-improvement","title":"Submit a Design Improvement","text":"<ol> <li>Fork this repo</li> <li>Add your design improvements</li> <li>File a pull request with your changes, and enjoy making the words worlds world a better place.<ul> <li>Once received, the engineer in charge of the original design will automatically be notified.</li> <li>We will review your suggested improvements, if they are within our board design standards and meet our product design requirements, we will flag these changes for our next board revision. (Please note, that even if your suggestion is accepted, these changes may not be immediate. We may have to cycle through our current product inventory first.)</li> </ul> </li> </ol>"},{"location":"factory_reset/","title":"Factory Reset","text":""},{"location":"factory_reset/#factory-reset","title":"Factory Reset","text":"<p>A factory reset will move the boot firmware of the device to the firmware imaged installed at the factory and erase any on-board stored settings on the device. This is helpful if an update fails, or an update has issues that prevent proper operations.</p> <p>This option is available on ESP32 devices that contained a factory firmware partition that contains a bootable firmware image. Consult the specific product's production and build system for further details.</p> <p>Open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to  115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then type <code>16</code> to enter the System Update Menu. Finally, type <code>2</code> to enter the Factory Reset option.</p> <p>The user is presented a prompt to continue. To launch a factory reset, the value of <code>Y</code> should be entered. To abort the update, enter <code>n</code> or press the <code>Esc</code> key.</p> <p></p> <p>When a <code>Y</code> is entered, the system performs the following:</p> <ul> <li>Set the boot image to the Factory installed firmware</li> <li>Erase any settings stored in the on-board flash memory</li> <li>Reboot the device</li> </ul> <p></p>"},{"location":"file_issue/","title":"Submit Issues","text":""},{"location":"file_issue/#submitting-an-issue-or-suggestion","title":"Submitting an Issue or Suggestion","text":""},{"location":"file_issue/#support","title":"Support","text":"<p>If you need technical assistance and more information on a product that is not working as you expected, visit the SparkFun Community. The community forums are monitored by the SparkFun Technical Support Team and the SparkFun community as a whole.</p>"},{"location":"file_issue/#existing-issue","title":"Existing Issue","text":"<p>Spot something wrong? Please check the list of reported and fixed issues  .  in this repository.</p>"},{"location":"file_issue/#discrepancies-in-the-documentation","title":"Discrepancies in the Documentation","text":"<p>All of this documentation can be modified by you! Please help us make it better.</p> <ul> <li>The documentation files for these pages are contained in the <code>docs</code> folder of the SparkFun DataLogger IoT repository.</li> </ul>"},{"location":"file_issue/#spot-something-wrong","title":"Spot something wrong?","text":"<p>If a section of the documentation is incorrect, please open an issue and let us know.</p>"},{"location":"file_issue/#do-you-have-a-suggested-correction","title":"Do you have a suggested correction?","text":"<ol> <li>With a GitHub account, fork this repo</li> <li>Add your correction(s) or improvement(s) to the markdown file(s)</li> <li>File a pull request with your changes, and enjoy making the words worlds world a better place.<ul> <li>Once received, the documentation specialist will automatically be notified.</li> <li>We will review your suggested improvement(s) to make sure they are correct and fit within our documentation standards.</li> </ul> </li> </ol>"},{"location":"file_issue/#problems-in-the-hardware-design","title":"Problems in the Hardware Design","text":"<p>All of our designs are open-source! Please help us make it better.</p> <ul> <li>Our board design files are contained in the <code>Hardware</code> folder of the SparkFun DataLogger IoT repository.</li> </ul>"},{"location":"file_issue/#does-something-not-make-sense","title":"Does something not make sense?","text":"<p>If part of the design is confusing, please open an issue and let us know.</p>"},{"location":"file_issue/#did-we-forget-to-include-an-important-function-of-the-board","title":"Did we forget to include an important function of the board?","text":"<p>Please keep in mind that we may intentionally exclude certain functions of the board to meet our product design requirements.</p> <p>If part of the board's functionality is missing, please open an issue and file a feature request.</p>"},{"location":"file_issue/#do-you-wish-to-contribute-directly-to-improving-the-board-design","title":"Do you wish to contribute directly to improving the board design?","text":"<ol> <li>With a GitHub account, Fork this repo</li> <li>Add your design improvement(s)</li> <li>File a pull request with your changes, and enjoy making the words worlds world a better place.<ul> <li>Once received, the engineer in charge of the original design will automatically be notified.</li> <li>We will review your suggested improvement(s), if they are within our board design standards and meet our product design requirements, we will flag these changes for our next board revision. (Please note, that even if your suggestion is accepted, these changes may not be immediate. We may have to cycle through our current product inventory first.)</li> </ul> </li> </ol>"},{"location":"gen-app-set/","title":"Application Settings","text":"<p>The following settings are presetented in the General &gt; Application Setting menu of the settings.</p> <p>When the selected, the following menu is presented:</p> <p></p> <p>The following provides an overview of each setting in this menu.</p>"},{"location":"gen-app-set/#settings","title":"Settings","text":""},{"location":"gen-app-set/#led-enabled","title":"LED Enabled","text":"<p>Used to control if the on-board RGB LED is enabled or disabled.</p>"},{"location":"gen-app-set/#menu-timeout","title":"Menu Timeout","text":"<p>The settings menu will timeout - exit to the previous level - if no input is provided within the specified timeout period. The default value is 60 seconds.</p>"},{"location":"gen-app-set/#color-output","title":"Color Output","text":"<p>The menu system of the DataLoggerIoT can user color to highlight specific elements of the menu textual output. This option controls if color is enabled or not. This value is enabled by default</p>"},{"location":"gen-app-set/#board-name","title":"Board Name","text":"<p>Set this value to the name of the specific board.</p>"},{"location":"gen-app-set/#output","title":"Output","text":""},{"location":"gen-app-set/#sd-card-format","title":"SD Card Format","text":"<p>Set the format to use when writing data to the SD Card - <code>CSV Format</code> and <code>JSON Format</code> are supported.</p>"},{"location":"gen-app-set/#serial-console-format","title":"Serial Console Format","text":"<p>Set the format to use when writing data to the Serial Console - <code>CSV Format</code> and <code>JSON Format</code> are supported.</p>"},{"location":"gen-app-set/#json-buffer-size","title":"JSON Buffer Size","text":"<p>When building JSON output, a string buffer is allocated and used. This setting is used to adjust the size of this buffer.</p> <p>If the buffer size is exceeded, a non-valid JSON value is output by the system.</p> <p>Note</p> <p>The runtime maximum use size of the buffer is output in the <code>about</code> screen of the DataLoggerIoT. This is helpful in adjusting the size of the buffer.</p>"},{"location":"gen-app-set/#terminal-baud-rate","title":"Terminal Baud Rate","text":"<p>The baud rate used when connected to a Serial Terminal application.</p> <p>When changed, the DataLoggerIoT must restart of the setting to take effect.</p> <p>Note</p> <p>Once the baud rate is change, the baudrate on the serial termainal application will also require updating</p>"},{"location":"gen-app-set/#sleep","title":"Sleep","text":""},{"location":"gen-app-set/#enable-system-sleep","title":"Enable System Sleep","text":"<p>If enabled, the DataLogger IoT will enter a sleep mode for a set number seconds between data recording. This setting can be used to reduce the overall power consumption of the DataLoggerIoT device when powered by a battery.</p> <p>When this feature is enabled, the DataLoggerIoT will <code>sleep</code> for <code>Sleep Interval</code> seconds, then <code>wake</code> to sample data for <code>Wake Interval</code> seconds. This cycle continues until the setting is changed.</p>"},{"location":"gen-app-set/#sleep-interval-sec","title":"Sleep Interval (sec)","text":"<p>The number of seconds the DataLoggerIoT sleeps</p>"},{"location":"gen-app-set/#wake-interval","title":"Wake Interval","text":"<p>The number of seconds the DataLoggerIoT samples data. Once this period ends, the system enters sleep mode</p>"},{"location":"gen-app-set/#advanced","title":"Advanced","text":""},{"location":"gen-app-set/#start-messages","title":"Start Messages","text":"<p>This setting allows adjustment of the amount of messages output during startup.</p> <p>The messages levels are:</p> <ul> <li>Normal - all messages are shown.</li> <li>Compact - a minimal set of messages are output.</li> <li>Disabled - no startup messages are output.</li> </ul>"},{"location":"gen-app-set/#startup-delay","title":"Startup Delay","text":"<p>When the DataLogger IoT starts, a <code>startup menu</code> is shown for a specific amount of time. This setting is used to set the time period the menu is dispalyed.</p> <p>If set to <code>0</code>, the menu is not shown.</p>"},{"location":"gen-app-set/#device-names","title":"Device Names","text":"<p>If enabled, Device Names will also include the device address. This is helpful if two devices of the same type are connected to the DataLoggerIoT.</p>"},{"location":"gen-app-set/#verbose-messages","title":"Verbose Messages","text":"<p>If enabled, additional informational and debug messages are output to the console during DataLoggerIoT operation</p>"},{"location":"gen-app-set/#functions","title":"Functions","text":""},{"location":"gen-app-set/#about","title":"About...","text":"<p>When selected, the about page is displayed for the DataLoggerIoT.</p>"},{"location":"gen-save-settings/","title":"Save Settings","text":"<p>Used to save, restore and manage the system settings.</p> <p>In the Save Settings Menu, users will be able to save, restore, or clear any preferences in memory (i.e. persistent storage) or a saved file to a fallback device (i.e. microSD card). Note that any passwords and secret keys are not saved in the save settings file. You will need to manually enter those values in the file saved on the microSD card.</p> <p>When this item is selected, the following menu is prestned.</p> <p></p> <p>Save Settings  Menu</p>"},{"location":"gen-save-settings/#settings","title":"Settings","text":"<p>The available settings:</p>"},{"location":"gen-save-settings/#fallback-restore","title":"Fallback Restore","text":"<p>When this settings is enabled, if a normal setting restore operation fails on startup, a back source (JSON file) is used.</p> <p>This is often used to restore backup settings when you reset the datalogger.</p>"},{"location":"gen-save-settings/#fallback-save","title":"Fallback Save","text":"<p>When enabled, when settings are saved to on-board storage, they are also saved to a JSON file located on the systems SD card.</p>"},{"location":"gen-save-settings/#json-file-buffer-size","title":"JSON File Buffer Size","text":"<p>The internal buffer used to I/O of the setting values.</p>"},{"location":"gen-save-settings/#functions","title":"Functions","text":"<p>The following functions/actions are available in this menu:</p>"},{"location":"gen-save-settings/#save-settings_1","title":"Save Settings","text":"<p>When called, the current settings are save to persistent, on-device storage.</p>"},{"location":"gen-save-settings/#restore-settings","title":"Restore Settings","text":"<p>Setting value are restored from on-device persistent storage.</p>"},{"location":"gen-save-settings/#clear-settings","title":"Clear Settings","text":"<p>Erases settings stored on the device.</p> <p>This action does not reset the current live settings of the system. Do do this, restart the system immediatly after calling this action.</p>"},{"location":"gen-save-settings/#save-to-fallback","title":"Save to Fallback","text":"<p>Save the current setting values to the fallback setting system - a JSON file on the SD card.</p>"},{"location":"gen-save-settings/#restore-from-fallback","title":"Restore from Fallback","text":"<p>When called, and a settings JSON file is available on the SD card, the settings on the SD card are restored and applied to the system.</p>"},{"location":"gen-save-settings/#editing-the-fallback-json-file","title":"Editing the Fallback JSON File","text":"<p>If you have the Fallback Save enabled or selected the option Save to Fallback, you will notice an additional file called datalogger.json saved in the microSD card. This is the fallback file that is saved. Using a text editor, you can edit this file to adjust the settings or provide WiFi credentials, certificates, and keys. These values can then easily be restore for use by the system.</p>"},{"location":"gen-time-setup/","title":"Time Setup","text":"<p>In the Settings Menu, select the time reference sources. As of firmware v01.01.01, time zone support is at the clock level, not tied to NTP. The option to adjust the Time Zone is moved to the Time Sources menu.</p> <p></p> <p>Time Source Menu</p> <p>In this menu, you will have options to update the primary reference clock, update interval, add a secondary reference clock, and update it's interval.</p> <p>By default, the primary reference clock is set to use the Network Time Protocol (NTP). To synchronization the time, you will need to connect to a 2.4GHz WiFi network in order to update the time.</p> <p>To add a secondary clock, make sure to connect a compatible Qwiic-enabled devices that can keep track of time (i.e. Qwiic Real Time Clock Module - RV-8803 or a Qwiic-enabled u-blox GNSS module).</p>"},{"location":"gen-time-setup/#time-configuration","title":"Time Configuration","text":"<p>The following settings are available:</p>"},{"location":"gen-time-setup/#the-time-zone","title":"The Time Zone","text":"<p>The timezone to use for <code>local time</code> for the DataLoggerIoT.</p> <p>To adjust the time zone, you will need to enter a POSIX timezone string variable. Try checking out this CSV in this GitHub repo and searching for the timezone string variable in your area. For more information about POSIX format specification check out this article from IBM.</p>"},{"location":"gen-time-setup/#reference-clock","title":"Reference Clock","text":"<p>The <code>time source</code> the DataLoggerIoT uses for time values.</p>"},{"location":"gen-time-setup/#update-interval","title":"Update Interval","text":"<p>The time interval in minutes that the reference clock is used to update the DataLoggerIoT clock. Note - for an NTP source, this is handled automatically by the ESP32 platform.</p>"},{"location":"gen-time-setup/#enable-clock-fallback","title":"Enable Clock Fallback","text":"<p>If enabled, another clock source is used if the primary source is not available.</p> <p>An example of this is when a network failure occurs and NTP is not available. In this case, a fallback time source (like an RTC) is used for time values.</p>"},{"location":"gen-time-setup/#dependant-interval","title":"Dependant Interval","text":"<p>The interval in minutes used to update from the dependant clock. If <code>0</code>, the dependant clock is not used.</p>"},{"location":"gen-time-setup/#update-connected","title":"Update Connected","text":"<p>If enabled, connected clocks are updated when the main system clock is updated.</p>"},{"location":"gen-time-setup/#alternative-time-sources","title":"Alternative Time Sources","text":"<p>As an alternative to using the NTP, users can also add a compatible Qwiic-enabled device that can keep track of time (i.e. Qwiic Real Time Clock Module - RV-8803 or a Qwiic-enabled u-blox GNSS module). These can be set as the primary or secondary clock.</p> <p></p> <p>U-Blox GNSS Module Attached Via Qwiic</p> <p></p> <p>Qwiic Real Time Clock Module - RV-8803 Attached Via Qwiic</p> <p>Once attached, you will be prompted with additional options to select a primary reference clock.</p> <p></p> <p>Clock Sources</p> <p>Note</p> <p>If you are using a u-blox GNSS module, make sure that you have enough satellites in view. The option to add or configure the GNSS will not be available if there are not enough satellites in view. If you are using the Qwiic Real Time Clock Module - RV-8803, you may need to go into the device settings to manually adjust the date and time.</p>"},{"location":"gnss-pps-log/","title":"GNSS PPS Logging Event","text":"<p>When a GNSS qwiic device with a PPS output is connected to the DataLoggerIoT, that PPS signal can trigger logging events.</p>"},{"location":"gnss-pps-log/#hardware-setup","title":"Hardware Setup","text":"<p>To enable PPS logging events, first connect the PPS output signal from the GNSS board being used to a supported pin on the DataLoggerIoT.  </p> <p>Supported pins are the following GPIO pins: 33 or 36.</p>"},{"location":"gnss-pps-log/#device-settings","title":"Device Settings","text":"<p>With the GNSS board connected to the DataLoggerIoT, start the datalogger and enter the menu system. Select <code>Device Settings</code> and then GNSS device.</p> <p></p> <p>When the GNSS device entry is selected, the following settings are presented:</p> <p>~GNSS Settings</p>"},{"location":"gnss-pps-log/#pss-logging","title":"PSS Logging","text":"<p>Set this setting to <code>true</code> to enable PPS logging by the datalogger.</p>"},{"location":"gnss-pps-log/#pps-pin","title":"PPS Pin","text":"<p>Set this to the value of the Pin that was connected to the PPS signal from the GNSS sensor.</p> <p></p>"},{"location":"gpio-analog-pin-sensor/","title":"Analog Pin Sensor","text":"<p>This menu item is used to enable the GPIO Analog Pin Device within the DataLoggerIoT. When enabled, an Analog Pin Reading device driver is added to the dataloggers Device Settings list.</p>"},{"location":"gpio-analog-pin-sensor/#enabling-the-analog-pin-sensor","title":"Enabling the Analog Pin Sensor","text":"<p>Once the analog device is connected to a supported gpio analog pin on the datalogger, the Analog Pin device is enabled using the <code>Analog Pin Sensor</code> menu item located under the GPIO Devices header. This is enabled using the following menu item:</p> <p></p> <p>Once enabled, a Analog Pin Reading device is added to the DataLogger IoT.</p> <p></p>"},{"location":"gpio-analog-pin-sensor/#analog-pin-reading-device","title":"Analog Pin Reading Device","text":"<p>The Analog Pin Reading device has the following menu:</p> <p></p>"},{"location":"gpio-analog-pin-sensor/#settings","title":"Settings","text":""},{"location":"gpio-analog-pin-sensor/#enable-this-sensor","title":"Enable this sensor","text":"<p>Used to enable the device</p>"},{"location":"gpio-analog-pin-sensor/#sensor-pin","title":"Sensor Pin","text":"<p>The datalogger GPIO pin to read the analog value from. This is the pin the external analog device is connected to.</p> <p>Value values for this are:</p> <ul> <li>A0</li> <li>A3</li> <li>A7</li> </ul> <p></p>"},{"location":"gpio-extern-serial/","title":"External Serial","text":"<p>This menu item is used to configure logging from an external serial device that is connected to the datalogger via GPIO pins.</p> <p>Selecting this option brings up the following menu:</p> <p></p>"},{"location":"gpio-extern-serial/#settings","title":"Settings","text":""},{"location":"gpio-extern-serial/#serial-settings","title":"Serial Settings","text":"<p>These settings define the parameters of the connected device.</p>"},{"location":"gpio-extern-serial/#rx-pin","title":"RX Pin","text":"<p>The GPIO pin on the DataLoggerIoT to use as the RX pin for communicating with the external device. The default pin is <code>16</code>.</p>"},{"location":"gpio-extern-serial/#tx-pin","title":"TX Pin","text":"<p>The GPIO pin on the DataLoggerIoT to use as the TX pin for communicating with the external device. The default pin is <code>17</code>.</p>"},{"location":"gpio-extern-serial/#baud-rate","title":"Baud Rate","text":"<p>Set this to the Baud Rate to use when communicating with the external device.</p>"},{"location":"gpio-extern-serial/#functionality","title":"Functionality","text":""},{"location":"gpio-extern-serial/#serial-input-device","title":"Serial Input Device","text":"<p>When enabled, the system create a \"Serial Input Device\" that is added as a device to the system. This device is used to read data from the external device via a Serial connection and is used just like any other device in the system.</p> <p></p>"},{"location":"gpio-extern-serial/#serial-device","title":"Serial Device","text":"<p>When the serial device is enabled, a \"Serial Device\" driver is added to the <code>Device List</code> of the DataLoggerIoT.</p> <p>Selecting this device from the <code>Device Settings</code> page of the menu system, brings up the following menu:</p> <p></p> <p>The device is fairly simple - you enable/disable it and when a log event occurs, any value available in the serial device is read as a string and output to the log stream.</p> <p>Additionally, when this device is enabled, when data is available from the serial device, a log event is triggered so that the data is read. This is done to prevent the underlying serial device buffer from overflowing.</p>"},{"location":"gpio-extern-serial/#settings_1","title":"Settings","text":""},{"location":"gpio-extern-serial/#enable","title":"Enable","text":"<p>Used to enable the device. When enabled, when data is available on the Serial device, it triggers a log event, which will read and log the data in the device.</p>"},{"location":"gpio-soil-moisture/","title":"Soil Mosture Sensor","text":"<p>The DataLoggerIoT can support reading values from a GPIO connected, resistive Soil Moisture sensor, like the SparkFun Soil Moisture Sensor. When connected to the datalogger, and enabled, the DataLoggerIoT will read the analog moisture value from the sensor and add that to the output log stream.</p>"},{"location":"gpio-soil-moisture/#enabling-the-soil-moisture-sensor","title":"Enabling the Soil Moisture Sensor","text":"<p>Once the sensor is attached to the DataLoggerIoT via GPIO pins, the Soil Moisture Sensor device is enabled using the 'Soil Moisture Sensor' menu item located under the GPIO Devices header.  This is enabled using the following menu item:</p> <p></p> <p>Once enabled, a Soil Moisture Device is added to the DataLoggerIoT.</p> <p></p>"},{"location":"gpio-soil-moisture/#soil-moisture-device","title":"Soil Moisture Device","text":"<p>The Soil Moisture Devide has the following menu:</p> <p></p>"},{"location":"gpio-soil-moisture/#settings","title":"Settings","text":""},{"location":"gpio-soil-moisture/#enable-this-sensor","title":"Enable this sensor","text":"<p>Used to enable the device.</p>"},{"location":"gpio-soil-moisture/#vcc-pin","title":"VCC Pin","text":"<p>The datalogger GPIO pin used for VCC to the soil moisture sensor. The default is <code>33</code>.</p>"},{"location":"gpio-soil-moisture/#sensor-pin","title":"Sensor Pin","text":"<p>The GPIO Pin to use as the Sensor Pin - the default value is <code>2</code>.</p>"},{"location":"gpio-soil-moisture/#calibration-dry-value","title":"Calibration Dry Value","text":"<p>The sensor value that represents a \"Dry\" state (0%). The default value is 0.</p>"},{"location":"gpio-soil-moisture/#calibration-wet-value","title":"Calibration Wet Value","text":"<p>The sensor value that represents a \"Wet\" state (100%). The default value is 1024.</p>"},{"location":"gpio-soil-moisture/#functions","title":"Functions","text":""},{"location":"gpio-soil-moisture/#calibrate-low-dry-value","title":"Calibrate Low (dry) Value","text":"<p>Place the sensor in a dry state and then run this function. The driver will set the curret value as the \"dry\" calibration value.</p>"},{"location":"gpio-soil-moisture/#calibrate-high-wet-value","title":"Calibrate High (wet) Value","text":"<p>Place the sensor in a wet state and then run this function. The driver will set the curret value as the \"wetl\" calibration value.</p>"},{"location":"hard_copy/","title":"Hard copy","text":"<p>Need to download or print our hookup guide?</p> <ul> <li>Print  (Single-Page View)</li> <li>To save as a <code>*.pdf</code> file, select the Printer or Destination labeled Save as PDF. (Instructions will vary based on the browser)</li> </ul>"},{"location":"hardware_hookup/","title":"Hardware Hookup","text":""},{"location":"hardware_hookup/#hardware-hookup","title":"Hardware - Hookup","text":"<p>In this section, we will go over how to connect to the SparkFun DataLogger IoT. At the time of writing, we used the DataLogger IoT - 9DoF. This hardware hookup explained in this section also applies for the DataLogger IoT.</p>"},{"location":"hardware_hookup/#soldering-to-the-pths","title":"Soldering to the PTHs","text":"<p>For users that are interested in soldering to the edge of the board, we recommend soldering headers to the PTHs on the breakout for a permanent connection and using jumper wires. Of course, you could also solder wires to the breakout board as well. For a temporary connection during prototyping, you can use IC hooks like these.</p>"},{"location":"hardware_hookup/#microsd-card","title":"MicroSD Card","text":"<p>If all you want to do is display your sensor readings in a serial terminal or monitor (connected via USB-C) then, strictly, you don\u2019t need to add a microSD card. But of course the whole point of the DataLogger IoT is that it can log readings from whatever sensors you have attached to microSD card. The data is logged in easy-to-read Comma Separated Value (CSV) text format by default. You can also set the format as JSON.</p> <p>You probably already have a microSD card laying around but if you need any additional units, we have plenty in the store. The DataLogger IoT can use any size microSD card as long as it is formatted correctly. Please ensure your SD card is formatted correctly. There are different software tools available. Some are built into your operating system. We recommend using the Raspberry Pi Imager Tool to easily format the memory card as FAT32 using the GUI. Flip over the DataLogger IoT and you\u2019ll see the latching microSD card socket. Slide in your formatted SD card and it will click neatly into place. Part of the edge of the SD card will stick out when fully inserted in the microSD card socket.</p> <p>SD Card Insertion and Removal</p> <p>Only insert or remove the SD card while the power is turned off or disconnected. Removal while in use could result in data corruption. Insertion is not detected when the DataLogger is powered on and running.</p> <p>After you\u2019ve logged some data, you will find a new file on your SD card. There may also be additional files if you manually saved the firmware or preferences to the memory card.</p> <ul> <li>sfe0001.txt: This is the file that contains the CSV or JSON sensor data. The format will depend on how you configured the DataLogger's output. We use .TXT as the file type so that your computer can open it in a simple text editor. The contents are all human-readable. But, if you want to, you can rename it as .CSV or .JSON instead. The file number is incremented for the next logging session.</li> <li>datalogger.json: This file only appears when you save the settings as your fallback storage. The file will include all preferences saved for any connected device, WiFi credentials, certificates, and keys.</li> <li>SparkFun_DataLoggerIoT*.bin: This file only appears when you save the firmware to the microSD card. Note that the asterisk (*) is the firmware version number (i.e. SparkFunDataLoggerIoT_01.00.01.bin).</li> </ul> <p>To remove the microSD card, make sure power is disconnected from the DataLogger IoT. Then press the microSD card into the microSD socket. The memory card will be ejected and you will hear a click again. Once the card is ejected, you can insert it into a microSD card adapter or USB reader to be read on a computer.</p>"},{"location":"hardware_hookup/#qwiic-sensors","title":"Qwiic Sensors","text":"<p>If you are going to attach extra sensors or any Qwiic-enabled device to the DataLogger IoT, then those need to be connected first before attaching a USB cable. It is a good idea to only attach or disconnect Qwiic sensors when the power is turned off or disconnected. The Qwiic bus is pretty tolerant to \u201chot swapping\u201d, but: disconnecting a sensor while it is in use will confuse the DataLogger IoT software (most likely each value associated with the device will remain constant); and a new sensor won\u2019t be detected until the firmware restarts.</p> <p>Plug one end of your Qwiic cable into the DataLogger IoT and plug the other end into your sensor. If you want to add extra sensors, you can simply connect them to each other in a daisy chain. You will need a Qwiic cable for each sensor. Our Qwiic Cable Kit covers all the options.</p> <p>DataLogger IoT and a Qwiic-Enabled Device</p> <p></p> <p>DataLogger IoT and several Qwiic-Enabled Devices Daisy Chained</p> <p></p> <p>Our Qwiic sensors usually all have power indicator LEDs and I<sup>2</sup>C pull-up resistors. Depending on your application, you may want or need to disable these by cutting the jumper links on the sensor circuit boards. We have a tutorial that will show you how to do that safely.</p> <p>Sometimes you might want to connect more than one of the same type of sensor to the DataLogger IoT. On the I<sup>2</sup>C bus, each device needs to have a unique address. On many of our boards, there are jumpers links which you can use to change the address and some have addresses that can be configured in software. But there are some where you cannot change the address - the NAU7802 Qwiic Scale being one example.</p> <p>Typically one would use a multiplexor. However, we currently do not have the DataLogger IoT configured to work with any multiplexors (i.e. Qwiic Mux Breakout).</p>"},{"location":"hardware_hookup/#lipo-battery","title":"LiPo Battery","text":"<p>Now is a good time to attach a LiPo battery, if you want the DataLogger IoT to keep logging when you disconnect USB-C.</p> <p></p> <p>You can connect one of our standard single cell LiPo batteries to the DataLogger IoT and power it for hours, days or weeks depending on what sensors you have attached and how often you log data. The DataLogger IoT has a built-in charger too which will charge your battery at 500mA when USB-C is connected. Please make sure your battery capacity is at least 500mAh (0.5Ah); bad things will happen if you try to charge our smallest batteries at 500mA. The yellow CHG charging LED will light up while the battery is charging and will go out once charging is complete.</p> <p>Warning</p> <p>Ensure that you use one of SparkFun's recommended Lithium Ion batteries. Some batteries use the same JST connector as SparkFun, but have the opposite polarity. Connecting one of these to your DataLogger IoT will destroy it. If using a non-SparkFun battery,  ensure it has the correct polarity.</p> <p>The MCP73831 charge IC on the board is used on a few SparkFun products. For more information about the CHG status LED, we recommend taking look at the Hardware Overview. We also recommend taking a look at this tutorial for Single Cell LiPo Battery Care.</p>"},{"location":"hardware_hookup/#usb-cable","title":"USB Cable","text":"<p>The USB-C connector provides power to the DataLogger IoT and acts as a serial interface for configuration and data display.</p> <p></p> <p>If you are going to use a microSD card to store your data, and why wouldn\u2019t you, then insert that first before attaching your USB cable. You should only insert or remove the SD card while the power is turned off or disconnected. Removing the card while the DataLogger IoT is logging will almost certainly corrupt your data.</p> <p>Likewise, it is a good idea to only attach or disconnect Qwiic sensors when the power is turned off or disconnected. The Qwiic bus is pretty tolerant to \u201chot swapping\u201d, but: disconnecting a sensor while it is in use will confuse the DataLogger IoT software; and a new sensor won\u2019t be detected until the firmware restarts.</p> <p>Depending on what ports your computer has available, you will need one of the following cables:</p> <ul> <li>USB 2.0 A to C Cable</li> <li>USB 3.1 A to C Cable</li> <li>USB 2.0 C to C Cable</li> </ul> <p>Use the cable to connect your DataLogger IoT to your computer and you will see the LEDs light as the DataLogger IoT starts up. The addressable RGB RGB LED will light up green for a second or two while the DataLogger IoT configures itself. It will flash blue while data is being logged to the microSD card. If you have jumped the gun and have a LiPo battery already connected, the yellow CHG charging LED may light up too.</p> <p>If the addressable RGB LED does not light up, your DataLogger IoT is probably in deep sleep following a previous logging session. Pressing the RST reset button will wake it.</p> <p>You\u2019ll find full instructions on how to configure the DataLogger IoT later in this tutorial.</p>"},{"location":"hardware_hookup/#standoffs","title":"Standoffs","text":"<p>For users interested in stacking the Qwiic-enabled device on the DataLogger IoT or mounting in an enclosure, you will need some standoffs to mount the boards. When mounting, note that all four mounting holes are not positioned exactly for a 1.0\"x1.0\" sized Qwiic board. Only two of the four mounting holes are compatible for a 1.0\"x1.0\" sized Qwiic board. For example the image below shows the boards stacked on each side of the DataLogger IoT. On top, the Qwiic GPS (SAM-M10Q) breakout was also able to stack by rotating the board slightly and aligning the mounting holes on the 1.6\"x1.6\" sized board to the other mounting holes</p> <p></p>"},{"location":"hardware_overview/","title":"Hardware Overview","text":""},{"location":"hardware_overview/#hardware-overview","title":"Hardware - Overview","text":"<p>In this section, we will highlight the hardware and pins that are broken out on the SparkFun DataLogger IoT. At the time of writing, we highlighted the SparkFun DataLogger IoT - 9DoF. However, this also applies for the SparkFun DataLogger IoT.</p> <p></p> <p>DataLogger IoT - 9DoF</p> <p>The SparkFun DataLogger is pretty much the same with the exception of the following features listed below. We'll include notes highlighting the differences in each section.</p> <ul> <li>No built - in 6DoF IMU - ISM330DHCX</li> <li>No built - in magnetometer - MMC5983</li> <li>The addressable RGB LED - WS2812 is replaced with the side emitting addressable RGB LED - B3DQ3BRG</li> <li>No IMU INT2 jumper</li> <li>No Mag INT jumper</li> <li>Included MEAS PTH Jumper</li> <li>The \"35 / A7\" PTH on the edge of the board is replace with a \"5\" PTH.</li> </ul> <p></p> <p>DataLogger IoT</p>"},{"location":"hardware_overview/#esp32-wroom-module","title":"ESP32-WROOM Module","text":"<p>The DataLogger IoT is populated with Espressif's ESP32-WROOM-32E module. Espressif's ESP32 WROOM ubiquitous IoT microcontroller is a powerful WiFi, BT, and BLE MCU module that targets a wide variety of applications. For the DataLogger IoT, the firmware currently utilizes the WiFi feature.</p> <p></p> <p>ESP32 WROOM Module on the DataLogger</p>"},{"location":"hardware_overview/#power","title":"Power","text":"<p>There are a variety of power and power-related nets broken out to connectors and through hole pads. Below list a few methods of powering the board up. There are protection diodes for the USB-C, 5V pin, and single cell LiPo battery. Power is regulated down to 3.3V for the system voltage.  Depending on the settings and what is connected to the DataLogger IoT, the board can pull a minimum of 200\u00b5A in low power mode by itself.</p> <ul> <li>USB-C</li> <li>5V Pin</li> <li>Single Cell LiPo Battery</li> <li>3V3 Pin</li> </ul>"},{"location":"hardware_overview/#usb-c-and-5v","title":"USB-C and 5V","text":"<p>The DataLogger IoT comes equipped with a USB type C socket which you can use to connect it to your computer to view the output and configuration through the serial terminal, or plug in a USB-C power supply. The DataLogger IoT includes the configuration channel resistors needed to tell the power supply to deliver 5V. You can use your USB-C laptop charger as the power source should you need to, even though it normally delivers a much higher voltage.</p> <p>There is also a 5V power input pin. You can use this to feed in 5V power from an external source. The maximum voltage is 6.0V. The 5V pin is diode-protected and so is the USB-C power input, so it is OK to have both connected at the same time. This pin is ideal if you want to power your DataLogger from regulated solar power or a different type of power supply. You can not use the 5V pin as an output.</p> <p></p> <p>DataLogger IoT Power- USB-C and 5v</p> <p>Voltage from the USB is regulated down to the XC6222 3.3V/700mA voltage regulators for the system voltage and Qwiic-enabled devices. USB power is also connected to the MCP73831 to charge a single cell LiPo battery at a default rate of 500mA.</p> <p>For customers in North America, our NEMA Raspberry Pi Wall Adapter is a perfect choice. You can power the DataLogger IoT from our USB Battery Pack / Power Bank - TOL-15204 but you will need a USB-C cable too:</p> <ul> <li>Our USB 2.0 A to C Cable - CAB-15092 will do nicely</li> <li>Our USB 3.1 A to C Cable - CAB-14743 is a good choice too</li> </ul>"},{"location":"hardware_overview/#lipo-battery-input-charger-and-fuel-gauge","title":"LiPo Battery Input, Charger, and Fuel Gauge","text":"<p>But of course you\u2019re going to want to use the DataLogger IoT to log sensor data while on the move too. You can connect one of our standard single cell LiPo batteries to the DataLogger IoT and power it for hours, days or weeks depending on what sensors you have attached and how often you log data.</p> <p>The DataLogger IoT uses the built-in MCP73831 charger too which will charge your battery at 500mA when USB-C is connected. Please make sure your battery capacity is at least 500mAh (0.5Ah).</p> <p>The board also includes the MAX17048 LiPo Fuel Gauge which allows you to determine how much power your LiPo battery has available.</p> <p>The 2-pin JST connector pins are broken out to PTHs on the edge of the board if you decide to solder a single cell LiPo battery directly to the board or power another device.</p> <p>Battery Polarity</p> <p>Make sure that you use one of our recommended Lithium Ion batteries. Some batteries use the same JST connector as ours but have theopposite polarity. Connecting one of these to your DataLogger IoT will destroy it. If you are going to use your own battery, it is up to you to ensure it has the correct polarity.</p> <p></p> <p>LiPo Charger, Fuel Guage and Battery Connections</p>"},{"location":"hardware_overview/#3v3-pins","title":"3V3 Pins","text":"<p>For those going the old school route, you can also bypass the voltage regulators by soldering directly to the 3V3 and GND pin to provide power if your application has a regulated 3.3V. Note that this is only connected to the system voltage. You will also need to provide power to the 3V3 SWCH or Qwiic-enabled devices should you decide to bypass the voltage regulator.</p> <p></p> <p>3.3V Voltage Regulators, PTHs, and Qwiic Connectors</p>"},{"location":"hardware_overview/#ch340-usb-to-serial-converter","title":"CH340 USB-to-Serial Converter","text":"<p>The top side of the board includes a CH340 USB-to-Serial Converter. The chip can be used to send serial data between the device and computer. You can view the output or configure the device through a serial terminal.</p> <p></p> <p>CH340 USB-to-Serial Converter IC</p> <p>The driver should automatically install on most operating systems. However, there is a wide range of operating systems out there. You may need to install drivers the first time you connect the chip to your computer's USB port or when there are operating system updates. For more information, check out our How to Install CH340 Drivers Tutorial.</p>"},{"location":"hardware_overview/#uart","title":"UART","text":"<p>The hardware serial UART pins are broken out on the edge of the board. For more information about Serial UART, check out the tutorial about Serial Communication for more information.</p> <ul> <li>TXD: UART transmit pin. This is connected to pin <code>16</code>.</li> <li>RXD: UART receive pin. This is connected to pin <code>17</code>.</li> </ul> <p></p> <p>UART Pins Highlighted On The DataLogger IoT</p>"},{"location":"hardware_overview/#qwiic","title":"Qwiic","text":"<p>SparkFun's Qwiic Connect System uses 4-pin JST style connectors to quickly interface development boards with I<sup>2</sup>C sensors and more. No soldering required and there's no need to worry about accidentally swapping the SDA and SCL wires. The Qwiic connector is polarized so you know you\u2019ll have it wired correctly every time, right from the start. Qwiic boards are daisy chain-able too so you can connect multiple sensors to the DataLogger IoT and log readings from all of them.</p> <p>Vertical qwiic Connector</p> <p>You may notice a thin film over the vertial Qwiic connector. This is used by a pick-and-place machine when populating the component on the board before it goes through the reflow oven. Remove this film before using the vertical qwiic connector</p> <p>The board is populated with vertical and horizontal Qwiic connectors. These are also broken out to PTHs on the edge of the board.</p> <p></p> <p>Qwiic Connector And I2C PTH Highlighted</p> Pin Description SCL I<sup>2</sup>C clock pin. This is connected to pin <code>22</code> and a 2.2k\u03a9 pull-up resistor. SDA I<sup>2</sup>C data pin. This is connected to pin <code>21</code> and a 2.2k\u03a9 pull-up resistor. 3V3 SW The 3.3v pin is connected to the XC6222 voltage regulator's output to power the Qwiic devices. GND Common, ground voltage (0V reference) for the system <p>Connected to the line I<sup>2</sup>C line is the MAX17048 LiPo fuel gauge (7-bit unshifted address = 0x36).</p> <p>Sometimes you might want to connect more than one of the same type of sensor to the DataLogger IoT. On the I<sup>2</sup>C bus, each device needs to have a unique address. On many of our boards, there are jumpers links which you can use to change the address and some have addresses that can be configured in software. But there are some where you cannot change the address. Typically, one would use a multiplexor. However, we currently do not have the DataLogger IoT configured to work with any multiplexors (i.e. Qwiic Mux Breakout).</p> <p>The DataLogger IoT includes a dedicated 3.3V regulator for the Qwiic connector. This has several advantages including:</p> <ul> <li>The DataLogger IoT can completely power-down the I<sup>2</sup>C sensors during sleep to prolong your battery life</li> <li>There\u2019s no risk of the Qwiic bus gulping too much current and causing problems for the ESP32</li> </ul>"},{"location":"hardware_overview/#spi","title":"SPI","text":"<p>The SPI pins are broken out on the edge of the board. For those that are unfamiliar to PICO and POCI, check out the SPI tutorial for more information.</p> Pin Description SCK SPI clock pin. This is connect to pin <code>18</code>. PICO SPI Peripheral In Controller Out. This is connected to pin <code>23</code>. POCI SPI Peripheral Out Controller In. This is connected to pin <code>19</code>. <p></p> <p>SPI Pins Highlighted</p> <p>Not shown in the image are the chip select (CS) pins. The 6DoF IMU's CS pin is connected to pin <code>5</code>. The magnetometer's CS pin is connected to pin <code>27</code> which is not broken out.</p> <p>On the DataLogger IoT, the IMU and magnetometer are not connected to the SPI port since they are not included on the board. Instead of pin \"35 / A7\" being broken out, pin \"5\" is broken out on the edge of the board.</p> <p></p> <p>Pin 5 Highlighted on the DataLogger IoT</p>"},{"location":"hardware_overview/#microsd-card-socket","title":"MicroSD Card Socket","text":"<p>The DataLogger IoT supports full 4-bit SDIO for fast logging and uses common microSD cards to record clear text, comma separated files. Flip over the DataLogger IoT and you'll see the latching microSD card socket. You probably already have a microSD card laying around. However, if you need any additional units, we have plenty in the SparkFun catalog. The DataLogger can use any size microSD card and supports FAT32 cards in addition to FAT16. Please ensure that your SD card is formatted correctly; we recommend the Raspberry Pi Imager Tool.</p> <p></p> <p>MicroSD Card</p> <p>Slide in your formatted SD card and it will click neatly into place. The edge of the SD card will stick out on the edge of the circuit board when it is inserted correctly.</p> <p>You should only insert or remove the SD card while the power is turned off or disconnected. Removing the card while the DataLogger IoT is logging will almost certainly corrupt your data.</p>"},{"location":"hardware_overview/#datalogger-iot-9dof-9-degrees-of-freedom","title":"DataLogger IoT - 9DoF (9 Degrees of Freedom)","text":"<p>As stated earlier, included on every DataLogger IoT - 9DoF is a 6DoF Inertial Measurement Unit (IMU) for built-in logging of triple-axis accelerometer and gyro. There is also a built-in triple-axis magnetometer for a complete 9 degrees of freedom. Beside each IC is a silkcreen showing the reference axis. Both are connected to the ESP32 via the SPI port. Combined, you have 9 degrees of inertial measurement! Whereas the original 9DOF Razor used the old MPU-9250, this uses the ISM330DHCX and MMC5983MA. Oh, and if that wasn\u2019t enough, it comes with a built-in temperature sensor on each IC too. So if you want to use the DataLogger IoT as a transportation logger, it will do that straight out of the anti-static bag!  </p> <p></p> <p>DataLogger IoT - 9DOF - Accelerometer, Gyro, and Magnetometer</p>"},{"location":"hardware_overview/#analog-pins","title":"Analog Pins","text":"<p>There are three 12-bit analog pins available and broken out on edge of the board.</p> Pin Description 36 / A0 Analog A0. This is connected to pin <code>36</code>. 39 / A3 Analog A3. This is connected to pin <code>39</code>. 35 / A7 Analog A7. This is connected to pin <code>35</code>. <p></p> <p>Analog Pins Highlighted</p>"},{"location":"hardware_overview/#reset-and-boot-buttons","title":"Reset and Boot Buttons","text":"<p>There are two buttons available on the board for reset and boot. These are also broken out on the edge of the board as PTHs. If you have your DataLogger IoT mounted in an enclosure, you can also attach an external boot or reset switch too. Any Single Pole Normally-Open Push-To-Close momentary switch will do. Solder pin headers or wires to the RST and GND breakout pins and connect your external switch to those.</p> Button Description RESET Pressing this button will pull the pin LOW and reset the program running on the ESP32 without unplugging the board. BOOT The boot button usually allows users to force the ESP32 into bootloader mode to manually flash new firmware to the ESP32. The ESP32 will remain in this mode until there is a power cycle or the reset button is pressed. As of firmware v01.00.02, this button has an extra function: pressing down on the user button for 20 seconds will erase on-board preference storage and restart the board. This is connected to pin <code>0</code> on the ESP32. <p></p> <p>Reset and Boot Buttons (and Associated PTHs) Highlighted</p> <p>Note</p> <p>You may notice a thin film over buttons. This is used by a pick-and-place machine when populating the component on the board before it goes through the reflow oven. This can be removed.</p> <p>Like other ESP32 development boards, these buttons are populated so that users can place the ESP32 module in bootloader mode. For users that need to place the board in bootloader mode when powered, you will need to:</p> <p>1) Press the BOOT button. 1) While holding on the BOOT button, press the RESET button momentarily. 1) Finally, release the BOOT button.</p> <p>Most of the time, users will simply have the board executing the firmware that is loaded on the ESP32 module and updating through the configuration menu either through the microSD card or OTA.</p>"},{"location":"hardware_overview/#overwriting-the-build-in-firmware","title":"Overwriting the Build-In Firmware","text":"<p>Please think very carefully before uploading any Arduino sketches to your DataLogger IoT.</p> <p>Uploading Arduino Sketches</p> <p>You will overwrite the DataLogger IoT firmware, leaving it unable to update or restore itself.</p> <p>The DataLogger IoT comes pre-programmed with amazing firmware which can do so much. It is designed to be able to update itself and restore itself if necessary. But it can not do that if you overwrite the firmware with any Arduino sketch. It is just like erasing the restore partition on your computer hard drive. Do not do it - unless you really know what you are doing.</p>"},{"location":"hardware_overview/#leds","title":"LEDs","text":"<p>There are three LEDs populated on the board. These can be disabled with their respective jumpers on the back of the board.</p> LED Description STAT The status LED is connected to pin <code>25</code>. RGB The WS2812-2020 RGB addressable LED is connected to pin <code>26</code>. In addition to being disabled through the jumper on the back, you can also disable the LED through software. CHG The on-board yellow CHG LED can be used to get an indication of the charge status of your battery. Below is a table of other status indicators depending on the state of the charge IC."},{"location":"hardware_overview/#rgb-led-color-values","title":"RGB LED Color Values","text":"<p>The following colors represent different states that the board is in.</p> Color Description White A solid white LED indicates that the board is currently being configured through the configuration menu. Green A solid green LED indicates that the board is initializing. As of firmware v01.00.02, the LED blinks green when on battery power indicating that the battery level is VBATT &gt; 50%. Blue A blinking blue LED indicates that the board is reading sensor data and logging the values. Yellow A solid yellow LED indicates that a firmware update is in progress. As of firmware v01.00.02, the LED blinks yellow when on battery power indicating that the battery level is between 50% &gt; VBATT &gt; 10%. Red As of firmware v01.00.02, the LED blinks red when on battery power indicating that the battery level is VBATT &lt; 10%."},{"location":"hardware_overview/#charge-led-values","title":"Charge LED Values","text":"State LED Status No Battery Off Shutdown Off - may flicker Charging On Charge Complete Off <p>LEDs and PTHs Connected to LEDs</p>"},{"location":"hardware_overview/#jumpers","title":"Jumpers","text":"<p>There are seven jumpers on the back of the DataLogger IoT - 9DoF. For more information, check out our tutorial on working with jumper pads and PCB traces should you decide to cut the traces with a hobby knife.</p> Jumper Description SHLD This jumper connects the USB Type C connector's shield pin to GND. Cut this to isolate the USB Type C connector's shield pin. I<sup>2</sup>C This three way jumper labeled as I<sup>2</sup>C are closed by default. By cutting the jumpers, it will disconnect the 2.2k\u03a9 pull-up resistors for the I<sup>2</sup>C STAT This jumper connects the status LED to pin <code>25</code> and it is closed by default. Open the jumper to disable the LED. RGB This jumper connects the WS2812-2020 RGB addressable LED to pin <code>26</code> and it is closed by default. Open the jumper to disable the LED. CHG* This jumper connects the charge LED on the MCP73831 charge IC and it is closed by default. Open the jumper to disable the LED. IMU INT2 This jumper connects the ISM330DHCX IMU's interrupt pin to pin <code>35</code> and it is open by default. Add a solder jumper to connect. MAG INT This jumper connects the MMC5983MA  magnetometer's interrupt pin to pin <code>35</code> and it is open by default. Add a solder jumper to connect. <p></p> <p>Jumper Locations</p> <p>On the DataLogger IoT, the IMU INT2 or MAG INT jumpers are not included since it does not have the built in 6DoF IMU or magnetometer. With the extra real estate on the board, we were able to include a MEAS PTH and jumper on the board. By default, the jumper is closed. You can cut this jumper on the bottom side of the board to measure the DataLogger IoT\u2019s current draw from external power.</p> <p></p> <p>Measurment Jumpers</p>"},{"location":"hardware_overview/#board-dimensions","title":"Board Dimensions","text":"<p>The overall length and width with the antenna connector is about 1.66\" x 2.00\". There are four mounting holes in the center of the board. Due to the size of the board and the ESP32 module, the mounting holes are positioned in a way for users to add two Qwiic enabled boards with a width of 1.0\" instead of one Qwiic board.</p> <p></p> <p>DataLogger IoT Board Dimensions</p>"},{"location":"introduction/","title":"Introduction","text":""},{"location":"introduction/#introduction","title":"Introduction","text":"<p>The SparkFun DataLogger IoT is a data logger that comes preprogrammed and ready to use immediatly - no programming, no setup - just plug in the board, add a supported qwiic sensor or two and start logging data. The built-in firmware automatically detects attached qwiic sensors, peforms any setup and starts logging sensor data. And with minimal configuration, the DataLogger IoT can connect to a local WiFi network and post data to a wide range of IoT data services.</p> <p>The DataLogger IoT automatically detects, configures, and logs Qwiic sensors. It was specifically designed for users who just need to capture a lot of data with minimal setup or development. It delivers a ready-to-use device that enables saving data to a microSD card, output it to a serial console andor send it wirelessly to your preferred Internet of Things (IoT) services - all at that same time!</p> <p>To configure the DataLogger, a menu system is accessed via a serial connection and provides access to all available settings for the system. Changes are automatically saved in persistant storage on the device, and are also settable/accessable as a <code>json</code> file if desired.  Details on setting up the system are outlined in the Settings section of this manual.</p>"},{"location":"introduction/#datalogger-devices","title":"DataLogger Devices","text":"<p>The following devices support the DataLogger IoT functionality discussed in this document.</p> <ul> <li>SparkFun DataLogger IoT     - the core DataLoggerIoT Device</li> <li>SparkFun DataLogger IoT - 9DoF     - A DataLoggerIoT with on-board 9DoF (Direction-of-Freedom) sensors.</li> </ul>"},{"location":"introduction/#quick-start","title":"Quick Start","text":"<p>Overall, the SparkFun DataLoggerIoT is ready for operation and requires no programming or software development. Just plug in a supported sensor and beging logging data to the serial console. With a little additiona setup, data is logged to a variety of common IoT data services as well as to an on-board SD card.</p>"},{"location":"introduction/#common-items-required-when-using-the-dataloggeriot","title":"Common items required when using the DataLoggerIoT","text":"<p>For general use and for following the documentation provided, the following items are used:</p> <ul> <li>A supported SparkFun DataLogger IoT board</li> <li>microSD card formatted with FAT32 [COM-15107]</li> <li>USB C Cable for communication and power</li> <li>A qwiic Cable</li> <li>At least one Qwiic enabled devices that is compatible</li> <li>For battery powered operation, a Lithium Ion Battery</li> </ul>"},{"location":"introduction/#basic-hardware-setup","title":"Basic Hardware Setup","text":"<p>The simple hardware setup is as follows:</p> <ul> <li>Connect a supported qwiic sensor to the datalogger.</li> <li>Connect the datalogger to a computer using a usb-c cable</li> <li>Connected to the datalogger via a Serial Terminal</li> </ul>"},{"location":"introduction/#basic-configuration-setup","title":"Basic Configuration Setup","text":"<p>Once connected to the DataLoggerIoT using a serial terminal, pressing any key on the keyboard will bring up the menuing system.</p> <p></p> <p>To navigate the menu, press the menu item number on your keyboard - this will select the desired menu. So if you want to assess the <code>Settings</code> menu item in the main menu, press the number <code>1</code> on your keyboard.</p> <p>To exit a menu perform on of the following:</p> <ul> <li>Press the <code>b</code> key (back) to return to the previous menu</li> <li>At the main menu, press <code>x</code> to exit (<code>b</code> works also). Any changes to settings are saved to on-board storage</li> <li>Press the <code>Escape</code> key (esc) to return to the previous menu item. If at the main menu, any changes are not save to on-board storage.</li> </ul> <p>Note</p> <p>If you don't exit a menu, after a timeout period (60 seconds default), the menu will exit as if the <code>escape</code> key was pressed.</p> <p>Warning</p> <p>If you make configuration changes, but don't exit the menu to save the changes, the changes will not be saved to on-device storage.</p> <p>Once menu navigation is understood, explore the options available and make changes to meet your needs. The configuration options are detailed in a majority of this on-line guide.</p>"},{"location":"introduction/#the-sensors","title":"The Sensors","text":"<p>Straight out of the box anti-static bag, the DataLogger IoT 9DoFis ready to log data from its built-in ISM330DHCX Inertial Measurement Unit (IMU) and MMC5983MA magnetometer. Only want to log magnetometer, accelerometer, gyro or temperature data? You\u2019re good to go! But the fun is only just beginning\u2026</p> <p>The DataLogger IoT is preprogrammed to automatically log data from all of the following sensors, so you may wish to add one or more of these to your shopping cart too. (More sensors are being added all the time and it is really easy to upgrade the DataLogger IoT to support them. But we'll get to that in a moment!). Currently, auto-detection is supported on the following Qwiic-enabled products (with the exception of the ISM330DHCX and MMC5983 which is built-in on the 9DoF variant):</p> <p>For a list of supported devices based on the firmware, you can check out the list of supported Qwiic Devices in the appendix</p>"},{"location":"iot_arduino_iot_cloud/","title":"Arduino Cloud","text":""},{"location":"iot_arduino_iot_cloud/#creating-and-connecting-to-an-arduino-cloud-device","title":"Creating and Connecting to an Arduino Cloud Device","text":"<p>One of the key features of the SparkFun DataLogger IoT is it's simplified access to IoT service providers. This document outlines how an Arduino Cloud Device is used by the DataLogger IoT.</p> <p>The following is covered by this document:</p> <ul> <li>Structure of the Arduino Cloud Devices</li> <li>Device creation in the Arduino Cloud</li> <li>Setup of the Arduino Driver</li> <li>How data is posted from the DataLogger IoT to the Arduino Device</li> </ul> <p>Currently, the Arduino Cloud device connection is a single direction - used to post data from the DataLogger IoT to an Arduino Cloud device.</p> <p>NOTE To take advantage of the API's in Arduino Cloud, you will also need to have a service plan with your account.</p>"},{"location":"iot_arduino_iot_cloud/#general-operation","title":"General Operation","text":"<p>The Arduino Cloud enables connectivity between an IoT/Edge Arduino enabled device and the cloud. The edge device updates data in the Arduino Cloud by updating <code>variables</code> or parameters attached to a cloud device.</p> <p>In the Arduino Cloud, the edge device is represented by a Device which has a virtual Thing attached/associated with it. The Thing acts as a container for a list of parameters or variables which represent the data values received from the edge device. As values on the edge device update, they are transmitted to the Arduino Cloud.</p> <p>For a SparkFun DataLogger IoT connected to an Arduino Cloud device, the output parameters of a device connected to the DataLogger are mapped to variables within the Arduino Cloud Device's Thing using a simple pattern of DeviceName_ParameterName for the name of the variable in the Arduino Cloud.</p> <p></p>"},{"location":"iot_arduino_iot_cloud/#creating-a-device-in-arduino-cloud","title":"Creating a Device in Arduino Cloud","text":"<p>The first step connecting to the Arduino Cloud is setting up a device within the cloud. A device is a logical element that represents a physical device.</p> <p>Log into your Arduino Cloud account.</p> <p>Click on the expand menu icon on the upper left (e.g. the three lines stacked like a \"hamburger\"; \u2630) and select  Devices. If your window is big enough, then it will show up on the navigation bar.</p> <p></p> <p>This page lists your currently defined devices. If there are no defined devices, select the Add Device button. This will probably be at the bottom of the page. The location of this button will change once the page has a device (or if there is an update to Arduino's user interface).</p> <p></p> <p>A device type selection dialog is then shown. Since we are connecting a DataLogger IoT board to the system, and not connected a known device, select DIY - Any Device to manually include the DataLogger IoT.</p> <p></p> <p>Once selected, another dialog is presented. Just select Continue. At this point you can provide a name for your device. In this case we named it as \"MyDataLoggerIoT.\"</p> <p></p> <p>The next screen is the critical step of the device creation process. This step is the one time the Device Secret Key is available. The provided <code>Device ID</code> and Device <code>Secret Key</code> values are needed to connect to the Arduino Cloud. Once this step is completed, the Secret Key is no longer available.</p> <p></p> <p>The easiest way to capture these values is by downloading as a PDF file, which is offered on the setup page. Click on the download the PDF and save it to a safe location. When ready, click on the check box indicating that you have saved the values and select the Continue button.</p>"},{"location":"iot_arduino_iot_cloud/#arduino-cloud-api-keys","title":"Arduino Cloud API Keys","text":"<p>In addition to creating a device, to access the Arduino Cloud, the driver requires an API Key. This allows the DataLogger IoT's Arduino Cloud driver to access the web API of the Arduino Cloud. This API is used to setup the connection to the Arduino Cloud.</p> <p>To create an API key, click on the menu bar to expand and select your  Arduino account profile &gt; Personal Settings.</p> <p></p> <p>This menu takes you to a list of existing API Keys. If you have not created one yet, the list will have nothing in it like the image below. From this page, select the CREATE API KEY button.</p> <p></p> <p>NOTE Users will need a service plan in order to take advantage of the API.</p> <p>In the presented dialog, enter a name for the API key. In this case, we named it \"MyDataLoggerKey\".</p> <p></p> <p>Once the name is entered, click CONTINUE. A page with the new API key is presented. Like in Device Creation, this page contains a secret that is only available on this page during this process.</p> <p></p> <p>Make note of the Client ID and Client Secret values on this page. The best method to capture these values is to download the PDF file offered on this page. Click on the download the PDF and save it to a safe location. When ready, click on the check box indicating that you have saved the values and select the DONE button.</p> <p>At this point, the Arduino Cloud is setup for connection by the driver.</p>"},{"location":"iot_arduino_iot_cloud/#arduino-cloud-configuration","title":"Arduino Cloud Configuration","text":"<p>To add an Arduino Cloud Device as a destination DataLogger IoT, the Arduino Cloud connection is enabled via the DataLogger menu system and the connection values, obtained from the Arduino Cloud (see above), are set in the connection properties.</p> <p>The specifics for the Arduino Cloud must be configured. This includes the following:</p> <ul> <li>Thing Name</li> <li>Thing ID</li> <li>API Client ID</li> <li>API Secret</li> <li>Device Secret</li> <li>Device ID</li> </ul> <p>NOTE The Thing Name does not necessarily need to be configured. However, there will be less confusion if you set this up before connecting the DataLogger IoT to the Cloud. The Thing ID will automatically be generated and saved once there is a connection available.</p>"},{"location":"iot_arduino_iot_cloud/#thing-name","title":"Thing Name","text":"<p>The name of the Arduino Cloud <code>Thing</code> to use. If the Thing doesn't exist on startup, the driver will create a Thing and be named \"Untitled\" if you do not provide a name.</p> <p>NOTE Note satisfied with the default \"Untitled\" as the Thing's name? You can rename the Thing Name after creating the Thing. Note that you will need to manually rename the Thing Name on the Arduino Cloud and DataLogger IoT.</p>"},{"location":"iot_arduino_iot_cloud/#thing-id","title":"Thing ID","text":"<p>This is the ID of the Thing being used. This value is obtained by the following methods:</p> <ul> <li>If the driver creates a new Thing, the ID is obtained and used.</li> <li>If an existing Thing is connected to the DataLogger IoT, the driver retrieves it's ID.</li> <li>In this case, the driver cannot create any new variables until the system is restarted.</li> <li>The user creates a new Thing using the web interface of Arduino Cloud, and provides the Thing Name and Thing ID .</li> </ul>"},{"location":"iot_arduino_iot_cloud/#api-client-id-and-secret","title":"API Client ID and Secret","text":"<p>These values are used to provide API access by the driver. This access allows for the creation/use of a Thing and Variables within the Arduino Cloud. These are obtained via the steps outlined earlier in this document.</p>"},{"location":"iot_arduino_iot_cloud/#device-secret-and-id","title":"Device Secret and ID","text":"<p>These values are used to identify the Arduino device that is connected to. These are obtained via the steps outlined earlier in this document.</p>"},{"location":"iot_arduino_iot_cloud/#setting-properties","title":"Setting Properties","text":"<p>The above property values must be set in the DataLogger's Arduino Cloud driver before use. They can be manually by using the menu system like the previous MQTT example.</p> <p>For users that are interested in using the menu system, open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type ```1```` to enter the Settings menu. Then select the Arduino IoT Menu. When the menu system for the Arduino IoT is presented, you will need to configure the property values as listed in the JSON file. Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The alternative to using the menu system is a JSON file. These values can be set using a JSON file that is loaded by the system at startup. For the DataLogger Arduino Cloud example outlined in this document, the entries in the setting's JSON file are as follows:</p> <pre><code>\"Arduino IoT\": {\n    \"Enabled\": true,\n    \"Thing Name\": \"SparkFunThing1\",\n    \"API Client ID\": \"MY_API_ID\",\n    \"API Secret\": \"MY_API_SECRET\",\n    \"Device Secret\": \"MY_DEVICE_SECRET\",\n    \"Device ID\": \"MY_DEVICE_ID\"            \n  },\n</code></pre> <p>You will need to update the <code>API Client ID</code>, <code>API Secret</code>, <code>Device Secret</code>, and <code>Device ID</code> with the values that were obtained earlier. Don't forget to enable Arduino Cloud service by setting the value to <code>true</code>. If the JSON file is saved in the microSD card, you will need to load the credentials to the DataLogger IoT.</p> <p>TIP To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the Arduino IoT as well.</p>"},{"location":"iot_arduino_iot_cloud/#operation","title":"Operation","text":"<p>On startup, when the first values are written from the DataLogger IoT, the connection to the Arduino Cloud is made. During this connection, the system connects to the specified Thing and variables are mapped between the DataLogger Device values and Arduino Cloud Variables. If needed, variables can be created manually in the cloud.</p> <p>While this initial setup takes seconds to complete, updates to the values on the Arduino Cloud are rapid as soon as there is a connection available.</p>"},{"location":"iot_arduino_iot_cloud/#viewing-values","title":"Viewing Values","text":"<p>Once the DataLogger IoT device is configured and running, updates in Arduino Cloud are listed in the Things tab of the Arduino Cloud page. Clicking the target Thing provides access to the current variable values that are connected to the DataLogger IoT. Your mileage may vary depending on the compatible device that is connected to the DataLogger IoT. In this case, we were able to see the built-in sensors that were connected on the DataLogger IoT - 9DoF.</p> <p></p> <p>Having problems connecting new variables with the DataLogger IoT? When swapping out compatible Qwiic enabled devices, you may need to delete previous cloud variables so that the DataLogger IoT is able re-initialize them on the next power cycle.</p>"},{"location":"iot_arduino_iot_cloud/#create-a-dashboard","title":"Create a Dashboard","text":"<p>With the data now available in the Arduino Cloud as variables, it is a simple step create a dashboard that plots the data values.</p> <p>The general steps to create a simple dashboard include:</p> <ul> <li>Select the Dashboards section of the Arduino Cloud.</li> <li>Select the Build Dashboard button. If you have a dashboard already built, the location of the button will change and the button will be renamed: Create.</li> <li>Click the edit button (i.e. the icon that looks like a paper and pencil, this is next to the eye).</li> <li>Add an element to the dashboard -- for this example select ADD ^ &gt; Advanced Chart.</li> <li>On the Chart's Widget Settings select Link Variables to add readings.  </li> <li>The DataLogger IoT Variables are listed - select the variable to link.</li> <li>Continue this step until all the desired variables are linked to the chart. You can select up to 5x variables at a time. Click on the Link Variables button after selecting the variables.</li> <li>This will bring you back to the Chart's Widget Settings window. Configure any preferences that to display (i.e. variable colors, labels, etc.). When all variables are linked and the Chart Widget Settings is configured, select Done.</li> </ul> <p></p> <p>The created dashboard then displays the values posted from the SparkFun DataLogger IoT. You can continue adding additional readings on the dashboard that you were not able to fit on graph or even rename the Dashboard view. In this case, we displayed accelerometer values and temperature in degrees Celsius from the DataLogger IoT - 9DoF.</p> <p></p> <p>Not seeing any values on the LIVE view? Try clicking on the other time periods to see the values posted.</p> <p>Using compatible Qwiic enabled devices, you can also display additional readings that are not available with the built-in sensors. In this case, we were able to display humidity, temperature in degrees Fahrenheit, equivalent CO2, TVOC, and AQI with the DataLogger IoT and Environmental Combo Breakout (ENS160/BME280).</p> <p></p>"},{"location":"iot_aws/","title":"AWS","text":""},{"location":"iot_aws/#creating-and-connecting-to-an-aws-iot-device-thing","title":"Creating and Connecting to an AWS IoT Device (Thing)","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers. This document outlines how an AWS IoT device is used by the DataLogger IoT.</p> <p>The following is covered by this document:</p> <ul> <li>Device (Thing) creation in AWS</li> <li>Securely connecting the device</li> <li>How data is posted from the DataLogger IoT to the AWS Device via it's Shadow</li> </ul> <p>Currently, the AWS IoT device connection is a single direction - used to post data from the hardware to the IoT AWS Device via the AWS IoT devices shadow. Configuration information from AWS IoT to the DataLogger IoT is currently not implemented.</p>"},{"location":"iot_aws/#general-operation","title":"General Operation","text":"<p>AWS IoT enables connectivity between an IoT / Edge device and the AWS Cloud Platform, implementing secure endpoints and device models within the AWs infrastructure. This infrastructure allows edge devices to post updates, status and state to the AWS infrastructure for analytics, monitoring and reporting.</p> <p>In AWS IoT, an virtual representation of an actual device is created and referred to as a Thing. The virtual device/Thing is allocated a connection endpoint, security certificates and a device shadow - a JSON document used to persist, communicate and manage device state within AWS.</p> <p>The actual IoT device communicates with it's AWS representation via a secure MQTT connection, posting JSON document payloads to a set of pre-defined topics. Updates are posted to the AWS IoT device shadow, which is then accessed within AWS for further process as defined by the users particular cloud implementation.</p> <p></p>"},{"location":"iot_aws/#creating-a-device-in-aws-iot","title":"Creating a Device in AWS IoT","text":"<p>The following discussion outlines the basic steps taken to create a Thing in AWS IoT that the DataLogger IoT can connect to. First step is to log into your AWS account and create a thing.</p> <p>Once logged into your AWS account, select IoT Core from the menu of services. </p> <p>From the IoT Core console page, under the Manage section, select All Devices &gt; Things </p> <p>On the resultant Things Page, select the Create Things button.</p> <p></p> <p>AWS IoT will then take you through the steps to create a device. Selections made for a demo Thing are:</p> <ul> <li>Create single thing</li> <li>Thing Properties</li> <li>Enter a name for your thing - for this example TestThing23</li> <li>Device Shadow - select Unnamed shadow (classic)</li> <li>Auto-generate a new certificate</li> <li>Attach policies to certificate - This is discussed later in this document</li> <li>Select Create thing</li> </ul> <p>Upon creation, AWS IoT presents you with a list of downloadable certificates and keys. Some of these are only available at this step. The best option is to download everything presented - three of these are used by the DataLogger IoT. The following should be downloaded:</p> <ul> <li>Device Certificate</li> <li>Public Key File</li> <li>Private Key File</li> <li>Root CA certificates - (for example:  Amazon Root CA 1 )</li> </ul> <p>At this point, the new AWS IoT thing is created and listed on the AWS IoT Things Console</p> <p></p>"},{"location":"iot_aws/#security-policy","title":"Security Policy","text":"<p>To write to the IoT device, a security policy that enables this is needed, and the policy needs to be assigned to the devices certificate.</p> <p>To create a Policy, select the Manage &gt; Security &gt; Policies menu item from the left side menu of the AWS IoT panel. Once on this page, select the Create policy button to create a new policy.</p> <p></p> <p>When entering the policy, provide a name that fits your need. For this example, the name NewThing23Policy is used. For the Policy document, you can manually enter the security entires, or enter them as a JSON document. The JSON document used for this example is:</p> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Connect\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Subscribe\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Receive\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Publish\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:GetThingShadow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:UpdateThingShadow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n</code></pre> <p></p> <p>Once the policy is created, go back to the IoT Device/Thing created above and associate this policy to the device Certificate.</p> <ul> <li>Go to your device Manage &gt; All devices &gt; Things</li> <li>Select the device - TestThing23 for this example</li> <li>Select the Certificates tab</li> <li>Select the listed Certificate (it's a very long hex number)</li> <li>At the bottom right of the page, select the Attach policies button and select the Policy created above.</li> </ul> <p></p> <p>At this point, AWS IoT is ready for a device to connect and receive data.</p>"},{"location":"iot_aws/#aws-configuration","title":"AWS Configuration","text":"<p>The specifics for the AWS IoT Thing must be configured. This includes the following:</p> <ul> <li>Server name/host</li> <li>MQTT topic to update</li> <li>Client Name - The AWS IoT Thing Name</li> <li>CA Certificate Chain</li> <li>Client Certificate</li> <li>Client Key</li> </ul>"},{"location":"iot_aws/#server-namehostname","title":"Server Name/Hostname","text":"<p>This value is obtained from the AWS IoT Device page for the created device. When on this page, select the Device Shadows tab, and then select the Classic Shadow shadow, which is listed. Note a secure connection is used, so the port for the connection is <code>8883</code>.</p> <p></p> <p>Selecting the Classic Shadow entry provides the Server Name/Hostname for the device, as well as the MQTT topic for this device.</p> <p></p> <p>Note</p> <p>The server name is obtained from the Device Shadow URL entry</p>"},{"location":"iot_aws/#mqtt-topic","title":"MQTT Topic","text":"<p>The MQTT topic value is based uses the MQTT topic prefix from above, and has the value update added to it. So for this example, the MQTT topic is:</p> <pre><code>    $aws/things/TestThing23/shadow/update\n</code></pre>"},{"location":"iot_aws/#client-name","title":"Client Name","text":"<p>This is the AWS IoT name of the thing. For the provided example, the value is TestThing23</p>"},{"location":"iot_aws/#ca-certificate-chain","title":"CA Certificate Chain","text":"<p>This value was downloaded as a file during the creation process. The contents of this file can be passed on to the DataLogger IoT by copying the file containing the data onto a devices SD Card and setting the filename property for the DataLogger IoT.</p>"},{"location":"iot_aws/#client-certificate","title":"Client Certificate","text":"<p>This value was downloaded as a file during the creation process. The contents of this file can be passed on to the DataLogger IoT by copying the file containing the data onto a devices SD Card and setting the filename property for the DataLogger IoT.</p>"},{"location":"iot_aws/#client-key","title":"Client Key","text":"<p>This value was downloaded as a file during the creation process. The contents of this file can be passed on to the DataLogger IoT by copying the file containing the data onto a devices SD Card and setting the filename property for the DataLogger IoT.</p>"},{"location":"iot_aws/#setting-properties","title":"Setting Properties","text":"<p>The above property values must be set on the DataLogger before use. They can be set manually by using the menu system like the previous MQTT example.</p> <p>For users that are interested in using the menu system, you will need to open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type &lt;<code>1</code> to enter the Settings menu. Then type <code>11</code> to enter the AWS IoT Menu. When the menu system for the AWS IoT connection is presented, you will need to configure the property values as listed in the JSON file. Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The alternative to using the menu system is a JSON file. These values can be set using a JSON file that is loaded by the system at startup. For the DataLogger IoT example outlined in this document, the entries in the settings JSON file are as follows:</p> <pre><code>\"AWS IoT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"avgpd2wdr5s6u-ats.iot.us-east-1.amazonaws.com\",\n    \"MQTT Topic\": \"$aws/things/TestThing23/shadow/update\",\n    \"Client Name\": \"TestThing23\",\n    \"Buffer Size\": 0,\n    \"Username\": \"\",\n    \"Password\": \"\",\n    \"CA Certificate\": \"\",\n    \"Client Certificate\": \"\",\n    \"Client Key\": \"\",\n    \"CA Cert Filename\": \"AmazonRootCA1.pem\",\n    \"Client Cert Filename\": \"TestThing23_DevCert.crt\",\n    \"Client Key Filename\": \"TestThing23_Private.key\"\n  },\n</code></pre> <p>Besides updating the <code>Server</code>, <code>MQTT Topic</code>, <code>Client Name</code>, <code>CA Cert Filename</code>, <code>Client Cert Filename</code>, and <code>Client Key Filename</code>, you will need to also ensure that the <code>port</code> is set to <code>8883</code>. The default in previous firmware versions was <code>1883</code>. As of firmware v01.00.04, the default is <code>8883</code>. You will need to adjust the port value to properly connect to the AWS IoT service. Don't forget to enable AWS IoT service by setting the value to <code>true</code>. If the JSON file is saved in the microSD card, you can load the credentials to the DataLogger IoT.</p> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the AWS IoT as well.</p>"},{"location":"iot_aws/#operation","title":"Operation","text":"<p>Once the device is configured and running, updates in AWS IoT are listed in the Activity tab of the devices page. For the test device in this document, this page looks like:</p> <p></p> <p>Opening up an update, you can see the data being set to AWS IoT in a JSON format.</p> <p></p>"},{"location":"iot_azure/","title":"Azure","text":""},{"location":"iot_azure/#creating-and-connecting-to-an-azure-iot-device","title":"Creating and Connecting to an Azure IoT Device","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers. This document outlines how an Azure IoT device is used by the DataLogger IoT.</p> <p>The following is covered by this document:</p> <ul> <li>Device creation Azure</li> <li>Securely connecting the device</li> <li>How data is posted from the DataLogger IoT to the Azure Device</li> </ul> <p>Currently, the Azure IoT device connection is a single direction - it is used to post data from the hardware to the Azure IoT Device. Configuration information from Azure IoT to the DataLogger IoT is currently not implemented.</p>"},{"location":"iot_azure/#general-operation","title":"General Operation","text":"<p>Azure IoT enables connectivity between an IoT / Edge device and the Azure Cloud Platform, implementing secure endpoints and device models within the Azure infrastructure. This infrastructure allows edge devices to post updates, status and state to the Azure infrastructure for analytics, monitoring and reporting.</p> <p>In Azure IoT, an virtual representation of an actual device is created and referred to as a Device. The virtual device is allocated a connection endpoint, security certificates and a device digital twin - a JSON document used to persist, communicate and manage device state within Azure. Unlike AWS IoT, data from the device isn't posted to the devices digital twin (AWS Shadow), but to the device directly.</p> <p>The actual IoT device communicates with it's Azure representation via a secure MQTT connection, posting JSON document payloads to a set of pre-defined topics. Updates are posted directly to the Azure device, which is then accessed within Azure for further process as defined by the users particular cloud implementation.</p> <p></p>"},{"location":"iot_azure/#creating-a-device-in-azure-iot","title":"Creating a Device in Azure IoT","text":"<p>The following discussion outlines the basic steps taken to create a Device in Azure IoT that the DataLogger IoT can connect to. First step is to log into your Azure account and create an IoT Hub for your device.</p> <p>Once logged into your Microsoft Azure account, select Internet of Things &gt; IoT Hub from the menu of services.</p> <p></p>"},{"location":"iot_azure/#create-an-iot-hub","title":"Create an IoT Hub","text":"<p>This IoT Hub page lists all the IoT hubs available for your account. To add a device, you need to create a new IoT Hub.</p> <p>Follow the Hub Creation workflow - key settings used for a DataLogger demo device:</p> <ul> <li>Used the \"Free Tier\" for testing and development.</li> <li>Networking</li> <li>Connectivity - Public Access</li> <li>Minimum TLS Version - 1.0</li> </ul> <p>The remaining settings were set at their default values.</p>"},{"location":"iot_azure/#create-a-device","title":"Create a Device","text":"<p>Once the IoT Hub is created, a Device needs to be created within the hub. The device represents the connection to the actual DataLogger IoT device.</p> <p>To create a device, select the Device management &gt; Devices from the IoT Hub menu and the select the + Add Device menu item</p> <p></p> <p>In the create device dialog:</p> <ul> <li>Enter a name for the device</li> <li>Select an Authentication type of Symmetric key</li> <li>Auto-generate keys enabled</li> </ul> <p></p> <p>Once created, the device is listed in the Devices list of the IoT Hub. Selecting the device gives you the device ID and keys used to communicate with the device. Note, when connecting to the device with the DataLogger IoT, the Primary Key value is used.</p> <p></p>"},{"location":"iot_azure/#azure-configuration","title":"Azure Configuration","text":"<p>Once the DataLogger IoT is integrated into the application, the specifics for the Azure IoT Thing must be configured. This includes the following:</p> <ul> <li>Server Name/Hostname</li> <li>Device Key</li> <li>Device ID</li> <li>CA Certificate Chain</li> </ul>"},{"location":"iot_azure/#server-namehostname","title":"Server Name/Hostname","text":"<p>This value is hostname of the created IoT Hub and is obtained from the Overview page of the IoT Hub. Note a secure connection is used, so the port for the connection is <code>8883</code>.</p> <p></p>"},{"location":"iot_azure/#device-id","title":"Device ID","text":"<p>The Device ID is obtained from the device detail page. This page is accessible via the Device listing page, which is accessed via the Device management &gt; Devices menu item. The selected device of interest (TestDevice2023 for this example) provides the device ID and Primary Key.</p> <p></p>"},{"location":"iot_azure/#device-primary-key","title":"Device Primary Key","text":"<p>This is obtained via the Device details page, as outlined in the previous section.</p> <p>You view and copy the key via the icons on the right of the key entry line.</p>"},{"location":"iot_azure/#root-certificate-authority-ca-file","title":"Root Certificate Authority - CA file","text":"<p>The Certificate Authority file for Azure is downloaded from this page:</p> <p></p> <p>The file to download is the Baltimore CyberTrust Root entry in the Root Certificate Authorities section of the page.</p> <p></p>"},{"location":"iot_azure/#setting-properties","title":"Setting Properties","text":"<p>The above property values must be set on the DataLogger IoT before use. They can be set manually by using the menu system like the previous MQTT example.</p> <p>For users that are interested in using the menu system, you will need to open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then type <code>13</code> to enter the Azure IoT Menu. When the menu system for the Azure IoT connection is presented, you will need to configure the property values as listed in the JSON file. Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The alternative to using the menu system is a JSON file. These values can be set using a JSON file that is loaded by the system at startup. For the example outlined in this document, the entries in the settings JSON file are as follows:</p> <pre><code>\"Azure IoT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"sparkfun-datalogger-hub.azure-devices.net\",\n    \"MQTT Topic\": \"\",\n    \"Client Name\": \"\",\n    \"Buffer Size\": 0,\n    \"Username\": \"\",\n    \"Password\": \"\",\n    \"Device Key\" : \"My-Super-Secret-Device-Key\",\n    \"Device ID\"  : \"TestDevice2023\",\n    \"CA Cert Filename\": \"AzureRootCA.pem\"\n  },\n</code></pre> <p>Besides updating the <code>Server</code>, <code>Device Key</code>, <code>Device ID</code>, and <code>CA Cert Filename</code>, you will need to also ensure that the <code>port</code> is set to <code>8883</code>. The default in previous firmware versions was <code>1883</code>. As of firmware v01.00.04, the default is <code>8883</code>. You will need to adjust the port value to properly connect to the Azure IoT service. Don't forget to enable Azure IoT service by setting the value to <code>true</code>. If the JSON file is saved in the microSD card, you can load the credentials to the DataLogger IoT.</p> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the Azure IoT as well.</p>"},{"location":"iot_azure/#operation-and-monitoring","title":"Operation and Monitoring","text":"<p>Once the DataLogger IoT device is configured and running, the Azure IoT capability in the DataLogger IoT posts messages via MQTT to the connected Azure Device via it's IoT Hub. Messages to the device are posted as Telemetry Data for the device.</p> <p>The easiest method to view the Telemetry data being sent to an Azure Iot Device is via the Azure IoT Hub extension for the Visual Studio Code editor.</p> <p></p> <p>Once installed, and connected to Azure via the Azure Account extension, you can connect to the target IoT Hub, and monitor telemetry data for a IoT device.</p>"},{"location":"iot_azure/#connect-to-your-azure-iot-hub","title":"Connect to Your Azure IoT Hub","text":"<p>On the Explorer panel of Visual Studio Code, click on the ... menu of the AZURE IOT HUB section. In the popup menu, select the Select IoT Hub menu entry.</p> <p></p> <p>The available IoT Hubs are displayed in the editors command prompt. Select the desired hub and press <code>Enter</code> (or click).</p> <p></p>"},{"location":"iot_azure/#select-iot-hub","title":"Select IoT Hub","text":"<p>The hub is then displayed in the AZURE IOT HUB section of the editor Explorer. Expanding the Devices section of the Hub will list the example device created above.</p> <p></p>"},{"location":"iot_azure/#monitoring","title":"Monitoring","text":"<p>To monitor the telemetry data send to a device, right click on the device, TestDevice2023 in this example, select the menu entry Start Monitoring Build-in Event Endpoint.</p> <p></p> <p>Once selected, the editor output console will start displaying output for the selected device. For the above example, with a device that has environmental sensors attached, the output appears as follows:</p> <p></p> <p>To stop monitoring, click the Stop Monitoring build-in event endpoint item that is displayed in the status bar of the editor.</p> <p></p> <p>A menu option to stop monitoring is also available from the ... menu of the AZURE IOT HUB section in the editor Explorer panel.</p>"},{"location":"iot_http/","title":"HTTP","text":""},{"location":"iot_http/#connecting-and-sending-output-to-an-http-server","title":"Connecting and Sending Output to an HTTP Server","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers and servers. This document outlines how output from a DataLogger IoT device is sent to an HTTP server.</p> <p>The following is covered by this document:</p> <ul> <li>Overview of the HTTP connection</li> <li>How a user configures and uses the HTTP connection</li> <li>Use examples</li> </ul>"},{"location":"iot_http/#general-operation","title":"General Operation","text":"<p>HTTP connectivity allows data generated by the DataLogger IoT to be sent to an HTTP server. An HTTP endpoint is provided to the HTTP action within the DataLogger IoT, and when data is output, a JSON representation of the data is published to the endpoint via an HTTP POST operation. The body of the POST operation contains the a JSON document that encapsulates the sent DataLogger IoT data.</p> <p></p>"},{"location":"iot_http/#data-structure","title":"Data Structure","text":"<p>Data is sent to the HTTP server as a JSON object, which contains a collection of sub-object. Each sub-object represents a data source in the sensor, and contains the current readings from that source.</p> <p>The following is an example of the data posted - note, this representation was \"pretty printed\" for readability.</p> <pre><code>{\n  \"MAX17048\": {\n    \"Voltage (V)\": 4.304999828,\n    \"State Of Charge (%)\": 115.0625,\n    \"Change Rate (%/hr)\": 0\n  },\n  \"CCS811\": {\n    \"CO2\": 620,\n    \"VOC\": 33\n  },\n  \"BME280\": {\n    \"Humidity\": 25.03613281,\n    \"TemperatureF\": 79.64599609,\n    \"TemperatureC\": 26.46999931,\n    \"Pressure\": 85280.23438,\n    \"AltitudeM\": 1430.44104,\n    \"AltitudeF\": 4693.04834\n  },\n  \"ISM330\": {\n    \"Accel X (milli-g)\": -53.31399918,\n    \"Accel Y (milli-g)\": -34.03800201,\n    \"Accel Z (milli-g)\": 1017.236023,\n    \"Gyro X (milli-dps)\": 542.5,\n    \"Gyro Y (milli-dps)\": -1120,\n    \"Gyro Z (milli-dps)\": 262.5,\n    \"Temperature (C)\": 26\n  },\n  \"MMC5983\": {\n    \"X Field (Gauss)\": -0.200622559,\n    \"Y Field (Gauss)\": 0.076416016,\n    \"Z Field (Gauss)\": 0.447570801,\n    \"Temperature (C)\": 29\n  }\n}\n</code></pre>"},{"location":"iot_http/#http-connection-setup","title":"HTTP Connection Setup","text":"<p>To connect to an HTTP server endpoint, the following information is needed:</p> <ul> <li>The URL of the endpoint</li> <li>The SSL certificate for the target server, if the connection is secure (HTTPS)</li> </ul> <p>These values are set using the standard DataLogger methods - the interactive menu system, or a JSON file.</p>"},{"location":"iot_http/#menu-system","title":"Menu System","text":"<p>For users that are interested in using the menu system, you will need to open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then enter the HTTP IoT Menu. When the menu system for the HTTP IoT connection is presented, you will need to configure the property values as listed in the JSON file. Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The options are:</p> <ul> <li>Enable/Disable the connection</li> <li>Set the URL for the endpoint</li> <li>Set the name of the CA Cert file for a secure connection (HTTP)</li> </ul> <p>To set the HTTP URL/endpoint - select two (2) in the menu, and enter the URL. For this example, we'll enter: <code>http://mysparkfunexample.com:8091</code>.</p> <p></p> <p>In the above example, the URL/HTTP Endpoint is on a server called <code>mysparkfunexample.com</code>, on port <code>8091</code>. Once set, the system will post data to this URL.</p> <p>If the endpoint is a secure ssl (HTTPS) connection, the certificate for the server is required. Because of the size of the certificates, the value is provided as a file that is loaded into the system by the attached SD card.</p> <p></p> <p>The above example show providing a certificate filename of <code>example.cer</code>.</p> <p>Once all these values are set, the system will post data to the specified HTTP endpoint, following the JSON information structure noted earlier in this document.</p>"},{"location":"iot_http/#json-file-entries","title":"JSON File Entries","text":"<p>If a JSON file is being used as an option to import settings into the DataLogger IoT, the following entries are used for the HTTP IoT connection:</p> <pre><code>\"HTTP IoT\": {\n    \"Enabled\": false,\n    \"URL\": \"&lt;the URL&gt;\",\n    \"CA Cert Filename\": \"&lt;certificate filename&gt;\"\n  }\n</code></pre> <p>Where:</p> <ul> <li><code>Enabled</code> - Set to <code>true</code> to enable the connection.</li> <li><code>URL</code> - Set to the URL for the connection.</li> <li><code>CA Cert Filename</code> - Set to the cert filename on the SD card if being used.</li> </ul> <p>If the JSON file is saved in the microSD card, you can load the credentials to the DataLogger IoT.</p> <p>Tip</p> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the HTTP IoT as well.</p>"},{"location":"iot_http/#example-connecting-to-a-http-server","title":"Example - Connecting to a HTTP Server","text":"<p>In this example, a simple HTTP Server is creating using Node JS, and the HTTP connection in the DataLogger IoT is used to post data to this server. The received data is output to the console from there server.</p>"},{"location":"iot_http/#the-server","title":"The Server","text":"<p>The following javascript/node code creates a HTTP server on port <code>8090</code>, and outputs received data to the console.</p> <pre><code>var http = require('http');\n\n// Setup the endpoint server\nvar myServer = http.createServer(function (req, res) {\n\n  // Initialize our body string\n  var body=\"\";\n\n  // on data callback, append chunk to our body string\n  req.on('data', function(chunk){\n body += chunk;\n  });\n\n  // On end callback, output the body to the console\n  req.on('end', function(){\n    // parse json string, then stringify it back for 'pretty printing'\n    console.log(\"payload: \" + JSON.stringify(JSON.parse(body),null,2));\n  });\n\n  // send a reply\n  res.writeHead(200, {'Content-Type': 'text/plain'});\n  res.end('n');\n  // Just listen on our port\n}).listen(8090);\n</code></pre> <p>The setup and use of node js is system dependant is beyond the scope of this document. However, Node JS is easily installed with your systems package manager (<code>brew</code> on macOS, Linux distribution package manager (apt, yum, ...etc), on Windows, the WSL is recommended).</p> <p>Once Node is setup, the above server is run via the following command (assuming the implementation is in a file called <code>simple_http.js</code>):</p> <pre><code>node ./simple_http.js\n</code></pre> <p>As data is sent by the DataLogger IoT, the following is output to the console from the server:</p> <p></p>"},{"location":"iot_http/#obtaining-a-sites-security-certificate","title":"Obtaining a Sites Security Certificate","text":"<p>Accessing a sites SSL/Secure Certificate is done via a web browser. The method for each browser is different. The following example uses Edge, which is similar to the operation in Chrome.</p> <p>First, browse to the desired site/server. Click the Secure/Security area/button next to the URL to bring up the security detail page. On this page, select the Connection is secure menu option</p> <p></p> <p>Next, on the page shown, select the certificate button on the upper right of the dialog.</p> <p></p> <p>When you select this button, the certificate details dialog is displayed. On this page, select the Details tab, and select the Export... button on the lower right of the dialog. This will save the sites SSL/Security certificate to a location you specify.</p> <p></p> <p>Once saved, place this file on the SD card your system/DataLogger is using, and set the filename in the HTTP connection menu or settings JSON file.</p>"},{"location":"iot_mqtt/","title":"MQTT","text":""},{"location":"iot_mqtt/#mqtt-iot","title":"MQTT IoT","text":""},{"location":"iot_mqtt/#connecting-and-publishing-data-to-mqtt","title":"Connecting and Publishing Data to MQTT","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers and servers. This document outlines how output from a DataLogger device is sent to an MQTT Broker.</p> <p>The following is covered by this document:</p> <ul> <li>Overview of the MQTT connection</li> <li>How a user configures and uses the MQTT connection</li> <li>MQTT examples</li> </ul>"},{"location":"iot_mqtt/#general-operation","title":"General Operation","text":"<p>MQTT connectivity allows data generated by the DataLogger IoT to be published to an MQTT Broker under a user configured topic. MQTT is an extremely flexible and low overhead data protocol that is widely used in the IoT field.</p> <p>The general use pattern for MQTT is that data is published to a topic on a MQTT broker. The data is then sent to any MQTT client that has subscribed to the specified topic.</p> <p></p> <p>The DataLogger IoT supports MQTT connections, allowing an end user to enter the parameters for the particular MQTT Broker for the application to publish data to. When the application outputs data to the broker, the DataLogger IoT publishes the available information to the specified \"topic\" with the payload that is a JSON document.</p>"},{"location":"iot_mqtt/#data-structure","title":"Data Structure","text":"<p>Data is published to the MQTT broker as a JSON object, which contains a collection of sub-objects. Each sub-object represents a data source in the sensor, and contains the current readings from that source.</p> <p>The following is an example of the data posted - note, this representation was \"pretty printed\" for readability.</p> <pre><code>{\n  \"MAX17048\": {\n    \"Voltage (V)\": 4.304999828,\n    \"State Of Charge (%)\": 115.0625,\n    \"Change Rate (%/hr)\": 0\n  },\n  \"CCS811\": {\n    \"CO2\": 620,\n    \"VOC\": 33\n  },\n  \"BME280\": {\n    \"Humidity\": 25.03613281,\n    \"TemperatureF\": 79.64599609,\n    \"TemperatureC\": 26.46999931,\n    \"Pressure\": 85280.23438,\n    \"AltitudeM\": 1430.44104,\n    \"AltitudeF\": 4693.04834\n  },\n  \"ISM330\": {\n    \"Accel X (milli-g)\": -53.31399918,\n    \"Accel Y (milli-g)\": -34.03800201,\n    \"Accel Z (milli-g)\": 1017.236023,\n    \"Gyro X (milli-dps)\": 542.5,\n    \"Gyro Y (milli-dps)\": -1120,\n    \"Gyro Z (milli-dps)\": 262.5,\n    \"Temperature (C)\": 26\n  },\n  \"MMC5983\": {\n    \"X Field (Gauss)\": -0.200622559,\n    \"Y Field (Gauss)\": 0.076416016,\n    \"Z Field (Gauss)\": 0.447570801,\n    \"Temperature (C)\": 29\n  }\n}\n</code></pre>"},{"location":"iot_mqtt/#mqtt-broker-connection-setup","title":"MQTT Broker Connection Setup","text":"<p>To connect to a MQTT Broker, the following information is needed:</p> <ul> <li>The server name/address</li> <li>The server port</li> <li>The topic to post to</li> <li>[optional] The name of the device/Client name publishing the data</li> <li>[optional] A username - if required</li> <li>[optional] A password - if required</li> </ul> <p>These values are set using the standard DataLogger methods - the interactive menu system, or a JSON file.</p>"},{"location":"iot_mqtt/#mqtt-menu-system","title":"MQTT Menu System","text":"<p>We'll need to adjust the settings for the MQTT Client using the MQTT Menu System.</p> <p>For users that are interested in using the menu system, open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to  115200 baud. In this case, we connected to COM13.  Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then type <code>9</code> to enter the MQTT Client Menu. When the menu system for the MQTT connection is presented, the following options are displayed:</p> <p></p> <p>The options are:</p> <ul> <li>Enable/Disable the connection</li> <li>Broker Port - The standard port for mqtt is 1883</li> <li>Broker Server - This is just the name of the server</li> <li>MQTT Topic - A string</li> <li>Client Name</li> <li>Username</li> <li>Password</li> <li>Buffer Size</li> </ul> <p>At a minimum, the Broker Port, Broker Server Name, and MQTT Topic need to be set. What parameters are required depends on the settings of the broker being used.</p> <p>NOTE If a secure connection is being used with the MQTT broker, use the <code>MQTT Secure Client</code> option of the DataLogger IoT. This option supports secure connectivity.</p> <p>NOTE The <code>Buffer Size</code> option is dynamic by default, adapting to the size of the payload being sent. If runtime memory is a concern, set this value to a static size that supports the device operation.</p> <p>Once all these values are set, the system will publish data to the specified MQTT Broker, following the JSON information structure noted earlier in this document.</p>"},{"location":"iot_mqtt/#json-file-entries","title":"JSON File Entries","text":"<p>If a JSON file is being used as an option to import settings into the DataLogger IoT, the following entries are used for the MQTT IoT connection:</p> <pre><code>\"MQTT Client\": {\n    \"Enabled\": false,\n    \"Port\": 1883,\n    \"Server\": \"my-mqttserver.com\",\n    \"MQTT Topic\": \"/sparkfun/datalogger1\",\n    \"Client Name\": \"mysensor system\",\n    \"Buffer Size\": 0,\n    \"Username\": \"\",\n    \"Password\": \"\"\n  },\n</code></pre> <p>Where:</p> <ul> <li><code>Enabled</code> - Set to <code>true</code> to enable the connection.</li> <li><code>Port</code> - Set to the broker port.</li> <li><code>Server</code> - The MQTT broker server.</li> <li><code>MQTT Topic</code> - The topic to publish to.</li> <li><code>Client Name</code> - Optional client name.</li> <li><code>Buffer Size</code> - Internal transfer buffer size.</li> <li><code>Username</code> - Broker user name if being used.</li> <li><code>Password</code> - Broker password if being used.</li> </ul> <p>TIP To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the MQTT Client as well.</p>"},{"location":"iot_mqtt/#testing-the-mqtt-connection","title":"Testing the MQTT Connection","text":"<p>Use of a MQTT connection is fairly straightforward - just requiring the entry of broker details into the connection settings.</p> <p>To test the connection, you need a MQTT broker available. A quick method to setup a broker is by installing the <code>mosquitto</code> package on a Raspberry Pi computer. Our basic MQTT Tutorial provides some basic setup for a broker.</p> <p>This MQTT Broker Tutorial has more details, covering the setup needed for modern mosquitto configurations.</p> <p>And once the broker is setup, the messages published by the IoT sensor are visible using the <code>mosquitto_sub</code> command as outlined. For example, to view messages posted to a the topic \"/sparkfun/datalogger1\", the following command is used:</p> <pre><code>mosquitto_sub -t \"/sparkfun/datalogger1\"\n</code></pre> <p>This assumes the MQTT broker is running on the same machine, and using the default port number.</p>"},{"location":"iot_thingspeak/","title":"ThingSpeak","text":""},{"location":"iot_thingspeak/#creating-and-connecting-to-thingspeak","title":"Creating and Connecting to ThingSpeak","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers. This document outlines how a ThinkSpeak output is used by the DataLogger IoT.</p> <p>The following is covered by this document:</p> <ul> <li>Creating a ThingSpeak Channel and MQTT Connection</li> <li>Securely connecting the ThingSpeak</li> <li>How data is posted from the DataLogger IoT to ThingSpeak</li> </ul>"},{"location":"iot_thingspeak/#general-operation","title":"General Operation","text":""},{"location":"iot_thingspeak/#thingspeak-structure","title":"ThingSpeak Structure","text":"<p>The structure of ThingSpeak is based off of the concept of Channels, with each channel supporting up to eight fields for data specific to the data source. Each channel is named, and has a unique ID associated with it.  One what to think of it is that a Channel is a grouping of associated data values or fields.</p> <p>The fields of a channel are enumerated as Field1, Field2, ..., Field8, but each field can be named to simplify data access and understanding.</p> <p>As data is reported to a ThingSpeak channel, the field values are accessible for further processing or visualization output.</p>"},{"location":"iot_thingspeak/#data-structure","title":"Data Structure","text":"<p>The DataLogger IoT is constructed around the concept of Devices which are often a type of sensor that can output a set of data values per observation or sample.</p>"},{"location":"iot_thingspeak/#mapping-data-to-thingspeak","title":"Mapping Data to ThingSpeak","text":"<p>The concept of Channels that contain Fields in ThingSpeak is similar to the Devices that contain Data within the DataLogger IoT, and this similarity is the mapping model used by the DataLogger IoT. Specifically:</p> <ul> <li>Devices == Channels</li> <li>Data == Fields</li> </ul> <p></p> <p>During configuration of the DataLogger IoT, the mapping between the Device and ThingSpeak channel is specified. The data to field mapping is automatically created by the DataLogger IoT following the data reporting order from the specific device driver.</p>"},{"location":"iot_thingspeak/#creating-a-device-to-a-thingspeak-channel","title":"Creating a Device to a ThingSpeak Channel","text":"<p>The following discussion outlines the basic steps taken to create a Channel in ThingSpeak and then connect it to the DataLogger's Device. First step is to log into your ThingSpeak and create a Channel.</p> <p>Once logged into your ThingSpeak account, select Channels &gt; My Channels menu item and on the My Channel page, select the New Channel button.</p> <p></p> <p>On the presented channel page, name the channel and fill in the specific channel fields. The fields should map to the data fields reported from the Device being linked to this channel. Order is important, and is determined by looking at output of a device to the serial device (or reviewing the device driver code).</p> <p></p> <p>Once the values are entered, select Save Channel. ThingSpeak will now show list of Channel Stats, made up of line plots for each field specified for the channel.</p> <p>Key note - at the top of this page is listed the Channel ID. Note this number - it is used to map a Device to a ThingSpeak Channel.</p>"},{"location":"iot_thingspeak/#setting-up-thingspeak-mqtt","title":"Setting Up ThingSpeak MQTT","text":"<p>The DataLogger IoT uses MQTT to post data to a channel. From the ThingSpeak menu, select Devices &gt; MQTT, which displays a list of your MQTT devices. From this page, select the Add a new device button.</p> <p>On the presented dialog, enter a name for the MQTT connection and in the Authorize channels to access, select the channel created earlier. Once you select a channel, click the Add Channel button.</p> <p>More channels can be added later.</p> <p></p> <p>When the MQTT device is created, a set of credentials (Client ID, Username, and Password) is provided. Copy or download these values, since the password in not accessible after this step.</p> <p>The selected Channel is then listed in the Authorized Channel table. Ensure that the Allow Publish and Allow Subscribe attributes are enabled for the added channel.</p> <p></p> <p>At this point, the ThingSpeak Channel is setup for access by the DataLogger IoT.</p>"},{"location":"iot_thingspeak/#thingspeak-configuration","title":"ThingSpeak Configuration","text":"<p>Once the device is integrated into the application, the specifics for the ThingSpeak Channel(s) must be configured. This includes the following:</p> <ul> <li>Server Name/Hostname</li> <li>Client Name</li> <li>User Name</li> <li>Password</li> <li>Device to Channel mapping</li> <li>CA Certificate Chain</li> </ul>"},{"location":"iot_thingspeak/#server-namehostname","title":"Server Name/Hostname","text":"<p>This value is hostname of the ThingSpeak mqtt connection, which is mqtt3.thingspeak.com as note at ThingSpeakMQTT Basics page. Note a secure connection is used, so the port for the connection is <code>8883</code>.</p>"},{"location":"iot_thingspeak/#client-nameid","title":"Client Name/ID","text":"<p>The Client Name/ID is found under MQTT connection details listed in the Devices &gt; MQTT section of ThingSpeak.</p>"},{"location":"iot_thingspeak/#username","title":"Username","text":"<p>The Username is found under MQTT connection details listed in the Devices &gt; MQTT section of ThingSpeak.</p>"},{"location":"iot_thingspeak/#password","title":"Password","text":"<p>The connection password was provided when the MQTT device was created. If you lost this value, you can regenerate a password on the MQTT Device information page.</p>"},{"location":"iot_thingspeak/#certificate-file","title":"Certificate File","text":"<p>You can download the cert file for ThingSpeak.com page using a web-browser. Click on the security details of this page, and navigate the dialog (browser dependent) to download the certificate. The downloaded file is the made available for the DataLogger IoT to use as a file that is loaded at runtime)</p>"},{"location":"iot_thingspeak/#setting-properties","title":"Setting Properties","text":"<p>The above property values must be set on the DataLogger IoT before use. They can be manually by using the menu system like the previous MQTT example.</p> <p>For users that are interested in using the menu system, you will need to open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then enter the ThingSpeak MQTT Menu. When the menu system for the ThingSpeak MQTT connection is presented, you will need to configure the property values as listed in the JSON file.  Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The alternative to using the menu system is a JSON file. These values can be set using a JSON file that is loaded by the system at startup. For the ThingSpeak example outlined in this document, the entries in the settings JSON file are as follows:</p> <pre><code>\"ThingSpeak MQTT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"mqtt3.thingspeak.com\",\n    \"MQTT Topic\": \"\",\n    \"Client Name\": \"MQTT_Device_Client_ID\",\n    \"Buffer Size\": 0,\n    \"Username\": \"MQTT_Device_Username\",\n    \"Password\": \"MQTT_Device_Password\",\n    \"CA Cert Filename\": \"ThingspeakCA.cer\",\n    \"Channels\" : \"BME280=2054891\"\n  }\n</code></pre> <p>The Channels value is a list of [DEVICE NAME]=[Channel ID] pairs. Each pair is separated by a comma. In this case, the device name <code>BME280</code> and the channel ID was <code>2054891</code>. Make sure to match the device name that was loaded on start up with the unique channel ID that was generated when creating a ThingSpeak Channel.</p> <p>Besides updating the <code>Server</code>, <code>Client Name</code>, <code>Username</code>, <code>Password</code>, <code>CA Cert Filename</code>, and <code>Channels</code>, you will need to also ensure that the <code>port</code> is set to <code>8883</code>. The default in previous firmware versions was <code>1883</code>. As of firmware v01.00.04, the default is <code>8883</code>. You will need to adjust the port value to properly connect to the ThingSpeak service. Don't forget to enable ThingSpeak MQTT service by setting the value to <code>true</code>. If the JSON file is saved in the microSD card, you can load the credentials to the DataLogger IoT.</p> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the ThingSpeak MQTT as well.</p>"},{"location":"iot_thingspeak/#monitoring-output","title":"Monitoring Output","text":"<p>Once the connector is configured and the DataLogger IoT is connected to ThingSpeak, as data is posted, the results are show on the Channel Stats page for your Channel. For the above example, the output of a SparkFun BME280 sensor produces the following output:</p> <p></p>"},{"location":"iot_thingspeak/#setting-up-2x-or-more-devices","title":"Setting Up 2x or More Devices","text":"<p>For users that are setting up 2x or more devices on the DataLogger IoT, you will need to ensure that each device has their own ThingSpeak Channel. Unfortunately, you are not able to plot sensor readings from two devices in the same channel.</p> <p>The following example demonstrates how to set up two devices for ThingSpeak on the DataLogger IoT. In this case, we will use the BME688 and BME680 and their respective default I<sup>2</sup>C address. This is also a good example of what to do when two devices use the same device driver. Head to ThingSpeak to create a channel for each device connected to the DataLogger IoT. Include a field for each device data that the DataLogger provides. The name of the channel does not need to match the device name or I<sup>2</sup>C address.</p> <p>Creating a Channel for the BME688</p> <p></p> <p>Creating a Channel for the BME680</p> <p></p> <p>Once the channels are created, you will be provided with a unique channel ID for each channel. Make sure to take note of the number as explained earlier.</p> <p>The alternative I<sup>2</sup>C address for the BME688 and BME680 uses the same address as the default of the other sensor:</p> <ul> <li>BME680: 0x77 (Default) or 0x76</li> <li>BME688: 0x76 (Default) or 0x77</li> </ul> <p>Make sure to avoid using the same address when connecting the sensors to the same DataLogger IoT.</p> <p>When setting up the connection, you will need to authorize both channels. In this example, we included the channels for the BME688 [x076] and BME680 [x077].</p> <p>Authorizing 2x Channels through the Same Connection</p> <p></p> <p>Now that the ThingSpeak MQTT connection is setup, adjust the ThingSpeak configuration for the DataLogger IoT by including the credentials (i.e. Client Name, Username, and Password) and channels. We will assume that you have included the ThingSpeak CA certificate file in the root directory of the microSD card already. When including the device name with their respective channel, ensure that the device name matches the name that was loaded on startup. For example, the BME688 and BME680 were loaded on startup as <code>BME68x</code> and <code>BME68x [x77]</code>, respectively. Since we are only interested in plotting the BME688 and BME680, we will ignore the MAX17048 that was loaded on startup as well. Under /Settings/ThingSpeak MQTT/Channels, you will enter the string for the device names, each of their respective channel IDs, and a comma separating the two channels like so: <code>BME68x=2613826, BME68x [x77]=2613825</code>.</p> <p>DataLogger IoT Device Name Loaded during Startup</p> <p></p> <p>Device Name and Channel for Both Sensors</p> <p></p> <p>Whenever there are multiple devices using the same device driver (each with unique I<sup>2</sup>C addresses), the DataLogger IoT will display the device address for each additional device that is loading the same driver. As shown above, the first device name did not include the device's I<sup>2</sup>C address. The second device name using the same driver included its I<sup>2</sup>C address. Of course, there is an configuration that enables you to always include the address of all the device names.</p> <p>The alternative to using the menu system is the JSON file. In this case, we updated channels for the BME688 and BME680. Not shown are the ThingSpeak Client Name, Username, and Password.</p> <pre><code>\"ThingSpeak MQTT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"mqtt3.thingspeak.com\",\n    \"MQTT Topic\": \"\",\n    \"Client Name\": \"MQTT_Device_Client_ID\",\n    \"Buffer Size\": 0,\n    \"Username\": \"MQTT_Device_Username\",\n    \"Password\": \"MQTT_Device_Password\",\n    \"CA Cert Filename\": \"ThingspeakCA.cer\",\n    \"Channels\" : \"BME68x=2613826, BME68x [x77]=2613825\"\n  }\n</code></pre> <p>If users configure the DataLogger IoT to always include the device address with the device names (i.e. /Settings/Application Settings with Device Names=1), you will need to match the device names for BME688 and BME680 that were loaded on startup as <code>BME68x [x76]</code> and <code>BME68x [x77]</code>, respectively. Note the BME688 device name included a space and <code>[x76]</code> in this case. Remember, we are only interested in plotting hte BME688 and BME680 in this case so we will ignore the MAX17048 that was loaded on startup.</p> <p>DataLogger IoT Device Names Loaded during Startup</p> <p></p> <p>Device Name and Channel for Both Sensors with Respective Addresses</p> <p></p> <p>Again, the alternative to using the menu system is the JSON file. In this case, we updated channels for the BME688 and BME680. We also included the address name for the BME688 like the configuration menu. Not shown are the ThingSpeak Client Name, Username, and Password.</p> <pre><code>\"ThingSpeak MQTT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"mqtt3.thingspeak.com\",\n    \"MQTT Topic\": \"\",\n    \"Client Name\": \"MQTT_Device_Client_ID\",\n    \"Buffer Size\": 0,\n    \"Username\": \"MQTT_Device_Username\",\n    \"Password\": \"MQTT_Device_Password\",\n    \"CA Cert Filename\": \"ThingspeakCA.cer\",\n    \"Channels\" : \"BME68x [x76]=2613826, BME68x [x77]=2613825\"\n    }\n</code></pre> <p>Save the configuration to persistent memory and exit out of the configuration menu. Wait a few seconds for the DataLogger IoT to read the sensors and output the readings to the Serial Terminal. Open ThingSpeak channels in separate browser windows. In this case, we had the BME688 and the BME680 in private view. You should see sensor readings update and plot on the charts.</p> <p>ThingSpeak Graphing the BME688 and BME680 in Seperate Channels on Two Browser Windows</p> <p></p>"},{"location":"iot_web_server/","title":"IoT Web Server","text":""},{"location":"iot_web_server/#the-datalogger-iot-web-server","title":"The DataLogger IoT Web Server","text":"<p>As of firmware v01.02.00, log files can be viewed and downloaded over a WiFi network! This saves you time by allowing you to download the files without the need to disconnect the DataLogger IoT and manually remove microSD card.</p> <p>The following is covered by this document:</p> <ul> <li>How a user configures and uses the HTTP connection</li> <li>Use examples</li> </ul>"},{"location":"iot_web_server/#iot-web-server-connection-setup","title":"IoT Web Server Connection Setup","text":"<p>To connect to the ESP32's IoT Web Server, the following information is needed:</p> <ul> <li>The server name/address</li> <li>[optional] A username - if required</li> <li>[optional] A password - if required</li> </ul>"},{"location":"iot_web_server/#iot-web-server-menu-system","title":"IoT Web Server Menu System","text":"<p>We'll need to adjust the settings for the IoT Web Server.</p> <p>For users that are interested in using the menu system, open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then select the IoT Web Server Menu. When the menu system for the IoT Web Server is presented, the following options are displayed:</p> <p></p> <p>The options are:</p> <ul> <li>Enable/Disable the connection</li> <li>Username</li> <li>Password</li> <li>Enable/Disable mDNS support</li> <li>mDNS name</li> </ul> <p>At a minimum, you will just need to enable the connection. However, we recommend enabling mDNS support if it is supported in your network.</p> <p>Once all these values are set, the system will serve the log files in your local 2.4GHz WiFi network following the JSON information structure noted below in this document.</p>"},{"location":"iot_web_server/#json-file-entries","title":"JSON File Entries","text":"<p>If a JSON file is being used as an option to import settings into the DataLogger IoT, the following entries are used for the IoT web server:</p> <pre><code>\"IoT Web Server\": {\n  \"Enabled\": false,\n  \"Username\": \"\",\n  \"Password\": \"\",\n  \"mDNS Support\": false,\n  \"mDNS Name\": \"dataloggerAD6B8\"\n},\n</code></pre> <p>Where:</p> <ul> <li><code>Enabled</code> - Set to <code>true</code> to enable the connection.</li> <li><code>Username</code> - Web server user name if being used.</li> <li><code>Password</code> - Web server password if being used.</li> <li><code>mDNS Support</code> - Set to <code>true</code> if multicast DNS is supported. This allows you to enter the address as \"<code>http://dataloggerXXXXX.local</code>\" (where <code>XXXXX</code> is generated from the last 5x characters from your board ID) rather than typing the exact IP address of the ESP32.</li> <li><code>mDNS Name</code> - Multicast DNS name. In this case, the default name was set to <code>dataloggerAD6B8</code>. This name will be different depending on your DataLogger IoT's board ID so <code>AD6B8</code> will be different for your board.</li> </ul> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the MQTT Client as well.</p>"},{"location":"iot_web_server/#connect-and-download-log-file","title":"Connect and Download Log File","text":"<p>To use this feature, ou will need to make sure that the ESP32 is on the same network as your computer in order to access the log files. Addionally, when authentication is enabled, some browsers might require a second login depending on user settings.</p>"},{"location":"iot_web_server/#using-a-local-server-name","title":"Using a local server name","text":"<p>Once the web server is enabled and the settings are saved, you will need to reboot the DataLogger IoT. As the DatLogger initializes, it will connect to your WiFi Network. Take note of the mDNS address, in this case, it was \"<code>http://dataloggerAD6B8.local</code>\".</p> <p></p> <p>Once the DataLogger IoT has finished initializing, open web browser. Connect the DataLogger IoT by entering the address \"<code>http://dataloggerXXXXX.local</code>\", where <code>XXXX</code> is the last 5x characters of your board ID. You will be presented with the log files available on the microSD card. Click on a log file to download and save it to your computer.</p> <p></p>"},{"location":"iot_web_server/#using-the-datalogger-iot-ip-address","title":"Using the DataLogger IoT IP Address","text":"<p>If mDNS is not supported on your network, you can also enter the IP address of the Datalogger IoT into a web browser to view and download the log files. You can view the IP address when the DataLogger IoT is initializing. If you have administrative privileges to the WiFi Network, you can also view the IP address through your  WiFi router as well.</p> <p></p> <p>Now that you have downloaded the log files, try graphing the data on a spreadsheet!</p>"},{"location":"log-settings-file/","title":"Logging - Data File","text":"<p>A key feature of the DataLoggerIoT is logging data to an IoT web service, but it still performs core data logging functionality, including logging data to a file on an SD card.</p> <p>The logging to a file includes <code>file rotation</code> - after a specific period of time, a new file is created using a numbering scheme and prefix.</p>"},{"location":"log-settings-file/#options","title":"Options","text":"<p>In the Settings menu, select the Data File Menu Item to adjust the Logging Data File.</p> <p></p> <p>Data File Menu Options</p> <p>Adjusting these parameters allows you to change the filename prefix, the number the files starts at, and how often the DataLogger will create a new file on the microSD card.</p> <p>The file naming scheming used is:  <code>[prefix string][number].txt</code></p> <p>For example, the default file will be saved as sfe0001.txt. After 1 day, the DataLogger will rotate files by creating a new file named sfe0002.txt. The DataLogger will begin logging data in this new file. The purpose of this log rotation is to limit the size of each file prevent issues when opening large files.</p>"},{"location":"log-settings-file/#settings","title":"Settings","text":""},{"location":"log-settings-file/#rotate-period","title":"Rotate Period","text":"<p>This value is the time between file rotation.</p> <p>Options for this setting are:</p> <ul> <li>6 Hours</li> <li>12 Hours</li> <li>1 Day</li> <li>2 Days</li> <li>1 Week</li> </ul>"},{"location":"log-settings-file/#file-start-number","title":"File Start Number","text":"<p>The number to start the file name numbering.</p>"},{"location":"log-settings-file/#details","title":"Details","text":"<p>The contents of the file will depend on how the data was saved (either CSV or JSON). Make sure that the SD Card format is enabled to either CSV or JSON with your desired device outputs turned on so that the DataLogger can save the readings.</p> <p>When removing the microSD card, make sure to remove your power source. Then insert into it into microSD card adapter or USB reader. When connecting the memory card to your computer, you can use a text editor to view the saved readings. In this case, a Windows operating system was viewing the file sfe0000.txt and it was only file available in the microSD card.</p> <p></p> <p>Reading data value from Text File</p>"},{"location":"log-settings-interrupt/","title":"Interrupt Trigger","text":"<p>This option is used to setup an external interrupt as a trigger for a logging event. By connecting an external device that will trigger an interrupt to a GPIO pin on the DataLoggerIoT, an external device can cause an log event to occur.</p> <p>When this menu item is selected, the following settings menu is displayed:</p> <p></p> <p>Logger Interrupt Menu Options</p>"},{"location":"log-settings-interrupt/#settings","title":"Settings","text":"<p>The settings for this feature are the following:</p>"},{"location":"log-settings-interrupt/#enabled","title":"Enabled","text":"<p>Use this setting to enable/disable this functionality</p>"},{"location":"log-settings-interrupt/#event-name","title":"Event Name","text":"<p>A string that represents the \"name\" of the logging event. This name can be displayed using the \"event source\" option of the Logger.</p>"},{"location":"log-settings-interrupt/#interrupt-pin","title":"Interrupt Pin","text":"<p>The  DataLoggerIoT GPIO Pin to use to detect the external interrupt.  Valid pins are: <code>33</code> and <code>36</code> and selected in the options menu.</p>"},{"location":"log-settings-logger/","title":"Logger Setup","text":"<p>In the Settings menu, select the Logger menu to adjust how data is logged, including what additional data to provide besides sensor readings.</p> <p>When this menu option is selected, the following menu is presented:</p> <p></p> <p>Logger Menu Options</p> <p>Details of menu item are outlined in the following sections.</p>"},{"location":"log-settings-logger/#settings","title":"Settings","text":""},{"location":"log-settings-logger/#timestamp-mode","title":"Timestamp Mode","text":"<p>This setting is used to add a timestamp to the output logging stream for each data sample/observation. The format of the timestamp is also selected.</p> <p>The options for this settings are:</p> <ul> <li>No Timestamp - no timestamp is added to the output - this is the default option</li> <li>Milliseconds since program start - Time since the system was started, in milliseconds</li> <li>Seconds since Epoch - Seconds since epoch (January 1, 1970 00:00:00.00 UTC). A valid system time is required for this value to be accurate.</li> <li>Milliseconds since Epoch - Milliseconds since epoch (January 1, 1970 00:00:00.00 UTC). A valid system time is required for this value to be accurate.</li> <li>Date Time - USA Date format - a data/time string formatted using standard US date format - MM-DD-YYYY</li> <li>Date Time - A standard non-USA formatted date string - DD-MM-YYYY</li> <li>ISO8601 Timestamp - an ISO8601 formatted timestamp</li> <li>ISO8601 Timestamp with Time Zone - an ISO8601 formatted timestamp with the current time zone included</li> <li>ISO8601 Timestamp - Week Date - an ISO8601 formatted timestamp using a week date format</li> <li>ISO8601 Timestamp - Week Date with Time Zone - an ISO8601 formatted timestamp using a week date format and the current time zone.</li> </ul>"},{"location":"log-settings-logger/#sample-numbering","title":"Sample Numbering","text":"<p>The \"sample number\" for a the logged data is included in the log stream. This is incremented with each log event by the value of the Number Increment setting value</p>"},{"location":"log-settings-logger/#numbering-increment","title":"Numbering Increment","text":"<p>The amount to increment the output Sample Number after each logged observation.</p>"},{"location":"log-settings-logger/#output-id","title":"Output ID","text":"<p>Include the DataLoggerIoT board ID in the output log stream</p>"},{"location":"log-settings-logger/#output-name","title":"Output Name","text":"<p>Include the DataLoggerIoT board Name in the output log stream</p>"},{"location":"log-settings-logger/#rate-metric","title":"Rate Metric","text":"<p>If enabled, the system will record the logging data rate. This is helpful in determining the performance of the datalogger.</p>"},{"location":"log-settings-logger/#output-source-name","title":"Output Source Name","text":"<p>When enabled, the source of the logging event is included in the log stream. This could include values like 'timer', 'GPIO Interrupt', 'GNSS PPS' ...etc.</p>"},{"location":"log-settings-logger/#output","title":"Output","text":"<p>These settings are used to control output format and additional values for the datalogger.</p>"},{"location":"log-settings-logger/#sd-card-format","title":"SD Card Format","text":"<p>The format used when writing to the SD Card - options are CSV, JSON, or None.</p>"},{"location":"log-settings-logger/#serial-console-format","title":"Serial Console Format","text":"<p>The format used when writing data to the serial console - options are CSV, JSON, or None.</p>"},{"location":"log-settings-logger/#system-info","title":"System Info","text":"<p>When enabled, the following data is added to the log stream:</p> <ul> <li>WiFi SSID</li> <li>WiFi RSSI</li> <li>System uptime</li> <li>System SD Card free space</li> <li>System memory heap</li> </ul>"},{"location":"log-settings-logger/#functions","title":"Functions","text":""},{"location":"log-settings-logger/#reset-sample-counter","title":"Reset Sample Counter","text":"<p>This will reset the sample counter in the logger to a provided value.</p>"},{"location":"log-settings-logger/#example-output","title":"Example Output","text":"<p>The following image is JSON formatted serial console output for the datalogger. The following options are enabled:</p> <ul> <li>Timestamp enabled - ISO8601 Timestamp format</li> <li>Board ID</li> <li>Board Name</li> <li>Trigger source</li> <li>System Info</li> </ul> <p></p> <p>JSON Formatted Log Output to the Serial Console</p>"},{"location":"log-settings-timer/","title":"Logging Timer","text":"<p>In the Settings menu,  select the Timer option adjust the Logging Timer period value.</p> <p>When selected, the following menu is presented.</p> <p></p> <p>Logging Timer Menu Options</p> <p>Adjusting the interval for the Logging Timer will change the amount of time between log entries.</p>"},{"location":"log-settings-timer/#settings","title":"Settings","text":""},{"location":"log-settings-timer/#interval","title":"Interval","text":"<p>The interval between log-events in milliseconds.</p>"},{"location":"net-ntp-setup/","title":"NTP Client Setup","text":"<p>NTP - Network Time Protocol -  It is a networking protocol used to synchronize the clocks of computers over a network. NTP ensures that all devices on a network maintain the same accurate time, which is crucial for various applications such as logging events, security protocols, and time-sensitive transactions.</p> <p>When connected to the network (via WiFi), the DataLoggerIoT can use NTP as a time refernce. To do this, NTP must be enabled and NTP services to use specified. The configuration of NTP for the DataLoggerIoT is enabled in this secton of the Settings menu.</p>"},{"location":"net-ntp-setup/#ntp-configuration","title":"NTP Configuration","text":"<p>In the Settings menu, under the Network heading,  select the NTP Client settings.</p> <p></p> <p>NTP Client</p> <p>The NTP configuration has the following settings:</p> Setting Description Enabled Used to Enable or Disable the use of NTP by the DataLoggerIoT NTP Server One The primary NTP Server to use. Default value is: pool.ntp.org* NTP Server Two The secondary NTP Server to use. Default value is: time.nist.gov <p>Note</p> <p>Only one NTP service is required to use this option, but it's common to provice two for redundancy.</p> <p>Once changes are made to the NTP settings, the should take effect immediatly.</p>"},{"location":"net-wifi-setup/","title":"WiFi Settings","text":"<p>In the Settings Menu, select the WiFi settings. Up to 4 sets of WiFi credentials can be saved.</p> <p>Once you are in the WiFi Network menu, you can enable/disable WiFi and save the WiFi network credentials. Once connected to a 2.4GHz WiFi network, you can synchronize the date and time, connect to an IoT service to log data, and update the latest firmware over-the-air. Since the WiFi is turned on by default, you will simply need to save the WiFi network's name and password.</p> <p></p> <p>Enter WiFi Networks</p> <p>The WiFi system of the DataLoggerIoT can store up to four sets of WiFi creditials, but only one is required for connected operation. When connecting to the WiFi network, the DataLoggerIoT will attempt to locate and connect to a specified WiFi network, until a valid network is found. Having multi networks allows the DataLoggerIoT to move between locations and continue to operate without any user interaction.</p>"},{"location":"net-wifi-setup/#wifi-configuration","title":"WiFi Configuration","text":"<p>The following configuration properties are provided for the WiFi connection:</p> Setting Description Enabled Enable or Disable the WiFi Network connection Network Name The SSID of the WiFi network Password The Password to connect to the WiFi network Network 2 Name Alternative network 2 SSID Network 2 Password Alternative network 2 Password Network 3 Name Alternative network 2 SSID Network 3 Password Alternative network 3 Password Network 4 Name Alternative network 2 SSID Network 4 Password Alternative network 4 Password <p>When settings are changed, the DataLoggerIoT should be restarted to have the new settings take effect.</p> <p>Note</p> <p>The ESP32-WROOM can only connect to a 2.4GHz WiFi network.</p>"},{"location":"net-wifi-setup/#using-a-nfc-to-set-wifi-credentials","title":"Using a NFC to Set WiFi Credentials","text":"<p>If you have a Qwiic Dynamic NFC/RFID Tag connected to the board's Qwiic connector, you can easily update your WiFi credentials! Just make sure to save the WiFi credentials to the tag.</p> <p>If you saved your preferences to a JSON file on your microSD card's root directory, you can also save your WiFi credentials and load the system settings from the menu as well!</p>"},{"location":"prepare_your_microsd_card/","title":"MicroSD Card Setup","text":""},{"location":"prepare_your_microsd_card/#microsd-card-setup","title":"MicroSD Card Setup","text":"<p>Not all microSD cards are created equal. The capacity, read/write speed, and format vary depending on the manufacturer. In order to log data to the microSD card, you will need to ensure that your memory card is formatted as FAT32. You can also use FAT16. If the memory card is formatted as a different memory card, the DataLogger IoT will not be able to recognize the microSD card.</p>"},{"location":"prepare_your_microsd_card/#checking-microsd-card-format","title":"Checking MicroSD Card Format","text":"<p>While you can simply insert the microSD card into your DataLogger IoT and start logging, there may be a chance that the it will not recognize the memory card due to the format.</p>"},{"location":"prepare_your_microsd_card/#checking-microsd-card-format-windows","title":"Checking MicroSD Card Format - Windows","text":"<p>To check to see if it is the correct format on a Windows you could head to the drive, right click, and select Properties.</p> <p></p> <p>SD Card Properties Menu Entry on Windows</p> <p>Once the properties are open, you should be able to tell what file system that the memory card uses. In this case, it was exFAT which is not compatible with the DataLogger IoT. You will need to reformat the memory card since it is not formatted as FAT32.</p> <p></p> <p>Format of exFat - Not Compatable</p> <p>The format should be <code>FAT32</code></p> <p></p> <p>FAT32 Format - Compatable with the DataLogger IoT</p>"},{"location":"prepare_your_microsd_card/#checking-microsd-card-format-macos","title":"Checking MicroSD Card Format - macOS","text":"<p>To check to see if it is the correct format on a macOS, you could head to the drive on your desktop. Then right click, and select Get Info.</p> <p></p> <p>\"Get Info\" on MacOS</p> <p>A window will pop up indicating the microSD card properties. Under General: &gt; Format:, you should be able to tell what file system that the memory card uses. In this case, it was exFAT which is not compatible with the DataLogger IoT. You will need to reformat the memory card since it is not formatted as FAT32.</p> <p></p> <p>Showing Format as exFat</p> <p>To reformat the drive, the built in <code>Disk Utility</code> application on macOS can be used. Once the SD Card is reformatted, the <code>Get Info</code> dialog will show:</p> <p></p> <p>FAT32 Format on macOS</p>"},{"location":"prepare_your_microsd_card/#download-raspberry-pi-imager","title":"Download Raspberry Pi Imager","text":"<p>There are a few methods and programs available to reformat your microSD card as a FAT32. We found it easier to use the Raspberry Pi Imager Tool. Of course, you will only be using the tool to erase the contents of the microSD card and formatting it as a FAT32 system. You will not actually flash any image to the memory card. Click on the button below to download the tool from the Raspberry Pi Foundation. It is supported on Windows, macOS, and Ubuntu for x86.</p>"},{"location":"prepare_your_microsd_card/#formatting-as-fat32-using-the-raspberry-pi-imager","title":"Formatting as FAT32 using the Raspberry Pi Imager","text":"<p>After downloading and installing the software, open the Raspberry Pi Imager.</p> <p></p> <p>Raspberry Pi Imager</p> <p>Under \"Operating System\", select \"Erase\" to \"format card as FAT32.\"</p> <p></p> <p>Select 'ERASE' for Operating System</p> <p>Under \"Storage\", select the drive that the microSD card appeared as on your computer.</p> <p></p> <p>Storage is the SD Card</p> <p>When ready, select \"Write\". After a few minutes, the microSD card should be formatted with FAT32.</p> <p></p> <p>Writing/Reformatting the SD Card</p> <p>Once the memory card has finished formatting, eject the microSD from your computer. To check to see if the microSD card is formatted as FAT32, you can check its properties as explained earlier with your operating system.</p>"},{"location":"ref-serial-terms/","title":"Serial Terminals","text":"<p>The key to the setup and interactive operation of the  the SparkFun DataLoggerIoT is a modern, interactive Serial Terminal program. Keyboard input and text output are required to be immdiate, to support the interactive menu system of the IoT DataLoggerIoT. Luckily a majority of serial terminal support interactive use. The notible exeception is the build in Arduino IDE Serial Monitor, which requires text to be entered and \"submitted\" or sent to the device. The Arduino Serial Monitor is not supported for interactive use by the DataLoggerIoT</p>"},{"location":"ref-serial-terms/#common-serial-terminal-softwareapplications","title":"Common Serial Terminal Software/Applications","text":"<p>There are plenty of free Serial Terminals out there to configure the DataLogger IoT.</p> <ul> <li>Minicom (Linux/Unix, MacOS)</li> <li>Screen (Linux/Unix, MacOS)</li> <li>Tera Term (Windows)</li> <li>RealTerm (Windows)</li> </ul> <p>Note</p> <p>A serial terminal client that supports edit characters is required. Most if not all modern serial terminal programs will have the ability to support interactive edits. We have tested the DataLogger IoT with the Tera Term application, <code>minicom</code> command, and the <code>screen</code> command.</p> <p>If this is the your first time using a terminal window, We recommend checking out the Serial Terminal Basics tutortial.</p> <p>The above guides will show you how to open the correct port for the DataLogger IoT and how to set the baud rate to 115200 baud. You can change the DataLogger IoT's baud rate through the configuration menus too should you need to.</p> <p>Arduino IDE Serial Monitor -  Not Recommended</p> <p>The Arduino IDE Serial Monitor is not intented for interacive user and should not be used with the DataLogger IoT. For users with an Arduino IDE, you could also use the Arduino Serial Monitor by setting the line ending to Newline. Users will also need to <code>CTRL</code> + <code>Enter</code> when sending any character to the DataLogger IoT. However, we recommend using one of the terminals mentioned earlier.</p>"},{"location":"release_notes/","title":"Release Notes","text":""},{"location":"release_notes/#sparkfun-datalogger-iot-firmware-version-15","title":"SparkFun DataLogger IoT Firmware - Version 1.5","text":"<p>January 2026</p>"},{"location":"release_notes/#new-features-and-enhancements","title":"New Features and Enhancements","text":""},{"location":"release_notes/#new-device-support","title":"New Device Support","text":"<p>Support for the following new SparkFun qwiic devices</p> <ul> <li>SparkFun Air Quality PM1/PM2.5/PM10 Sensor - BMV080 (Qwiic)</li> <li>SparkFun Spectral Sensor - AS7343 (Qwiic)</li> </ul>"},{"location":"release_notes/#uart-data-logging","title":"UART Data Logging","text":"<p>Connect an external uart/serial device to the DataLogger IoT board and any input recieved from that device is output within the current logging stream (Serial console, SD Card, IoT endpoint ...)</p>"},{"location":"release_notes/#log-values-from-an-analog-pin","title":"Log Values from an Analog Pin","text":"<p>Connect an anlog device/sensor to a specified DataLogger GPIO pin and the data value is written to the current log stream/output.</p>"},{"location":"release_notes/#support-for-the-sparkfun-analog-soil-mosture-sensor","title":"Support for the SparkFun Analog Soil Mosture Sensor","text":"<p>Connect the SparkFun Soil Moisture Sensor to the specified/selected (via menu system) GPIO pins of the DataLogger IoT board and the senor values are output to the output log stream.</p> <p>Note - the qwiic Soil Moisture Sensor is not supported by the DataLogger IoT due to I2C bus incompatablity (i2c clock stretching)</p>"},{"location":"release_notes/#trigger-logging-via-interrupt","title":"Trigger Logging via Interrupt","text":"<p>When enabled, with an interrupt connected to a specified (in the menu system) DataLogger IoT GPIO pin, a logging event is triggered when the interrupt is fired.</p>"},{"location":"release_notes/#trigger-logging-using-the-pps-signal-from-a-gnss-device","title":"Trigger Logging using the PPS signal from a GNSS device","text":"<p>When enabld and the GNSS device PPS signal is connected to a specified GPIO pin on the DataLogger IoT, a logging event is triggered when the PPS signal is sent.</p>"},{"location":"release_notes/#general-improvements","title":"General Improvements","text":"<ul> <li>Fixed issues with the ISO8601 date formatting in the logging system</li> <li>Improved support for verbose logging via the menu system</li> <li>Fixed issue with epoch tick output values</li> <li>Can now add the log-event trigger source to the log-stream output.</li> </ul> <p>And this new functionality is available today at the DataLogger repo as a beta release.  The update is free, available as a file uploaded via an SD Card.  Just select the \u201cSystem Update\u201d option within the DataLogger IoT menu system and select your desired upgrade option.</p>"},{"location":"release_notes/#sparkfun-datalogger-iot-firmware-version-12","title":"SparkFun DataLogger IoT Firmware - Version 1.2","text":"<p>April 15th, 2024</p> <p>With the release of our version 1.2 software for our DataLogger IoT products, we continue to add additional functionally to the products capability, as well as fix a number of issues.</p> <p>And with the release, we feel we\u2019ve covered all aspects of a 1.1 release \u2013 new functionality, feature enhancements, and a wide variety of bug fixes.  </p>"},{"location":"release_notes/#new-features-and-enhancements_1","title":"New Features and Enhancements","text":""},{"location":"release_notes/#log-file-download-via-a-web-interface","title":"Log File Download via a Web Interface","text":"<p>To allow access to log files located on the DataLogger IoT device, without requiring the removal of the SD card, a new Web Interface is provided. Once enabled, you can browse the on-board log files of the DataLogger. Clicking on a a filename will download the file.</p> <p></p> <p>Currently file browse and download options are available, but we plan on expanding this feature in the future.</p> <p>Additionally, this feature has the following options:</p> <ul> <li>mDNS functionality allowing you to set a network name for a device if mDNS is supported on your network</li> <li>Username/Password authentication for the web interface.</li> </ul> <p>Note: For authentication use - currently some browsers might require a second login depending on settings.</p> <p>Note</p> <p>The datalogger requires restarting if the web interface is enabled</p> <p>This feature is enabled in settings under the Preview heading.</p>"},{"location":"release_notes/#startup-command-menu-and-delay","title":"Startup Command Menu and Delay","text":"<p>To allow start-up time configuration and delay, a Startup Menu was added to the system. Now, at startup a short menu is presented for a brief period, allowing modification of the startup options of the DataLogger.</p> <p>Startup Menu options:</p> <p>Pressing the highlighted letter while the menu is active, will change the behavior of the system. This change only affects the current system session.</p> <p>The options include:</p> <ul> <li>'n' - Normal startup</li> <li>'a' - Disable I2C device auto load on startup</li> <li>'l' - List the I2C devices supported. This device table is discarded after auto-load</li> <li>'w' - Disable WiFi</li> <li>'s' - Disable preference restore during startup</li> </ul> <p>In addition, the amount of time the menu is displayed is adjustable.  This settings is on the Settings/Application Settings page, under the Advanced section.</p>"},{"location":"release_notes/#quick-commands","title":"Quick (!) Commands","text":"<p>The addition of a quick (!) command system that allows for the direct execution of commands directly from the serial console, bypassing the serial menu system.</p> <p>An example of this is the display of the \"about\" page for the system. Normally this would require navigating the serial menu system. With the quick command system, entering the value of \"!about\" at the serial console will display the about page.</p> <p>The following commands are supported:</p> Command Description !about Display the system about page !clear-settings Clear the on board system preferences with a yes/no prompt !clear-settings-forced Clear the on board system preferences with no prompt !devices List the currently connected devices !factory-reset Perform a factory reset - presents a Y/N prompt !heap Display the current system heap memory usage !help List the available quick commands !json-settings For setting the device settings via a serial connection. When this command is sent, the system expects to receive a JSON settings file !log-now Perform a log observation event !log-rate If log rate measurement is enabled, the current log rate is printed !reset-device Reset the device - erasing any saved settings and restarting the device !reset-device-forced Reset the device, but without a Y/N prompt !restart Restart the device !restart-forced Restart the device without a Y/N prompt !save-settings Save the current settings to on-board flash !sdcard Output the current SD card usage statistics !systime Output current system time !uptime The uptime of the device !device-id The ID for the device !version The version of the firmware !wifi Output current system WiFi state"},{"location":"release_notes/#log-data-rate","title":"Log Data Rate","text":"<p>The DataLogger system can now measure the data logging rate. Once this feature is enabled, the system will monitor the time between log events. This value is averaged over the latest 10 log events.</p>"},{"location":"release_notes/#system-info-in-the-log-stream","title":"System Info in the log stream","text":"<p>The system operational parameters can now be added to log stream. This is useful to monitor system resource uses over time, or just perform general debugging.</p> <p>Currently the following information is provided:</p> <ul> <li>WiFi SSID</li> <li>WiFi RSSI</li> <li>Memory Heap free space in bytes</li> <li>SD Card free space in bytes</li> <li>Uptime in MS</li> </ul>"},{"location":"release_notes/#feature-improvements","title":"Feature Improvements","text":"<p>In addition to the new functionality, we also took input from our customers (and our own use) to expand and enhance existing features. While a wide variety of small additions were made, a few notable additions include:</p> <p>Serial Console - Value Display \u2013 The serial console now shows the current setting value in the menu system. Previously this value was only show once that item was selected.</p> <p>Serial Console Color \u2013 Text highlighting and color were added to the serial console output. If your serial console application/command supports it, the menu system highlights key values. This setting is controlled in the Settings/Application Settings section of the settings menu.</p> <p>Startup Messages \u2013 Normally a verbose log of startup options and settings are displayed at system startup. The about of information is now controllable - with values of Normal, Compact, Disabled.</p> <p>Improved Device Auto-Load \u2013 A major update to the I2C auto-load device detection logic that improves device detection and address collision prevention.</p> <p>General System Enhancements \u2013 Internal system job dispatch subsystem update to increase performance throughput. Overall decrease in static and dynamic memory usage.</p>"},{"location":"release_notes/#bug-fixes","title":"Bug Fixes","text":"<p>We also squashed a variety of defects in the firmware. Some of the more notable issued fixed in this release:</p> <ul> <li>Fixed issue with the LED display logic that caused a system crash if the log interval was less than 100ms</li> <li>Incorporate driver updates for greater NAU7802 device output value stability</li> <li>Incorporate driver update for the MMC5983MA device</li> </ul>"},{"location":"release_notes/#in-summary","title":"In Summary","text":"<p>With the release of DataLogger IoT firmware version 1.2.0 we continue to enhance the capabilities of our DataLogger IoT line \u2013 adding to our IOT service, supported devices as well as improving the overall quality of the system.</p> <p>And this new functionality is available today at the DataLogger repo.  The update is free, available as an over-the-air upgrade, or as a file uploaded via an SD Card.  Just select the \u201cSystem Update\u201d option within the DataLogger IoT menu system and select your desired upgrade option.</p>"},{"location":"release_notes/#sparkfun-datalogger-iot-firmware-version-11","title":"SparkFun DataLogger Iot Firmware - Version 1.1","text":"<p>November 11th, 2023</p> <p>Today we\u2019re releasing the latest firmware update for our line of DataLogger IoT products. While we\u2019ve released a services of small defect correct releases over the base 6 months, this release, officially version v1.01.00, is the first to include major new functionality.</p> <p>And with the release, we feel we\u2019ve covered all aspects of a 1.1 release \u2013 new functionality, feature enhancements, and a wide variety of bug fixes.  </p>"},{"location":"release_notes/#new-feature-arduino-iot-cloud-connectivity","title":"New Feature \u2013 Arduino IoT Cloud Connectivity","text":"<p>Being an IoT focused product, one of our goals is to enable easy access to leading IoT data services. With this in mind, for this release we worked closely with the Arduino Team to enabled easy access to the Arduino IoT Cloud directly from a DataLogger IoT Device.</p> <p>Setup a device in the Arduino IoT Cloud, add the credentials to your DataLogger IoT and you have a IoT based dashboard up and running in minutes. Want to add an additional device to your dashboard \u2013 add the device to the DataLogger IoT and the combined system automatically adds the additional data to the Arduino Cloud \u2013 ready for use in your dashboard.</p> <p></p> <p>The above image shows data from a DataLogger IoT with an Environmental Combo attached to it and mapping data to a plot graphic on an Arduino IoT Cloud dashboard.</p> <p>And like all DataLogger IoT functionality, no programming is required to produces these plots \u2013 all settings are provided via the intuitive serial console menu interface or set via a settings JSON file.</p> <p>With the combination of the DataLogger IoT, qwiic and Arduino IoT Cloud, creating a IoT dashboard is as easy as Plug-in, Connect, Plot!</p>"},{"location":"release_notes/#new-qwiic-sensor-board-support","title":"New qwiic Sensor Board Support","text":"<p>The original release of the DataLogger IoT firmware supported around 50 SparkFun qwiic development boards and with this release we\u2019ve added six boards additional qwiic boards.</p> <p>Selecting from our recently added qwiic products as well as from the list of popular products, the release of version 1.1 adds support for the following qwiic development boards.</p> <ul> <li>SparkFun Indoor Air Quality Sensor - ENS160</li> <li>SparkFun Photoacoustic Spectroscopy CO2 Sensor - PASCO2V01</li> <li>SparkFun Human Presence and Motion Sensor - STHS34PF80</li> <li>SparkFun Tristimulus Color Sensor - OPT4048DTSR</li> <li>SparkFun Triad Spectroscopy Sensor - AS7265x</li> <li>SparkFun 6DoF IMU Breakout - BMI270</li> </ul> <p>Like previously supported qwiic boards, the DataLogger IoT firmware automatically detects when a device is connected, making the new device automatically available to the logging, menu and IoT systems of the DataLogger IoT.</p> <p>All these new sensors are great adds on their own, but the ENS160 has the additional feature of supporting temperature and humidity calibration inputs. Connect an BME280 or an SHTC3 qwiic board along with an ENS160, and the DataLogger automatically connects the two devices!</p>"},{"location":"release_notes/#feature-improvements_1","title":"Feature Improvements","text":"<p>In addition to the new functionality, we also took input from our customers (and our own use) to expand and enhance existing features. While a wide variety of small additions were made, a few notable additions include:</p> <p>Improved Reference Clock Management \u2013 the internal logic was reviewed and improved. Additionally, time zone support was moved out of the NTP system, and into the overall clock management subsystem.</p> <p>Internal JSON Buffer Limits \u2013 The initial firmware had fixed sizes for the internal JSON data buffers used for saving settings and log data output. These values are now user settable in the settings menu. This allows for larger buffer support, as well as reducing the internal buffers to what you need.</p> <p>Add Device IDs to the Device Names \u2013 As you add more devices to a DataLogger, it\u2019s difficult to match the device to the actual devices address. Addresses are now included in device listings and the option to include the address in the device name is now available.</p> <p>Board Information in the Log Stream \u2013 To improve identification of a data source within the data log stream, the Board Name and Board ID can now be added if desired. As part of this functionality, a configurable name is now available for each DataLogger IoT.</p>"},{"location":"release_notes/#bug-fixes_1","title":"Bug Fixes","text":"<p>We also squashed a variety of defects in the firmware. Some of the more notable issued fixed in this release:</p> <ul> <li>Incorporated a fix in the RV8803 RTC Clock Arduino Library that resolved force ti*  shifts based on time zone. This was a \u201creal nasty one\u201d to resolve!</li> <li>Improved runtime memory (ram) consumption</li> <li>Resolved issues with devices having the same name. Now the second device adds it*  address to the name.</li> <li>Improvements to the Machinechat IoT driver</li> </ul>"},{"location":"release_notes/#in-summary_1","title":"In Summary","text":"<p>With the release of DataLogger IoT firmware version 1.1.0 we continue to enhance the capabilities of our DataLogger IoT line \u2013 adding to our IOT service, supported devices as well as improving the overall quality of the system.</p> <p>And this new functionality is available today at the DataLogger repo.  The update is free, available as an over-the-air upgrade, or as a file uploaded via an SD Card.  Just select the \u201cSystem Update\u201d option within the DataLogger IoT menu system and select your desired upgrade option.</p>"},{"location":"resources/","title":"Downloads","text":""},{"location":"resources/#software-documentents-and-posts","title":"Software, Documentents and Posts","text":""},{"location":"resources/#datalogger-iot-9dof","title":"DataLogger IoT - 9DoF","text":"<ul> <li>Schematic (PDF)</li> <li>Eagle Files (ZIP)</li> <li>Board Dimensions (PNG)</li> <li>Fritzing Part (FZPZ)</li> </ul>"},{"location":"resources/#datalogger-iot","title":"DataLogger IoT","text":"<ul> <li>Schematic (PDF)</li> <li>Eagle Files (ZIP)</li> <li>Board Dimensions (PNG)</li> <li>Fritzing Part (FZPZ)</li> </ul>"},{"location":"resources/#software","title":"Software","text":"<ul> <li>CH340 Drivers</li> <li>Firmware</li> </ul>"},{"location":"resources/#github-hardware-repo","title":"GitHub Hardware Repo","text":"<ul> <li>SparkFun DataLogger IoT - 9DoF</li> <li>SparkFun DataLogger IoT</li> </ul>"},{"location":"resources/#sfe-showcase","title":"SFE Showcase","text":"<ul> <li>DataLogger IoT - 9DoF</li> <li>DataLogger IoT</li> </ul>"},{"location":"resources/#blog-posts","title":"Blog Posts","text":"<ul> <li>IoT Platforms and Protocols</li> <li>Send Sensor Data to AWS All In Under 15 Minutes</li> <li>Extending the Reach of Data Logging</li> </ul>"},{"location":"single_page/","title":"Introduction","text":""},{"location":"single_page/#introduction","title":"Introduction","text":"<p>The SparkFun DataLogger IoT is a data logger that comes preprogrammed and ready to use immediatly - no programming, no setup - just plug in the board, add a supported qwiic sensor or two and start logging data. The built-in firmware automatically detects attached qwiic sensors, peforms any setup and starts logging sensor data. And with minimal configuration, the DataLogger IoT can connect to a local WiFi network and post data to a wide range of IoT data services.</p> <p>The DataLogger IoT automatically detects, configures, and logs Qwiic sensors. It was specifically designed for users who just need to capture a lot of data with minimal setup or development. It delivers a ready-to-use device that enables saving data to a microSD card, output it to a serial console andor send it wirelessly to your preferred Internet of Things (IoT) services - all at that same time!</p> <p>To configure the DataLogger, a menu system is accessed via a serial connection and provides access to all available settings for the system. Changes are automatically saved in persistant storage on the device, and are also settable/accessable as a <code>json</code> file if desired.  Details on setting up the system are outlined in the Settings section of this manual.</p>"},{"location":"single_page/#datalogger-devices","title":"DataLogger Devices","text":"<p>The following devices support the DataLogger IoT functionality discussed in this document.</p> <ul> <li>SparkFun DataLogger IoT     - the core DataLoggerIoT Device</li> <li>SparkFun DataLogger IoT - 9DoF     - A DataLoggerIoT with on-board 9DoF (Direction-of-Freedom) sensors.</li> </ul>"},{"location":"single_page/#quick-start","title":"Quick Start","text":"<p>Overall, the SparkFun DataLoggerIoT is ready for operation and requires no programming or software development. Just plug in a supported sensor and beging logging data to the serial console. With a little additiona setup, data is logged to a variety of common IoT data services as well as to an on-board SD card.</p>"},{"location":"single_page/#common-items-required-when-using-the-dataloggeriot","title":"Common items required when using the DataLoggerIoT","text":"<p>For general use and for following the documentation provided, the following items are used:</p> <ul> <li>A supported SparkFun DataLogger IoT board</li> <li>microSD card formatted with FAT32 [COM-15107]</li> <li>USB C Cable for communication and power</li> <li>A qwiic Cable</li> <li>At least one Qwiic enabled devices that is compatible</li> <li>For battery powered operation, a Lithium Ion Battery</li> </ul>"},{"location":"single_page/#basic-hardware-setup","title":"Basic Hardware Setup","text":"<p>The simple hardware setup is as follows:</p> <ul> <li>Connect a supported qwiic sensor to the datalogger.</li> <li>Connect the datalogger to a computer using a usb-c cable</li> <li>Connected to the datalogger via a Serial Terminal</li> </ul>"},{"location":"single_page/#basic-configuration-setup","title":"Basic Configuration Setup","text":"<p>Once connected to the DataLoggerIoT using a serial terminal, pressing any key on the keyboard will bring up the menuing system.</p> <p></p> <p>To navigate the menu, press the menu item number on your keyboard - this will select the desired menu. So if you want to assess the <code>Settings</code> menu item in the main menu, press the number <code>1</code> on your keyboard.</p> <p>To exit a menu perform on of the following:</p> <ul> <li>Press the <code>b</code> key (back) to return to the previous menu</li> <li>At the main menu, press <code>x</code> to exit (<code>b</code> works also). Any changes to settings are saved to on-board storage</li> <li>Press the <code>Escape</code> key (esc) to return to the previous menu item. If at the main menu, any changes are not save to on-board storage.</li> </ul> <p>Note</p> <p>If you don't exit a menu, after a timeout period (60 seconds default), the menu will exit as if the <code>escape</code> key was pressed.</p> <p>Warning</p> <p>If you make configuration changes, but don't exit the menu to save the changes, the changes will not be saved to on-device storage.</p> <p>Once menu navigation is understood, explore the options available and make changes to meet your needs. The configuration options are detailed in a majority of this on-line guide.</p>"},{"location":"single_page/#the-sensors","title":"The Sensors","text":"<p>Straight out of the box anti-static bag, the DataLogger IoT 9DoFis ready to log data from its built-in ISM330DHCX Inertial Measurement Unit (IMU) and MMC5983MA magnetometer. Only want to log magnetometer, accelerometer, gyro or temperature data? You\u2019re good to go! But the fun is only just beginning\u2026</p> <p>The DataLogger IoT is preprogrammed to automatically log data from all of the following sensors, so you may wish to add one or more of these to your shopping cart too. (More sensors are being added all the time and it is really easy to upgrade the DataLogger IoT to support them. But we'll get to that in a moment!). Currently, auto-detection is supported on the following Qwiic-enabled products (with the exception of the ISM330DHCX and MMC5983 which is built-in on the 9DoF variant):</p> <p>For a list of supported devices based on the firmware, you can check out the list of supported Qwiic Devices in the appendix</p>"},{"location":"single_page/#hardware-overview","title":"Hardware - Overview","text":"<p>In this section, we will highlight the hardware and pins that are broken out on the SparkFun DataLogger IoT. At the time of writing, we highlighted the SparkFun DataLogger IoT - 9DoF. However, this also applies for the SparkFun DataLogger IoT.</p> <p></p> <p>DataLogger IoT - 9DoF</p> <p>The SparkFun DataLogger is pretty much the same with the exception of the following features listed below. We'll include notes highlighting the differences in each section.</p> <ul> <li>No built - in 6DoF IMU - ISM330DHCX</li> <li>No built - in magnetometer - MMC5983</li> <li>The addressable RGB LED - WS2812 is replaced with the side emitting addressable RGB LED - B3DQ3BRG</li> <li>No IMU INT2 jumper</li> <li>No Mag INT jumper</li> <li>Included MEAS PTH Jumper</li> <li>The \"35 / A7\" PTH on the edge of the board is replace with a \"5\" PTH.</li> </ul> <p></p> <p>DataLogger IoT</p>"},{"location":"single_page/#esp32-wroom-module","title":"ESP32-WROOM Module","text":"<p>The DataLogger IoT is populated with Espressif's ESP32-WROOM-32E module. Espressif's ESP32 WROOM ubiquitous IoT microcontroller is a powerful WiFi, BT, and BLE MCU module that targets a wide variety of applications. For the DataLogger IoT, the firmware currently utilizes the WiFi feature.</p> <p></p> <p>ESP32 WROOM Module on the DataLogger</p>"},{"location":"single_page/#power","title":"Power","text":"<p>There are a variety of power and power-related nets broken out to connectors and through hole pads. Below list a few methods of powering the board up. There are protection diodes for the USB-C, 5V pin, and single cell LiPo battery. Power is regulated down to 3.3V for the system voltage.  Depending on the settings and what is connected to the DataLogger IoT, the board can pull a minimum of 200\u00b5A in low power mode by itself.</p> <ul> <li>USB-C</li> <li>5V Pin</li> <li>Single Cell LiPo Battery</li> <li>3V3 Pin</li> </ul>"},{"location":"single_page/#usb-c-and-5v","title":"USB-C and 5V","text":"<p>The DataLogger IoT comes equipped with a USB type C socket which you can use to connect it to your computer to view the output and configuration through the serial terminal, or plug in a USB-C power supply. The DataLogger IoT includes the configuration channel resistors needed to tell the power supply to deliver 5V. You can use your USB-C laptop charger as the power source should you need to, even though it normally delivers a much higher voltage.</p> <p>There is also a 5V power input pin. You can use this to feed in 5V power from an external source. The maximum voltage is 6.0V. The 5V pin is diode-protected and so is the USB-C power input, so it is OK to have both connected at the same time. This pin is ideal if you want to power your DataLogger from regulated solar power or a different type of power supply. You can not use the 5V pin as an output.</p> <p></p> <p>DataLogger IoT Power- USB-C and 5v</p> <p>Voltage from the USB is regulated down to the XC6222 3.3V/700mA voltage regulators for the system voltage and Qwiic-enabled devices. USB power is also connected to the MCP73831 to charge a single cell LiPo battery at a default rate of 500mA.</p> <p>For customers in North America, our NEMA Raspberry Pi Wall Adapter is a perfect choice. You can power the DataLogger IoT from our USB Battery Pack / Power Bank - TOL-15204 but you will need a USB-C cable too:</p> <ul> <li>Our USB 2.0 A to C Cable - CAB-15092 will do nicely</li> <li>Our USB 3.1 A to C Cable - CAB-14743 is a good choice too</li> </ul>"},{"location":"single_page/#lipo-battery-input-charger-and-fuel-gauge","title":"LiPo Battery Input, Charger, and Fuel Gauge","text":"<p>But of course you\u2019re going to want to use the DataLogger IoT to log sensor data while on the move too. You can connect one of our standard single cell LiPo batteries to the DataLogger IoT and power it for hours, days or weeks depending on what sensors you have attached and how often you log data.</p> <p>The DataLogger IoT uses the built-in MCP73831 charger too which will charge your battery at 500mA when USB-C is connected. Please make sure your battery capacity is at least 500mAh (0.5Ah).</p> <p>The board also includes the MAX17048 LiPo Fuel Gauge which allows you to determine how much power your LiPo battery has available.</p> <p>The 2-pin JST connector pins are broken out to PTHs on the edge of the board if you decide to solder a single cell LiPo battery directly to the board or power another device.</p> <p>Battery Polarity</p> <p>Make sure that you use one of our recommended Lithium Ion batteries. Some batteries use the same JST connector as ours but have theopposite polarity. Connecting one of these to your DataLogger IoT will destroy it. If you are going to use your own battery, it is up to you to ensure it has the correct polarity.</p> <p></p> <p>LiPo Charger, Fuel Guage and Battery Connections</p>"},{"location":"single_page/#3v3-pins","title":"3V3 Pins","text":"<p>For those going the old school route, you can also bypass the voltage regulators by soldering directly to the 3V3 and GND pin to provide power if your application has a regulated 3.3V. Note that this is only connected to the system voltage. You will also need to provide power to the 3V3 SWCH or Qwiic-enabled devices should you decide to bypass the voltage regulator.</p> <p></p> <p>3.3V Voltage Regulators, PTHs, and Qwiic Connectors</p>"},{"location":"single_page/#ch340-usb-to-serial-converter","title":"CH340 USB-to-Serial Converter","text":"<p>The top side of the board includes a CH340 USB-to-Serial Converter. The chip can be used to send serial data between the device and computer. You can view the output or configure the device through a serial terminal.</p> <p></p> <p>CH340 USB-to-Serial Converter IC</p> <p>The driver should automatically install on most operating systems. However, there is a wide range of operating systems out there. You may need to install drivers the first time you connect the chip to your computer's USB port or when there are operating system updates. For more information, check out our How to Install CH340 Drivers Tutorial.</p>"},{"location":"single_page/#uart","title":"UART","text":"<p>The hardware serial UART pins are broken out on the edge of the board. For more information about Serial UART, check out the tutorial about Serial Communication for more information.</p> <ul> <li>TXD: UART transmit pin. This is connected to pin <code>16</code>.</li> <li>RXD: UART receive pin. This is connected to pin <code>17</code>.</li> </ul> <p></p> <p>UART Pins Highlighted On The DataLogger IoT</p>"},{"location":"single_page/#qwiic","title":"Qwiic","text":"<p>SparkFun's Qwiic Connect System uses 4-pin JST style connectors to quickly interface development boards with I<sup>2</sup>C sensors and more. No soldering required and there's no need to worry about accidentally swapping the SDA and SCL wires. The Qwiic connector is polarized so you know you\u2019ll have it wired correctly every time, right from the start. Qwiic boards are daisy chain-able too so you can connect multiple sensors to the DataLogger IoT and log readings from all of them.</p> <p>Vertical qwiic Connector</p> <p>You may notice a thin film over the vertial Qwiic connector. This is used by a pick-and-place machine when populating the component on the board before it goes through the reflow oven. Remove this film before using the vertical qwiic connector</p> <p>The board is populated with vertical and horizontal Qwiic connectors. These are also broken out to PTHs on the edge of the board.</p> <p></p> <p>Qwiic Connector And I2C PTH Highlighted</p> Pin Description SCL I<sup>2</sup>C clock pin. This is connected to pin <code>22</code> and a 2.2k\u03a9 pull-up resistor. SDA I<sup>2</sup>C data pin. This is connected to pin <code>21</code> and a 2.2k\u03a9 pull-up resistor. 3V3 SW The 3.3v pin is connected to the XC6222 voltage regulator's output to power the Qwiic devices. GND Common, ground voltage (0V reference) for the system <p>Connected to the line I<sup>2</sup>C line is the MAX17048 LiPo fuel gauge (7-bit unshifted address = 0x36).</p> <p>Sometimes you might want to connect more than one of the same type of sensor to the DataLogger IoT. On the I<sup>2</sup>C bus, each device needs to have a unique address. On many of our boards, there are jumpers links which you can use to change the address and some have addresses that can be configured in software. But there are some where you cannot change the address. Typically, one would use a multiplexor. However, we currently do not have the DataLogger IoT configured to work with any multiplexors (i.e. Qwiic Mux Breakout).</p> <p>The DataLogger IoT includes a dedicated 3.3V regulator for the Qwiic connector. This has several advantages including:</p> <ul> <li>The DataLogger IoT can completely power-down the I<sup>2</sup>C sensors during sleep to prolong your battery life</li> <li>There\u2019s no risk of the Qwiic bus gulping too much current and causing problems for the ESP32</li> </ul>"},{"location":"single_page/#spi","title":"SPI","text":"<p>The SPI pins are broken out on the edge of the board. For those that are unfamiliar to PICO and POCI, check out the SPI tutorial for more information.</p> Pin Description SCK SPI clock pin. This is connect to pin <code>18</code>. PICO SPI Peripheral In Controller Out. This is connected to pin <code>23</code>. POCI SPI Peripheral Out Controller In. This is connected to pin <code>19</code>. <p></p> <p>SPI Pins Highlighted</p> <p>Not shown in the image are the chip select (CS) pins. The 6DoF IMU's CS pin is connected to pin <code>5</code>. The magnetometer's CS pin is connected to pin <code>27</code> which is not broken out.</p> <p>On the DataLogger IoT, the IMU and magnetometer are not connected to the SPI port since they are not included on the board. Instead of pin \"35 / A7\" being broken out, pin \"5\" is broken out on the edge of the board.</p> <p></p> <p>Pin 5 Highlighted on the DataLogger IoT</p>"},{"location":"single_page/#microsd-card-socket","title":"MicroSD Card Socket","text":"<p>The DataLogger IoT supports full 4-bit SDIO for fast logging and uses common microSD cards to record clear text, comma separated files. Flip over the DataLogger IoT and you'll see the latching microSD card socket. You probably already have a microSD card laying around. However, if you need any additional units, we have plenty in the SparkFun catalog. The DataLogger can use any size microSD card and supports FAT32 cards in addition to FAT16. Please ensure that your SD card is formatted correctly; we recommend the Raspberry Pi Imager Tool.</p> <p></p> <p>MicroSD Card</p> <p>Slide in your formatted SD card and it will click neatly into place. The edge of the SD card will stick out on the edge of the circuit board when it is inserted correctly.</p> <p>You should only insert or remove the SD card while the power is turned off or disconnected. Removing the card while the DataLogger IoT is logging will almost certainly corrupt your data.</p>"},{"location":"single_page/#datalogger-iot-9dof-9-degrees-of-freedom","title":"DataLogger IoT - 9DoF (9 Degrees of Freedom)","text":"<p>As stated earlier, included on every DataLogger IoT - 9DoF is a 6DoF Inertial Measurement Unit (IMU) for built-in logging of triple-axis accelerometer and gyro. There is also a built-in triple-axis magnetometer for a complete 9 degrees of freedom. Beside each IC is a silkcreen showing the reference axis. Both are connected to the ESP32 via the SPI port. Combined, you have 9 degrees of inertial measurement! Whereas the original 9DOF Razor used the old MPU-9250, this uses the ISM330DHCX and MMC5983MA. Oh, and if that wasn\u2019t enough, it comes with a built-in temperature sensor on each IC too. So if you want to use the DataLogger IoT as a transportation logger, it will do that straight out of the anti-static bag!  </p> <p></p> <p>DataLogger IoT - 9DOF - Accelerometer, Gyro, and Magnetometer</p>"},{"location":"single_page/#analog-pins","title":"Analog Pins","text":"<p>There are three 12-bit analog pins available and broken out on edge of the board.</p> Pin Description 36 / A0 Analog A0. This is connected to pin <code>36</code>. 39 / A3 Analog A3. This is connected to pin <code>39</code>. 35 / A7 Analog A7. This is connected to pin <code>35</code>. <p></p> <p>Analog Pins Highlighted</p>"},{"location":"single_page/#reset-and-boot-buttons","title":"Reset and Boot Buttons","text":"<p>There are two buttons available on the board for reset and boot. These are also broken out on the edge of the board as PTHs. If you have your DataLogger IoT mounted in an enclosure, you can also attach an external boot or reset switch too. Any Single Pole Normally-Open Push-To-Close momentary switch will do. Solder pin headers or wires to the RST and GND breakout pins and connect your external switch to those.</p> Button Description RESET Pressing this button will pull the pin LOW and reset the program running on the ESP32 without unplugging the board. BOOT The boot button usually allows users to force the ESP32 into bootloader mode to manually flash new firmware to the ESP32. The ESP32 will remain in this mode until there is a power cycle or the reset button is pressed. As of firmware v01.00.02, this button has an extra function: pressing down on the user button for 20 seconds will erase on-board preference storage and restart the board. This is connected to pin <code>0</code> on the ESP32. <p></p> <p>Reset and Boot Buttons (and Associated PTHs) Highlighted</p> <p>Note</p> <p>You may notice a thin film over buttons. This is used by a pick-and-place machine when populating the component on the board before it goes through the reflow oven. This can be removed.</p> <p>Like other ESP32 development boards, these buttons are populated so that users can place the ESP32 module in bootloader mode. For users that need to place the board in bootloader mode when powered, you will need to:</p> <p>1) Press the BOOT button. 1) While holding on the BOOT button, press the RESET button momentarily. 1) Finally, release the BOOT button.</p> <p>Most of the time, users will simply have the board executing the firmware that is loaded on the ESP32 module and updating through the configuration menu either through the microSD card or OTA.</p>"},{"location":"single_page/#overwriting-the-build-in-firmware","title":"Overwriting the Build-In Firmware","text":"<p>Please think very carefully before uploading any Arduino sketches to your DataLogger IoT.</p> <p>Uploading Arduino Sketches</p> <p>You will overwrite the DataLogger IoT firmware, leaving it unable to update or restore itself.</p> <p>The DataLogger IoT comes pre-programmed with amazing firmware which can do so much. It is designed to be able to update itself and restore itself if necessary. But it can not do that if you overwrite the firmware with any Arduino sketch. It is just like erasing the restore partition on your computer hard drive. Do not do it - unless you really know what you are doing.</p>"},{"location":"single_page/#leds","title":"LEDs","text":"<p>There are three LEDs populated on the board. These can be disabled with their respective jumpers on the back of the board.</p> LED Description STAT The status LED is connected to pin <code>25</code>. RGB The WS2812-2020 RGB addressable LED is connected to pin <code>26</code>. In addition to being disabled through the jumper on the back, you can also disable the LED through software. CHG The on-board yellow CHG LED can be used to get an indication of the charge status of your battery. Below is a table of other status indicators depending on the state of the charge IC."},{"location":"single_page/#rgb-led-color-values","title":"RGB LED Color Values","text":"<p>The following colors represent different states that the board is in.</p> Color Description White A solid white LED indicates that the board is currently being configured through the configuration menu. Green A solid green LED indicates that the board is initializing. As of firmware v01.00.02, the LED blinks green when on battery power indicating that the battery level is VBATT &gt; 50%. Blue A blinking blue LED indicates that the board is reading sensor data and logging the values. Yellow A solid yellow LED indicates that a firmware update is in progress. As of firmware v01.00.02, the LED blinks yellow when on battery power indicating that the battery level is between 50% &gt; VBATT &gt; 10%. Red As of firmware v01.00.02, the LED blinks red when on battery power indicating that the battery level is VBATT &lt; 10%."},{"location":"single_page/#charge-led-values","title":"Charge LED Values","text":"State LED Status No Battery Off Shutdown Off - may flicker Charging On Charge Complete Off <p>LEDs and PTHs Connected to LEDs</p>"},{"location":"single_page/#jumpers","title":"Jumpers","text":"<p>There are seven jumpers on the back of the DataLogger IoT - 9DoF. For more information, check out our tutorial on working with jumper pads and PCB traces should you decide to cut the traces with a hobby knife.</p> Jumper Description SHLD This jumper connects the USB Type C connector's shield pin to GND. Cut this to isolate the USB Type C connector's shield pin. I<sup>2</sup>C This three way jumper labeled as I<sup>2</sup>C are closed by default. By cutting the jumpers, it will disconnect the 2.2k\u03a9 pull-up resistors for the I<sup>2</sup>C STAT This jumper connects the status LED to pin <code>25</code> and it is closed by default. Open the jumper to disable the LED. RGB This jumper connects the WS2812-2020 RGB addressable LED to pin <code>26</code> and it is closed by default. Open the jumper to disable the LED. CHG* This jumper connects the charge LED on the MCP73831 charge IC and it is closed by default. Open the jumper to disable the LED. IMU INT2 This jumper connects the ISM330DHCX IMU's interrupt pin to pin <code>35</code> and it is open by default. Add a solder jumper to connect. MAG INT This jumper connects the MMC5983MA  magnetometer's interrupt pin to pin <code>35</code> and it is open by default. Add a solder jumper to connect. <p></p> <p>Jumper Locations</p> <p>On the DataLogger IoT, the IMU INT2 or MAG INT jumpers are not included since it does not have the built in 6DoF IMU or magnetometer. With the extra real estate on the board, we were able to include a MEAS PTH and jumper on the board. By default, the jumper is closed. You can cut this jumper on the bottom side of the board to measure the DataLogger IoT\u2019s current draw from external power.</p> <p></p> <p>Measurment Jumpers</p>"},{"location":"single_page/#board-dimensions","title":"Board Dimensions","text":"<p>The overall length and width with the antenna connector is about 1.66\" x 2.00\". There are four mounting holes in the center of the board. Due to the size of the board and the ESP32 module, the mounting holes are positioned in a way for users to add two Qwiic enabled boards with a width of 1.0\" instead of one Qwiic board.</p> <p></p> <p>DataLogger IoT Board Dimensions</p>"},{"location":"single_page/#hardware-hookup","title":"Hardware - Hookup","text":"<p>In this section, we will go over how to connect to the SparkFun DataLogger IoT. At the time of writing, we used the DataLogger IoT - 9DoF. This hardware hookup explained in this section also applies for the DataLogger IoT.</p>"},{"location":"single_page/#soldering-to-the-pths","title":"Soldering to the PTHs","text":"<p>For users that are interested in soldering to the edge of the board, we recommend soldering headers to the PTHs on the breakout for a permanent connection and using jumper wires. Of course, you could also solder wires to the breakout board as well. For a temporary connection during prototyping, you can use IC hooks like these.</p>"},{"location":"single_page/#microsd-card","title":"MicroSD Card","text":"<p>If all you want to do is display your sensor readings in a serial terminal or monitor (connected via USB-C) then, strictly, you don\u2019t need to add a microSD card. But of course the whole point of the DataLogger IoT is that it can log readings from whatever sensors you have attached to microSD card. The data is logged in easy-to-read Comma Separated Value (CSV) text format by default. You can also set the format as JSON.</p> <p>You probably already have a microSD card laying around but if you need any additional units, we have plenty in the store. The DataLogger IoT can use any size microSD card as long as it is formatted correctly. Please ensure your SD card is formatted correctly. There are different software tools available. Some are built into your operating system. We recommend using the Raspberry Pi Imager Tool to easily format the memory card as FAT32 using the GUI. Flip over the DataLogger IoT and you\u2019ll see the latching microSD card socket. Slide in your formatted SD card and it will click neatly into place. Part of the edge of the SD card will stick out when fully inserted in the microSD card socket.</p> <p>SD Card Insertion and Removal</p> <p>Only insert or remove the SD card while the power is turned off or disconnected. Removal while in use could result in data corruption. Insertion is not detected when the DataLogger is powered on and running.</p> <p>After you\u2019ve logged some data, you will find a new file on your SD card. There may also be additional files if you manually saved the firmware or preferences to the memory card.</p> <ul> <li>sfe0001.txt: This is the file that contains the CSV or JSON sensor data. The format will depend on how you configured the DataLogger's output. We use .TXT as the file type so that your computer can open it in a simple text editor. The contents are all human-readable. But, if you want to, you can rename it as .CSV or .JSON instead. The file number is incremented for the next logging session.</li> <li>datalogger.json: This file only appears when you save the settings as your fallback storage. The file will include all preferences saved for any connected device, WiFi credentials, certificates, and keys.</li> <li>SparkFun_DataLoggerIoT*.bin: This file only appears when you save the firmware to the microSD card. Note that the asterisk (*) is the firmware version number (i.e. SparkFunDataLoggerIoT_01.00.01.bin).</li> </ul> <p>To remove the microSD card, make sure power is disconnected from the DataLogger IoT. Then press the microSD card into the microSD socket. The memory card will be ejected and you will hear a click again. Once the card is ejected, you can insert it into a microSD card adapter or USB reader to be read on a computer.</p>"},{"location":"single_page/#qwiic-sensors","title":"Qwiic Sensors","text":"<p>If you are going to attach extra sensors or any Qwiic-enabled device to the DataLogger IoT, then those need to be connected first before attaching a USB cable. It is a good idea to only attach or disconnect Qwiic sensors when the power is turned off or disconnected. The Qwiic bus is pretty tolerant to \u201chot swapping\u201d, but: disconnecting a sensor while it is in use will confuse the DataLogger IoT software (most likely each value associated with the device will remain constant); and a new sensor won\u2019t be detected until the firmware restarts.</p> <p>Plug one end of your Qwiic cable into the DataLogger IoT and plug the other end into your sensor. If you want to add extra sensors, you can simply connect them to each other in a daisy chain. You will need a Qwiic cable for each sensor. Our Qwiic Cable Kit covers all the options.</p> <p>DataLogger IoT and a Qwiic-Enabled Device</p> <p></p> <p>DataLogger IoT and several Qwiic-Enabled Devices Daisy Chained</p> <p></p> <p>Our Qwiic sensors usually all have power indicator LEDs and I<sup>2</sup>C pull-up resistors. Depending on your application, you may want or need to disable these by cutting the jumper links on the sensor circuit boards. We have a tutorial that will show you how to do that safely.</p> <p>Sometimes you might want to connect more than one of the same type of sensor to the DataLogger IoT. On the I<sup>2</sup>C bus, each device needs to have a unique address. On many of our boards, there are jumpers links which you can use to change the address and some have addresses that can be configured in software. But there are some where you cannot change the address - the NAU7802 Qwiic Scale being one example.</p> <p>Typically one would use a multiplexor. However, we currently do not have the DataLogger IoT configured to work with any multiplexors (i.e. Qwiic Mux Breakout).</p>"},{"location":"single_page/#lipo-battery","title":"LiPo Battery","text":"<p>Now is a good time to attach a LiPo battery, if you want the DataLogger IoT to keep logging when you disconnect USB-C.</p> <p></p> <p>You can connect one of our standard single cell LiPo batteries to the DataLogger IoT and power it for hours, days or weeks depending on what sensors you have attached and how often you log data. The DataLogger IoT has a built-in charger too which will charge your battery at 500mA when USB-C is connected. Please make sure your battery capacity is at least 500mAh (0.5Ah); bad things will happen if you try to charge our smallest batteries at 500mA. The yellow CHG charging LED will light up while the battery is charging and will go out once charging is complete.</p> <p>Warning</p> <p>Ensure that you use one of SparkFun's recommended Lithium Ion batteries. Some batteries use the same JST connector as SparkFun, but have the opposite polarity. Connecting one of these to your DataLogger IoT will destroy it. If using a non-SparkFun battery,  ensure it has the correct polarity.</p> <p>The MCP73831 charge IC on the board is used on a few SparkFun products. For more information about the CHG status LED, we recommend taking look at the Hardware Overview. We also recommend taking a look at this tutorial for Single Cell LiPo Battery Care.</p>"},{"location":"single_page/#usb-cable","title":"USB Cable","text":"<p>The USB-C connector provides power to the DataLogger IoT and acts as a serial interface for configuration and data display.</p> <p></p> <p>If you are going to use a microSD card to store your data, and why wouldn\u2019t you, then insert that first before attaching your USB cable. You should only insert or remove the SD card while the power is turned off or disconnected. Removing the card while the DataLogger IoT is logging will almost certainly corrupt your data.</p> <p>Likewise, it is a good idea to only attach or disconnect Qwiic sensors when the power is turned off or disconnected. The Qwiic bus is pretty tolerant to \u201chot swapping\u201d, but: disconnecting a sensor while it is in use will confuse the DataLogger IoT software; and a new sensor won\u2019t be detected until the firmware restarts.</p> <p>Depending on what ports your computer has available, you will need one of the following cables:</p> <ul> <li>USB 2.0 A to C Cable</li> <li>USB 3.1 A to C Cable</li> <li>USB 2.0 C to C Cable</li> </ul> <p>Use the cable to connect your DataLogger IoT to your computer and you will see the LEDs light as the DataLogger IoT starts up. The addressable RGB RGB LED will light up green for a second or two while the DataLogger IoT configures itself. It will flash blue while data is being logged to the microSD card. If you have jumped the gun and have a LiPo battery already connected, the yellow CHG charging LED may light up too.</p> <p>If the addressable RGB LED does not light up, your DataLogger IoT is probably in deep sleep following a previous logging session. Pressing the RST reset button will wake it.</p> <p>You\u2019ll find full instructions on how to configure the DataLogger IoT later in this tutorial.</p>"},{"location":"single_page/#standoffs","title":"Standoffs","text":"<p>For users interested in stacking the Qwiic-enabled device on the DataLogger IoT or mounting in an enclosure, you will need some standoffs to mount the boards. When mounting, note that all four mounting holes are not positioned exactly for a 1.0\"x1.0\" sized Qwiic board. Only two of the four mounting holes are compatible for a 1.0\"x1.0\" sized Qwiic board. For example the image below shows the boards stacked on each side of the DataLogger IoT. On top, the Qwiic GPS (SAM-M10Q) breakout was also able to stack by rotating the board slightly and aligning the mounting holes on the 1.6\"x1.6\" sized board to the other mounting holes</p> <p></p>"},{"location":"single_page/#operation-overview","title":"Operation Overview","text":"<p>The main interface for the DataLogger IoT is a menuing system accessed via a serial terminal. You can use any interactive serial terminal emulator to quickly and easily change and store the DataLoggerIoT settings via its USB-C interface.</p> <p>Before proceeding - ensure you are using an appropriate Serial Terminal application to communicate with the DataLoggerIoT.</p>"},{"location":"single_page/#general-operation","title":"General Operation","text":"<p>When connected to a Serial Terminal, the displayed output has the following sequence of events when the DataLoggerIoT is stared:</p> <p>1) Startup Menu - A startup menu is displayed to change operation of the datalogger. 2) System Startup - messages are output as the system initialized and begings operation 3) Logging Output - sent to the Serial Monitor 4) Settings Menu - displayed with the touch of any key 5) Quick Commands - simple commands entered at the console - they start with a <code>!</code></p>"},{"location":"single_page/#startup-menu","title":"Startup Menu","text":"<p>Connect the DataLogger IoT to a USB cable and connect to your computer. The addressable RGB LED will light up green as it initializes. In the Serial Terminal,  a Startup Menu is presented, which allows you to change the behavior of the DataLogger at start-up. This change only affects the current system session.</p> <p></p> <p>Startup Menu Options</p> <ul> <li>'n' - Normal startup</li> <li>'a' - Disable I2C device auto load on startup</li> <li>'l' - List the I2C devices supported. This device table is discarded after auto-load</li> <li>'w' - Disable WiFi</li> <li>'s' - Disable preference restore during startup</li> </ul> <p>The amount of time the start-up menu is displayed is adjustable. This settings can be configured in the Settings/Application Settings page, under the Advanced section.</p>"},{"location":"single_page/#system-startup","title":"System Startup","text":"<p>As the system starts up you will see the following output when the board initializes:</p> <p></p> <p>Startup Output Information</p> <p>The messages in the serial terminal provide us with the DataLogger's configuration and will vary depending on the firmware version that is loaded on the board and the boards configuration settings.</p> <p>In general, the output will include the following:</p> <ul> <li>The DataLogger IoT software version</li> <li>As the DataLogger IoT is initializing, the system settings are being restored from the last saved preference.</li> <li>There no WiFi credentials and the board has failed to connect. This output will change once you provide the WiFi credentials and are able to connect to the network.</li> <li>There are 3x devices currently detected and they are connected through I<sup>2</sup>C through the Qwiic port and SPI. These are the on-board sensors for the DataLogger IoT. There may be more devices that are detected depending on the firmware and what is connected to the ports. Since these were recognized, they were loaded onto the DataLogger IoT.</li> <li>The current date and time is shown (by default), the date and time is set to 1-1-1970 and 00:00:00). This value will change depending on the clock source through NTP, RTC, or a u-blox GNSS module.</li> <li>The time the board has been running will be shown in the uptime.</li> <li>The primary external time source that the board syncs is currently through the NTP client. This can be configured depending on your clock source.</li> <li>The board name</li> <li>The board ID</li> <li>The microSD card has been found, the type of memory card it is, the size of the memory card, how much memory is used, and how much is available.</li> <li>If there is a WiFi network name saved, the SSID will be shown along with information indicating whether the board was able to connect to the WiFi network. By default there is no SSID saved in memory.</li> <li>If there is a battery connected, the LiPo Battery Fuel Guage will indicate if there is one attached to the board.</li> <li>Parameters for low power mode will be provided indicating if deep sleep is enabled, sleep interval, and wake interval.</li> <li>Parameters for logging are also provided for the logging interval, the format for the serial output, format for the microSD card, current saved filename, and file rotation period.</li> <li>The board will also show the available IoT services that are enabled for the DataLogger IoT.</li> <li>Current settings to download log files via a web interface (included in firmware v01.02.00)</li> <li>Supported devices through Qwiic or SPI will be listed if they are connected.</li> <li>The output will finish by telling you what devices are connected to the DataLogger IoT again.</li> </ul> <p>As of firmware v01.02.00, there is also a compact mode! By adjusting the setting, the datalogger will output less at startup. This settings can be configured in the Settings/Application Settings page, under the Advanced section.</p> <p></p> <p>Compact Startup Mode Output</p>"},{"location":"single_page/#logging-output","title":"Logging Output","text":"<p>Once the DataLogger IoT has initialized, the DataLogger IoT will begin outputting comma separated values (CSV). This is the default output that is set for the DataLogger IoT - 9DoF. Of course, you will not have as many readings on the DataLogger IoT since the 6DoF IMU and magnetometer are not populated on that version of the board.</p> <p></p> <p>CSV Output to the Serial Console</p> <p>Depending on your DataLogger IoT preferences, your device may output as a JSON format like the image shown below.</p> <p></p> <p>JSON Output to the Serial Console</p> <p>The data scrolling up the screen show what each device's output is along with their associated unit if it is available. Your mileage will vary depending on the board version that you have and what device is connected:</p> <ul> <li><code>MAX17048.Voltage (V)</code></li> <li><code>MAX17048.State of Charge (%)</code></li> <li><code>MAX17048.Charge Rate (%/hr)</code></li> <li><code>ISM330.Accel X (milli-g)</code></li> <li><code>ISM330.Accel Y (milli-g)</code></li> <li><code>ISM330.Accel Z (milli-g)</code></li> <li><code>ISM330.Gyro X (milli-dps)</code></li> <li><code>ISM330.Gyro Y (milli-dps)</code></li> <li><code>ISM330.Gyro Z (milli-dps)</code></li> <li><code>ISM330.Temperature (C)</code></li> <li><code>MMC5983.X Field (Gauss)</code></li> <li><code>MMC5983.Y Field (Gauss)</code></li> <li><code>MMC5983.Z Field (Gauss)</code></li> <li><code>MMC5983.Temperature (C)</code></li> </ul> <p>The output will vary depending on what is connected so you may get additional readings in the output and it may not be in the following order listed above. The logging rate defaults to about 0.067Hz (or 15000ms), so as the data scrolls past, you will see the last value settle at about 0.067Hz.</p>"},{"location":"single_page/#settings-menu","title":"Settings Menu","text":"<p>Right! Let's open the main menu by pressing on any key in the serial terminal program.</p> <p> /// Main Menu ///</p> <p>You will be prompted with a few options. Once in the configuration menu, all three colors of the addressable RGB LED will turn on to produce the color white indicating that you are navigating through the menu.</p>"},{"location":"single_page/#selecting-a-menu-item","title":"Selecting a Menu Item","text":"<p>Menus items are entered by pressing the number next to the menu item desired. For example, at the main menu, pressing <code>1</code> will bring up the overall Settings Menu. You will have the option to adjust various settings ranging from the your preferences, time source to synchronize the date and time, WiFi network, how the device logs data, which IoT service to use, and firmware updates.</p> <p></p> <p>The Settings Menu</p> <p>Note</p> <p>You may notice after entering a <code>1</code> with long menus there is a slight delay before the system responds. The delay was added to allow some time for an additional digit for any option greater than 9. If you want to head to option 1 immediately without the slight delay, you can hit the <code>Enter</code> key.</p> <p>Hitting the <code>ESC</code> returns to the previous menu. From here you can enter a <code>2</code> which brings up the Device menu - which lists all devices currently connected to the datalogger</p>"},{"location":"single_page/#exiting-and-saving","title":"Exiting and Saving","text":"<p>When exiting the menus, you will be prompted with either an <code>x</code> or <code>b</code>. You can use either character when exiting the menus as well as <code>X</code> or <code>B</code>. Note that you will need to use either of these keys when making a change in order for the DataLogger IoT to save any changes in memory. Make sure that you receive the following message indicating that the settings were saved: <code>[I] Saving System Settings</code>. The DataLogger IoT will the continue reading the devices and outputting the readings through the serial terminal.</p> <p></p> <p>Save Settings When Exiting the Menu</p>"},{"location":"single_page/#cancelling-changes","title":"Cancelling Changes","text":"<p>You can also use any of your <code>Esc</code> to exit. However, using the escape will not save any changes in memory once the reset button is hit or whenever power is cycled.</p> <p></p> <p>Escape to Exit a Menu</p>"},{"location":"single_page/#timeout-from-inactivity","title":"Timeout from Inactivity","text":"<p>The menus will slowly exit out after 2 minutes of inactivity, so if you do not press a key the DataLogger IoT will return to its previous menu. It will continue to move back until it reaches the main menu. After another additional 2 minutes of inactivity, the board will exit begin logging data again. When the menu exits from inactivity, any changes will not be saved in memory as well.</p> <p></p> <p>Timeout in the Menu</p>"},{"location":"single_page/#quick-commands","title":"Quick Commands","text":"<p>As of firmware v01.02.00, when not in the menu system, commands can be executed directly from the serial console - these are called quick commands. When you enter a <code>!</code>, you will see a prompt appear for quick command entry.</p> <p>The following commands are available:</p> Command Description !about Display the system about page !clear-settings Clear the on board system preferences with a yes/no prompt !clear-settings-forced Clear the on board system preferences with no prompt !devices List the currently connected devices !factory-reset Perform a factory reset - presents a Y/N prompt !heap Display the current system heap memory usage !json-settings For setting the device settings via a serial connection. When this command is sent, the system expects to receive a JSON settings file !log-now Perform a log observation event !log-rate If log rate measurement is enabled, the current log rate is printed !reset-device Reset the device - erasing any saved settings and restarting the device !reset-device-forced Reset the device, but without a Y/N prompt !restart Restart the device !restart-forced Restart the device without a Y/N prompt !save-settings Save the current settings to on-board flash !sdcard Output the current SD card usage statistics !systime Output current system time !uptime The uptime of the device !device-id The ID for the device !version The version of the firmware !wifi Output current system WiFi state <p>Typing a quick command and hitting the <code>Enter</code> button will result in the DataLogger IoT executing the command without the need to go through the menu system. Below is an example showing the <code>!about</code> quick command being sent and then executing the command as the DataLogger IoT is outputting CSV values to the serial terminal.</p> <p></p> <p>Enter a quick command</p>"},{"location":"single_page/#application-settings","title":"Application Settings","text":"<p>The following settings are presetented in the General &gt; Application Setting menu of the settings.</p> <p>When the selected, the following menu is presented:</p> <p></p> <p>The following provides an overview of each setting in this menu.</p>"},{"location":"single_page/#settings","title":"Settings","text":""},{"location":"single_page/#led-enabled","title":"LED Enabled","text":"<p>Used to control if the on-board RGB LED is enabled or disabled.</p>"},{"location":"single_page/#menu-timeout","title":"Menu Timeout","text":"<p>The settings menu will timeout - exit to the previous level - if no input is provided within the specified timeout period. The default value is 60 seconds.</p>"},{"location":"single_page/#color-output","title":"Color Output","text":"<p>The menu system of the DataLoggerIoT can user color to highlight specific elements of the menu textual output. This option controls if color is enabled or not. This value is enabled by default</p>"},{"location":"single_page/#board-name","title":"Board Name","text":"<p>Set this value to the name of the specific board.</p>"},{"location":"single_page/#output","title":"Output","text":""},{"location":"single_page/#sd-card-format","title":"SD Card Format","text":"<p>Set the format to use when writing data to the SD Card - <code>CSV Format</code> and <code>JSON Format</code> are supported.</p>"},{"location":"single_page/#serial-console-format","title":"Serial Console Format","text":"<p>Set the format to use when writing data to the Serial Console - <code>CSV Format</code> and <code>JSON Format</code> are supported.</p>"},{"location":"single_page/#json-buffer-size","title":"JSON Buffer Size","text":"<p>When building JSON output, a string buffer is allocated and used. This setting is used to adjust the size of this buffer.</p> <p>If the buffer size is exceeded, a non-valid JSON value is output by the system.</p> <p>Note</p> <p>The runtime maximum use size of the buffer is output in the <code>about</code> screen of the DataLoggerIoT. This is helpful in adjusting the size of the buffer.</p>"},{"location":"single_page/#terminal-baud-rate","title":"Terminal Baud Rate","text":"<p>The baud rate used when connected to a Serial Terminal application.</p> <p>When changed, the DataLoggerIoT must restart of the setting to take effect.</p> <p>Note</p> <p>Once the baud rate is change, the baudrate on the serial termainal application will also require updating</p>"},{"location":"single_page/#sleep","title":"Sleep","text":""},{"location":"single_page/#enable-system-sleep","title":"Enable System Sleep","text":"<p>If enabled, the DataLogger IoT will enter a sleep mode for a set number seconds between data recording. This setting can be used to reduce the overall power consumption of the DataLoggerIoT device when powered by a battery.</p> <p>When this feature is enabled, the DataLoggerIoT will <code>sleep</code> for <code>Sleep Interval</code> seconds, then <code>wake</code> to sample data for <code>Wake Interval</code> seconds. This cycle continues until the setting is changed.</p>"},{"location":"single_page/#sleep-interval-sec","title":"Sleep Interval (sec)","text":"<p>The number of seconds the DataLoggerIoT sleeps</p>"},{"location":"single_page/#wake-interval","title":"Wake Interval","text":"<p>The number of seconds the DataLoggerIoT samples data. Once this period ends, the system enters sleep mode</p>"},{"location":"single_page/#advanced","title":"Advanced","text":""},{"location":"single_page/#start-messages","title":"Start Messages","text":"<p>This setting allows adjustment of the amount of messages output during startup.</p> <p>The messages levels are:</p> <ul> <li>Normal - all messages are shown.</li> <li>Compact - a minimal set of messages are output.</li> <li>Disabled - no startup messages are output.</li> </ul>"},{"location":"single_page/#startup-delay","title":"Startup Delay","text":"<p>When the DataLogger IoT starts, a <code>startup menu</code> is shown for a specific amount of time. This setting is used to set the time period the menu is dispalyed.</p> <p>If set to <code>0</code>, the menu is not shown.</p>"},{"location":"single_page/#device-names","title":"Device Names","text":"<p>If enabled, Device Names will also include the device address. This is helpful if two devices of the same type are connected to the DataLoggerIoT.</p>"},{"location":"single_page/#verbose-messages","title":"Verbose Messages","text":"<p>If enabled, additional informational and debug messages are output to the console during DataLoggerIoT operation</p>"},{"location":"single_page/#functions","title":"Functions","text":""},{"location":"single_page/#about","title":"About...","text":"<p>When selected, the about page is displayed for the DataLoggerIoT.</p>"},{"location":"single_page/#time-setup","title":"Time Setup","text":"<p>In the Settings Menu, select the time reference sources. As of firmware v01.01.01, time zone support is at the clock level, not tied to NTP. The option to adjust the Time Zone is moved to the Time Sources menu.</p> <p></p> <p>Time Source Menu</p> <p>In this menu, you will have options to update the primary reference clock, update interval, add a secondary reference clock, and update it's interval.</p> <p>By default, the primary reference clock is set to use the Network Time Protocol (NTP). To synchronization the time, you will need to connect to a 2.4GHz WiFi network in order to update the time.</p> <p>To add a secondary clock, make sure to connect a compatible Qwiic-enabled devices that can keep track of time (i.e. Qwiic Real Time Clock Module - RV-8803 or a Qwiic-enabled u-blox GNSS module).</p>"},{"location":"single_page/#time-configuration","title":"Time Configuration","text":"<p>The following settings are available:</p>"},{"location":"single_page/#the-time-zone","title":"The Time Zone","text":"<p>The timezone to use for <code>local time</code> for the DataLoggerIoT.</p> <p>To adjust the time zone, you will need to enter a POSIX timezone string variable. Try checking out this CSV in this GitHub repo and searching for the timezone string variable in your area. For more information about POSIX format specification check out this article from IBM.</p>"},{"location":"single_page/#reference-clock","title":"Reference Clock","text":"<p>The <code>time source</code> the DataLoggerIoT uses for time values.</p>"},{"location":"single_page/#update-interval","title":"Update Interval","text":"<p>The time interval in minutes that the reference clock is used to update the DataLoggerIoT clock. Note - for an NTP source, this is handled automatically by the ESP32 platform.</p>"},{"location":"single_page/#enable-clock-fallback","title":"Enable Clock Fallback","text":"<p>If enabled, another clock source is used if the primary source is not available.</p> <p>An example of this is when a network failure occurs and NTP is not available. In this case, a fallback time source (like an RTC) is used for time values.</p>"},{"location":"single_page/#dependant-interval","title":"Dependant Interval","text":"<p>The interval in minutes used to update from the dependant clock. If <code>0</code>, the dependant clock is not used.</p>"},{"location":"single_page/#update-connected","title":"Update Connected","text":"<p>If enabled, connected clocks are updated when the main system clock is updated.</p>"},{"location":"single_page/#alternative-time-sources","title":"Alternative Time Sources","text":"<p>As an alternative to using the NTP, users can also add a compatible Qwiic-enabled device that can keep track of time (i.e. Qwiic Real Time Clock Module - RV-8803 or a Qwiic-enabled u-blox GNSS module). These can be set as the primary or secondary clock.</p> <p></p> <p>U-Blox GNSS Module Attached Via Qwiic</p> <p></p> <p>Qwiic Real Time Clock Module - RV-8803 Attached Via Qwiic</p> <p>Once attached, you will be prompted with additional options to select a primary reference clock.</p> <p></p> <p>Clock Sources</p> <p>Note</p> <p>If you are using a u-blox GNSS module, make sure that you have enough satellites in view. The option to add or configure the GNSS will not be available if there are not enough satellites in view. If you are using the Qwiic Real Time Clock Module - RV-8803, you may need to go into the device settings to manually adjust the date and time.</p>"},{"location":"single_page/#save-settings","title":"Save Settings","text":"<p>Used to save, restore and manage the system settings.</p> <p>In the Save Settings Menu, users will be able to save, restore, or clear any preferences in memory (i.e. persistent storage) or a saved file to a fallback device (i.e. microSD card). Note that any passwords and secret keys are not saved in the save settings file. You will need to manually enter those values in the file saved on the microSD card.</p> <p>When this item is selected, the following menu is prestned.</p> <p></p> <p>Save Settings  Menu</p>"},{"location":"single_page/#settings_1","title":"Settings","text":"<p>The available settings:</p>"},{"location":"single_page/#fallback-restore","title":"Fallback Restore","text":"<p>When this settings is enabled, if a normal setting restore operation fails on startup, a back source (JSON file) is used.</p> <p>This is often used to restore backup settings when you reset the datalogger.</p>"},{"location":"single_page/#fallback-save","title":"Fallback Save","text":"<p>When enabled, when settings are saved to on-board storage, they are also saved to a JSON file located on the systems SD card.</p>"},{"location":"single_page/#json-file-buffer-size","title":"JSON File Buffer Size","text":"<p>The internal buffer used to I/O of the setting values.</p>"},{"location":"single_page/#functions_1","title":"Functions","text":"<p>The following functions/actions are available in this menu:</p>"},{"location":"single_page/#save-settings_1","title":"Save Settings","text":"<p>When called, the current settings are save to persistent, on-device storage.</p>"},{"location":"single_page/#restore-settings","title":"Restore Settings","text":"<p>Setting value are restored from on-device persistent storage.</p>"},{"location":"single_page/#clear-settings","title":"Clear Settings","text":"<p>Erases settings stored on the device.</p> <p>This action does not reset the current live settings of the system. Do do this, restart the system immediatly after calling this action.</p>"},{"location":"single_page/#save-to-fallback","title":"Save to Fallback","text":"<p>Save the current setting values to the fallback setting system - a JSON file on the SD card.</p>"},{"location":"single_page/#restore-from-fallback","title":"Restore from Fallback","text":"<p>When called, and a settings JSON file is available on the SD card, the settings on the SD card are restored and applied to the system.</p>"},{"location":"single_page/#editing-the-fallback-json-file","title":"Editing the Fallback JSON File","text":"<p>If you have the Fallback Save enabled or selected the option Save to Fallback, you will notice an additional file called datalogger.json saved in the microSD card. This is the fallback file that is saved. Using a text editor, you can edit this file to adjust the settings or provide WiFi credentials, certificates, and keys. These values can then easily be restore for use by the system.</p>"},{"location":"single_page/#wifi-settings","title":"WiFi Settings","text":"<p>In the Settings Menu, select the WiFi settings. Up to 4 sets of WiFi credentials can be saved.</p> <p>Once you are in the WiFi Network menu, you can enable/disable WiFi and save the WiFi network credentials. Once connected to a 2.4GHz WiFi network, you can synchronize the date and time, connect to an IoT service to log data, and update the latest firmware over-the-air. Since the WiFi is turned on by default, you will simply need to save the WiFi network's name and password.</p> <p></p> <p>Enter WiFi Networks</p> <p>The WiFi system of the DataLoggerIoT can store up to four sets of WiFi creditials, but only one is required for connected operation. When connecting to the WiFi network, the DataLoggerIoT will attempt to locate and connect to a specified WiFi network, until a valid network is found. Having multi networks allows the DataLoggerIoT to move between locations and continue to operate without any user interaction.</p>"},{"location":"single_page/#wifi-configuration","title":"WiFi Configuration","text":"<p>The following configuration properties are provided for the WiFi connection:</p> Setting Description Enabled Enable or Disable the WiFi Network connection Network Name The SSID of the WiFi network Password The Password to connect to the WiFi network Network 2 Name Alternative network 2 SSID Network 2 Password Alternative network 2 Password Network 3 Name Alternative network 2 SSID Network 3 Password Alternative network 3 Password Network 4 Name Alternative network 2 SSID Network 4 Password Alternative network 4 Password <p>When settings are changed, the DataLoggerIoT should be restarted to have the new settings take effect.</p> <p>Note</p> <p>The ESP32-WROOM can only connect to a 2.4GHz WiFi network.</p>"},{"location":"single_page/#using-a-nfc-to-set-wifi-credentials","title":"Using a NFC to Set WiFi Credentials","text":"<p>If you have a Qwiic Dynamic NFC/RFID Tag connected to the board's Qwiic connector, you can easily update your WiFi credentials! Just make sure to save the WiFi credentials to the tag.</p> <p>If you saved your preferences to a JSON file on your microSD card's root directory, you can also save your WiFi credentials and load the system settings from the menu as well!</p>"},{"location":"single_page/#ntp-client-setup","title":"NTP Client Setup","text":"<p>NTP - Network Time Protocol -  It is a networking protocol used to synchronize the clocks of computers over a network. NTP ensures that all devices on a network maintain the same accurate time, which is crucial for various applications such as logging events, security protocols, and time-sensitive transactions.</p> <p>When connected to the network (via WiFi), the DataLoggerIoT can use NTP as a time refernce. To do this, NTP must be enabled and NTP services to use specified. The configuration of NTP for the DataLoggerIoT is enabled in this secton of the Settings menu.</p>"},{"location":"single_page/#ntp-configuration","title":"NTP Configuration","text":"<p>In the Settings menu, under the Network heading,  select the NTP Client settings.</p> <p></p> <p>NTP Client</p> <p>The NTP configuration has the following settings:</p> Setting Description Enabled Used to Enable or Disable the use of NTP by the DataLoggerIoT NTP Server One The primary NTP Server to use. Default value is: pool.ntp.org* NTP Server Two The secondary NTP Server to use. Default value is: time.nist.gov <p>Note</p> <p>Only one NTP service is required to use this option, but it's common to provice two for redundancy.</p> <p>Once changes are made to the NTP settings, the should take effect immediatly.</p>"},{"location":"single_page/#logger-setup","title":"Logger Setup","text":"<p>In the Settings menu, select the Logger menu to adjust how data is logged, including what additional data to provide besides sensor readings.</p> <p>When this menu option is selected, the following menu is presented:</p> <p></p> <p>Logger Menu Options</p> <p>Details of menu item are outlined in the following sections.</p>"},{"location":"single_page/#settings_2","title":"Settings","text":""},{"location":"single_page/#timestamp-mode","title":"Timestamp Mode","text":"<p>This setting is used to add a timestamp to the output logging stream for each data sample/observation. The format of the timestamp is also selected.</p> <p>The options for this settings are:</p> <ul> <li>No Timestamp - no timestamp is added to the output - this is the default option</li> <li>Milliseconds since program start - Time since the system was started, in milliseconds</li> <li>Seconds since Epoch - Seconds since epoch (January 1, 1970 00:00:00.00 UTC). A valid system time is required for this value to be accurate.</li> <li>Milliseconds since Epoch - Milliseconds since epoch (January 1, 1970 00:00:00.00 UTC). A valid system time is required for this value to be accurate.</li> <li>Date Time - USA Date format - a data/time string formatted using standard US date format - MM-DD-YYYY</li> <li>Date Time - A standard non-USA formatted date string - DD-MM-YYYY</li> <li>ISO8601 Timestamp - an ISO8601 formatted timestamp</li> <li>ISO8601 Timestamp with Time Zone - an ISO8601 formatted timestamp with the current time zone included</li> <li>ISO8601 Timestamp - Week Date - an ISO8601 formatted timestamp using a week date format</li> <li>ISO8601 Timestamp - Week Date with Time Zone - an ISO8601 formatted timestamp using a week date format and the current time zone.</li> </ul>"},{"location":"single_page/#sample-numbering","title":"Sample Numbering","text":"<p>The \"sample number\" for a the logged data is included in the log stream. This is incremented with each log event by the value of the Number Increment setting value</p>"},{"location":"single_page/#numbering-increment","title":"Numbering Increment","text":"<p>The amount to increment the output Sample Number after each logged observation.</p>"},{"location":"single_page/#output-id","title":"Output ID","text":"<p>Include the DataLoggerIoT board ID in the output log stream</p>"},{"location":"single_page/#output-name","title":"Output Name","text":"<p>Include the DataLoggerIoT board Name in the output log stream</p>"},{"location":"single_page/#rate-metric","title":"Rate Metric","text":"<p>If enabled, the system will record the logging data rate. This is helpful in determining the performance of the datalogger.</p>"},{"location":"single_page/#output-source-name","title":"Output Source Name","text":"<p>When enabled, the source of the logging event is included in the log stream. This could include values like 'timer', 'GPIO Interrupt', 'GNSS PPS' ...etc.</p>"},{"location":"single_page/#output_1","title":"Output","text":"<p>These settings are used to control output format and additional values for the datalogger.</p>"},{"location":"single_page/#sd-card-format_1","title":"SD Card Format","text":"<p>The format used when writing to the SD Card - options are CSV, JSON, or None.</p>"},{"location":"single_page/#serial-console-format_1","title":"Serial Console Format","text":"<p>The format used when writing data to the serial console - options are CSV, JSON, or None.</p>"},{"location":"single_page/#system-info","title":"System Info","text":"<p>When enabled, the following data is added to the log stream:</p> <ul> <li>WiFi SSID</li> <li>WiFi RSSI</li> <li>System uptime</li> <li>System SD Card free space</li> <li>System memory heap</li> </ul>"},{"location":"single_page/#functions_2","title":"Functions","text":""},{"location":"single_page/#reset-sample-counter","title":"Reset Sample Counter","text":"<p>This will reset the sample counter in the logger to a provided value.</p>"},{"location":"single_page/#example-output","title":"Example Output","text":"<p>The following image is JSON formatted serial console output for the datalogger. The following options are enabled:</p> <ul> <li>Timestamp enabled - ISO8601 Timestamp format</li> <li>Board ID</li> <li>Board Name</li> <li>Trigger source</li> <li>System Info</li> </ul> <p></p> <p>JSON Formatted Log Output to the Serial Console</p>"},{"location":"single_page/#logging-timer","title":"Logging Timer","text":"<p>In the Settings menu,  select the Timer option adjust the Logging Timer period value.</p> <p>When selected, the following menu is presented.</p> <p></p> <p>Logging Timer Menu Options</p> <p>Adjusting the interval for the Logging Timer will change the amount of time between log entries.</p>"},{"location":"single_page/#settings_3","title":"Settings","text":""},{"location":"single_page/#interval","title":"Interval","text":"<p>The interval between log-events in milliseconds.</p>"},{"location":"single_page/#logging-data-file","title":"Logging - Data File","text":"<p>A key feature of the DataLoggerIoT is logging data to an IoT web service, but it still performs core data logging functionality, including logging data to a file on an SD card.</p> <p>The logging to a file includes <code>file rotation</code> - after a specific period of time, a new file is created using a numbering scheme and prefix.</p>"},{"location":"single_page/#options","title":"Options","text":"<p>In the Settings menu, select the Data File Menu Item to adjust the Logging Data File.</p> <p></p> <p>Data File Menu Options</p> <p>Adjusting these parameters allows you to change the filename prefix, the number the files starts at, and how often the DataLogger will create a new file on the microSD card.</p> <p>The file naming scheming used is:  <code>[prefix string][number].txt</code></p> <p>For example, the default file will be saved as sfe0001.txt. After 1 day, the DataLogger will rotate files by creating a new file named sfe0002.txt. The DataLogger will begin logging data in this new file. The purpose of this log rotation is to limit the size of each file prevent issues when opening large files.</p>"},{"location":"single_page/#settings_4","title":"Settings","text":""},{"location":"single_page/#rotate-period","title":"Rotate Period","text":"<p>This value is the time between file rotation.</p> <p>Options for this setting are:</p> <ul> <li>6 Hours</li> <li>12 Hours</li> <li>1 Day</li> <li>2 Days</li> <li>1 Week</li> </ul>"},{"location":"single_page/#file-start-number","title":"File Start Number","text":"<p>The number to start the file name numbering.</p>"},{"location":"single_page/#details","title":"Details","text":"<p>The contents of the file will depend on how the data was saved (either CSV or JSON). Make sure that the SD Card format is enabled to either CSV or JSON with your desired device outputs turned on so that the DataLogger can save the readings.</p> <p>When removing the microSD card, make sure to remove your power source. Then insert into it into microSD card adapter or USB reader. When connecting the memory card to your computer, you can use a text editor to view the saved readings. In this case, a Windows operating system was viewing the file sfe0000.txt and it was only file available in the microSD card.</p> <p></p> <p>Reading data value from Text File</p>"},{"location":"single_page/#external-serial","title":"External Serial","text":"<p>This menu item is used to configure logging from an external serial device that is connected to the datalogger via GPIO pins.</p> <p>Selecting this option brings up the following menu:</p> <p></p>"},{"location":"single_page/#settings_5","title":"Settings","text":""},{"location":"single_page/#serial-settings","title":"Serial Settings","text":"<p>These settings define the parameters of the connected device.</p>"},{"location":"single_page/#rx-pin","title":"RX Pin","text":"<p>The GPIO pin on the DataLoggerIoT to use as the RX pin for communicating with the external device. The default pin is <code>16</code>.</p>"},{"location":"single_page/#tx-pin","title":"TX Pin","text":"<p>The GPIO pin on the DataLoggerIoT to use as the TX pin for communicating with the external device. The default pin is <code>17</code>.</p>"},{"location":"single_page/#baud-rate","title":"Baud Rate","text":"<p>Set this to the Baud Rate to use when communicating with the external device.</p>"},{"location":"single_page/#functionality","title":"Functionality","text":""},{"location":"single_page/#serial-input-device","title":"Serial Input Device","text":"<p>When enabled, the system create a \"Serial Input Device\" that is added as a device to the system. This device is used to read data from the external device via a Serial connection and is used just like any other device in the system.</p> <p></p>"},{"location":"single_page/#serial-device","title":"Serial Device","text":"<p>When the serial device is enabled, a \"Serial Device\" driver is added to the <code>Device List</code> of the DataLoggerIoT.</p> <p>Selecting this device from the <code>Device Settings</code> page of the menu system, brings up the following menu:</p> <p></p> <p>The device is fairly simple - you enable/disable it and when a log event occurs, any value available in the serial device is read as a string and output to the log stream.</p> <p>Additionally, when this device is enabled, when data is available from the serial device, a log event is triggered so that the data is read. This is done to prevent the underlying serial device buffer from overflowing.</p>"},{"location":"single_page/#settings_6","title":"Settings","text":""},{"location":"single_page/#enable","title":"Enable","text":"<p>Used to enable the device. When enabled, when data is available on the Serial device, it triggers a log event, which will read and log the data in the device.</p>"},{"location":"single_page/#soil-mosture-sensor","title":"Soil Mosture Sensor","text":"<p>The DataLoggerIoT can support reading values from a GPIO connected, resistive Soil Moisture sensor, like the SparkFun Soil Moisture Sensor. When connected to the datalogger, and enabled, the DataLoggerIoT will read the analog moisture value from the sensor and add that to the output log stream.</p>"},{"location":"single_page/#enabling-the-soil-moisture-sensor","title":"Enabling the Soil Moisture Sensor","text":"<p>Once the sensor is attached to the DataLoggerIoT via GPIO pins, the Soil Moisture Sensor device is enabled using the 'Soil Moisture Sensor' menu item located under the GPIO Devices header.  This is enabled using the following menu item:</p> <p></p> <p>Once enabled, a Soil Moisture Device is added to the DataLoggerIoT.</p> <p></p>"},{"location":"single_page/#soil-moisture-device","title":"Soil Moisture Device","text":"<p>The Soil Moisture Devide has the following menu:</p> <p></p>"},{"location":"single_page/#settings_7","title":"Settings","text":""},{"location":"single_page/#enable-this-sensor","title":"Enable this sensor","text":"<p>Used to enable the device.</p>"},{"location":"single_page/#vcc-pin","title":"VCC Pin","text":"<p>The datalogger GPIO pin used for VCC to the soil moisture sensor. The default is <code>33</code>.</p>"},{"location":"single_page/#sensor-pin","title":"Sensor Pin","text":"<p>The GPIO Pin to use as the Sensor Pin - the default value is <code>2</code>.</p>"},{"location":"single_page/#calibration-dry-value","title":"Calibration Dry Value","text":"<p>The sensor value that represents a \"Dry\" state (0%). The default value is 0.</p>"},{"location":"single_page/#calibration-wet-value","title":"Calibration Wet Value","text":"<p>The sensor value that represents a \"Wet\" state (100%). The default value is 1024.</p>"},{"location":"single_page/#functions_3","title":"Functions","text":""},{"location":"single_page/#calibrate-low-dry-value","title":"Calibrate Low (dry) Value","text":"<p>Place the sensor in a dry state and then run this function. The driver will set the curret value as the \"dry\" calibration value.</p>"},{"location":"single_page/#calibrate-high-wet-value","title":"Calibrate High (wet) Value","text":"<p>Place the sensor in a wet state and then run this function. The driver will set the curret value as the \"wetl\" calibration value.</p>"},{"location":"single_page/#analog-pin-sensor","title":"Analog Pin Sensor","text":"<p>This menu item is used to enable the GPIO Analog Pin Device within the DataLoggerIoT. When enabled, an Analog Pin Reading device driver is added to the dataloggers Device Settings list.</p>"},{"location":"single_page/#enabling-the-analog-pin-sensor","title":"Enabling the Analog Pin Sensor","text":"<p>Once the analog device is connected to a supported gpio analog pin on the datalogger, the Analog Pin device is enabled using the <code>Analog Pin Sensor</code> menu item located under the GPIO Devices header. This is enabled using the following menu item:</p> <p></p> <p>Once enabled, a Analog Pin Reading device is added to the DataLogger IoT.</p> <p></p>"},{"location":"single_page/#analog-pin-reading-device","title":"Analog Pin Reading Device","text":"<p>The Analog Pin Reading device has the following menu:</p> <p></p>"},{"location":"single_page/#settings_8","title":"Settings","text":""},{"location":"single_page/#enable-this-sensor_1","title":"Enable this sensor","text":"<p>Used to enable the device</p>"},{"location":"single_page/#sensor-pin_1","title":"Sensor Pin","text":"<p>The datalogger GPIO pin to read the analog value from. This is the pin the external analog device is connected to.</p> <p>Value values for this are:</p> <ul> <li>A0</li> <li>A3</li> <li>A7</li> </ul> <p></p>"},{"location":"single_page/#mqtt-iot","title":"MQTT IoT","text":""},{"location":"single_page/#connecting-and-publishing-data-to-mqtt","title":"Connecting and Publishing Data to MQTT","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers and servers. This document outlines how output from a DataLogger device is sent to an MQTT Broker.</p> <p>The following is covered by this document:</p> <ul> <li>Overview of the MQTT connection</li> <li>How a user configures and uses the MQTT connection</li> <li>MQTT examples</li> </ul>"},{"location":"single_page/#general-operation_1","title":"General Operation","text":"<p>MQTT connectivity allows data generated by the DataLogger IoT to be published to an MQTT Broker under a user configured topic. MQTT is an extremely flexible and low overhead data protocol that is widely used in the IoT field.</p> <p>The general use pattern for MQTT is that data is published to a topic on a MQTT broker. The data is then sent to any MQTT client that has subscribed to the specified topic.</p> <p></p> <p>The DataLogger IoT supports MQTT connections, allowing an end user to enter the parameters for the particular MQTT Broker for the application to publish data to. When the application outputs data to the broker, the DataLogger IoT publishes the available information to the specified \"topic\" with the payload that is a JSON document.</p>"},{"location":"single_page/#data-structure","title":"Data Structure","text":"<p>Data is published to the MQTT broker as a JSON object, which contains a collection of sub-objects. Each sub-object represents a data source in the sensor, and contains the current readings from that source.</p> <p>The following is an example of the data posted - note, this representation was \"pretty printed\" for readability.</p> <pre><code>{\n  \"MAX17048\": {\n    \"Voltage (V)\": 4.304999828,\n    \"State Of Charge (%)\": 115.0625,\n    \"Change Rate (%/hr)\": 0\n  },\n  \"CCS811\": {\n    \"CO2\": 620,\n    \"VOC\": 33\n  },\n  \"BME280\": {\n    \"Humidity\": 25.03613281,\n    \"TemperatureF\": 79.64599609,\n    \"TemperatureC\": 26.46999931,\n    \"Pressure\": 85280.23438,\n    \"AltitudeM\": 1430.44104,\n    \"AltitudeF\": 4693.04834\n  },\n  \"ISM330\": {\n    \"Accel X (milli-g)\": -53.31399918,\n    \"Accel Y (milli-g)\": -34.03800201,\n    \"Accel Z (milli-g)\": 1017.236023,\n    \"Gyro X (milli-dps)\": 542.5,\n    \"Gyro Y (milli-dps)\": -1120,\n    \"Gyro Z (milli-dps)\": 262.5,\n    \"Temperature (C)\": 26\n  },\n  \"MMC5983\": {\n    \"X Field (Gauss)\": -0.200622559,\n    \"Y Field (Gauss)\": 0.076416016,\n    \"Z Field (Gauss)\": 0.447570801,\n    \"Temperature (C)\": 29\n  }\n}\n</code></pre>"},{"location":"single_page/#mqtt-broker-connection-setup","title":"MQTT Broker Connection Setup","text":"<p>To connect to a MQTT Broker, the following information is needed:</p> <ul> <li>The server name/address</li> <li>The server port</li> <li>The topic to post to</li> <li>[optional] The name of the device/Client name publishing the data</li> <li>[optional] A username - if required</li> <li>[optional] A password - if required</li> </ul> <p>These values are set using the standard DataLogger methods - the interactive menu system, or a JSON file.</p>"},{"location":"single_page/#mqtt-menu-system","title":"MQTT Menu System","text":"<p>We'll need to adjust the settings for the MQTT Client using the MQTT Menu System.</p> <p>For users that are interested in using the menu system, open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to  115200 baud. In this case, we connected to COM13.  Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then type <code>9</code> to enter the MQTT Client Menu. When the menu system for the MQTT connection is presented, the following options are displayed:</p> <p></p> <p>The options are:</p> <ul> <li>Enable/Disable the connection</li> <li>Broker Port - The standard port for mqtt is 1883</li> <li>Broker Server - This is just the name of the server</li> <li>MQTT Topic - A string</li> <li>Client Name</li> <li>Username</li> <li>Password</li> <li>Buffer Size</li> </ul> <p>At a minimum, the Broker Port, Broker Server Name, and MQTT Topic need to be set. What parameters are required depends on the settings of the broker being used.</p> <p>NOTE If a secure connection is being used with the MQTT broker, use the <code>MQTT Secure Client</code> option of the DataLogger IoT. This option supports secure connectivity.</p> <p>NOTE The <code>Buffer Size</code> option is dynamic by default, adapting to the size of the payload being sent. If runtime memory is a concern, set this value to a static size that supports the device operation.</p> <p>Once all these values are set, the system will publish data to the specified MQTT Broker, following the JSON information structure noted earlier in this document.</p>"},{"location":"single_page/#json-file-entries","title":"JSON File Entries","text":"<p>If a JSON file is being used as an option to import settings into the DataLogger IoT, the following entries are used for the MQTT IoT connection:</p> <pre><code>\"MQTT Client\": {\n    \"Enabled\": false,\n    \"Port\": 1883,\n    \"Server\": \"my-mqttserver.com\",\n    \"MQTT Topic\": \"/sparkfun/datalogger1\",\n    \"Client Name\": \"mysensor system\",\n    \"Buffer Size\": 0,\n    \"Username\": \"\",\n    \"Password\": \"\"\n  },\n</code></pre> <p>Where:</p> <ul> <li><code>Enabled</code> - Set to <code>true</code> to enable the connection.</li> <li><code>Port</code> - Set to the broker port.</li> <li><code>Server</code> - The MQTT broker server.</li> <li><code>MQTT Topic</code> - The topic to publish to.</li> <li><code>Client Name</code> - Optional client name.</li> <li><code>Buffer Size</code> - Internal transfer buffer size.</li> <li><code>Username</code> - Broker user name if being used.</li> <li><code>Password</code> - Broker password if being used.</li> </ul> <p>TIP To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the MQTT Client as well.</p>"},{"location":"single_page/#testing-the-mqtt-connection","title":"Testing the MQTT Connection","text":"<p>Use of a MQTT connection is fairly straightforward - just requiring the entry of broker details into the connection settings.</p> <p>To test the connection, you need a MQTT broker available. A quick method to setup a broker is by installing the <code>mosquitto</code> package on a Raspberry Pi computer. Our basic MQTT Tutorial provides some basic setup for a broker.</p> <p>This MQTT Broker Tutorial has more details, covering the setup needed for modern mosquitto configurations.</p> <p>And once the broker is setup, the messages published by the IoT sensor are visible using the <code>mosquitto_sub</code> command as outlined. For example, to view messages posted to a the topic \"/sparkfun/datalogger1\", the following command is used:</p> <pre><code>mosquitto_sub -t \"/sparkfun/datalogger1\"\n</code></pre> <p>This assumes the MQTT broker is running on the same machine, and using the default port number.</p>"},{"location":"single_page/#creating-and-connecting-to-an-aws-iot-device-thing","title":"Creating and Connecting to an AWS IoT Device (Thing)","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers. This document outlines how an AWS IoT device is used by the DataLogger IoT.</p> <p>The following is covered by this document:</p> <ul> <li>Device (Thing) creation in AWS</li> <li>Securely connecting the device</li> <li>How data is posted from the DataLogger IoT to the AWS Device via it's Shadow</li> </ul> <p>Currently, the AWS IoT device connection is a single direction - used to post data from the hardware to the IoT AWS Device via the AWS IoT devices shadow. Configuration information from AWS IoT to the DataLogger IoT is currently not implemented.</p>"},{"location":"single_page/#general-operation_2","title":"General Operation","text":"<p>AWS IoT enables connectivity between an IoT / Edge device and the AWS Cloud Platform, implementing secure endpoints and device models within the AWs infrastructure. This infrastructure allows edge devices to post updates, status and state to the AWS infrastructure for analytics, monitoring and reporting.</p> <p>In AWS IoT, an virtual representation of an actual device is created and referred to as a Thing. The virtual device/Thing is allocated a connection endpoint, security certificates and a device shadow - a JSON document used to persist, communicate and manage device state within AWS.</p> <p>The actual IoT device communicates with it's AWS representation via a secure MQTT connection, posting JSON document payloads to a set of pre-defined topics. Updates are posted to the AWS IoT device shadow, which is then accessed within AWS for further process as defined by the users particular cloud implementation.</p> <p></p>"},{"location":"single_page/#creating-a-device-in-aws-iot","title":"Creating a Device in AWS IoT","text":"<p>The following discussion outlines the basic steps taken to create a Thing in AWS IoT that the DataLogger IoT can connect to. First step is to log into your AWS account and create a thing.</p> <p>Once logged into your AWS account, select IoT Core from the menu of services. </p> <p>From the IoT Core console page, under the Manage section, select All Devices &gt; Things </p> <p>On the resultant Things Page, select the Create Things button.</p> <p></p> <p>AWS IoT will then take you through the steps to create a device. Selections made for a demo Thing are:</p> <ul> <li>Create single thing</li> <li>Thing Properties</li> <li>Enter a name for your thing - for this example TestThing23</li> <li>Device Shadow - select Unnamed shadow (classic)</li> <li>Auto-generate a new certificate</li> <li>Attach policies to certificate - This is discussed later in this document</li> <li>Select Create thing</li> </ul> <p>Upon creation, AWS IoT presents you with a list of downloadable certificates and keys. Some of these are only available at this step. The best option is to download everything presented - three of these are used by the DataLogger IoT. The following should be downloaded:</p> <ul> <li>Device Certificate</li> <li>Public Key File</li> <li>Private Key File</li> <li>Root CA certificates - (for example:  Amazon Root CA 1 )</li> </ul> <p>At this point, the new AWS IoT thing is created and listed on the AWS IoT Things Console</p> <p></p>"},{"location":"single_page/#security-policy","title":"Security Policy","text":"<p>To write to the IoT device, a security policy that enables this is needed, and the policy needs to be assigned to the devices certificate.</p> <p>To create a Policy, select the Manage &gt; Security &gt; Policies menu item from the left side menu of the AWS IoT panel. Once on this page, select the Create policy button to create a new policy.</p> <p></p> <p>When entering the policy, provide a name that fits your need. For this example, the name NewThing23Policy is used. For the Policy document, you can manually enter the security entires, or enter them as a JSON document. The JSON document used for this example is:</p> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Connect\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Subscribe\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Receive\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:Publish\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:GetThingShadow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iot:UpdateThingShadow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n</code></pre> <p></p> <p>Once the policy is created, go back to the IoT Device/Thing created above and associate this policy to the device Certificate.</p> <ul> <li>Go to your device Manage &gt; All devices &gt; Things</li> <li>Select the device - TestThing23 for this example</li> <li>Select the Certificates tab</li> <li>Select the listed Certificate (it's a very long hex number)</li> <li>At the bottom right of the page, select the Attach policies button and select the Policy created above.</li> </ul> <p></p> <p>At this point, AWS IoT is ready for a device to connect and receive data.</p>"},{"location":"single_page/#aws-configuration","title":"AWS Configuration","text":"<p>The specifics for the AWS IoT Thing must be configured. This includes the following:</p> <ul> <li>Server name/host</li> <li>MQTT topic to update</li> <li>Client Name - The AWS IoT Thing Name</li> <li>CA Certificate Chain</li> <li>Client Certificate</li> <li>Client Key</li> </ul>"},{"location":"single_page/#server-namehostname","title":"Server Name/Hostname","text":"<p>This value is obtained from the AWS IoT Device page for the created device. When on this page, select the Device Shadows tab, and then select the Classic Shadow shadow, which is listed. Note a secure connection is used, so the port for the connection is <code>8883</code>.</p> <p></p> <p>Selecting the Classic Shadow entry provides the Server Name/Hostname for the device, as well as the MQTT topic for this device.</p> <p></p> <p>Note</p> <p>The server name is obtained from the Device Shadow URL entry</p>"},{"location":"single_page/#mqtt-topic","title":"MQTT Topic","text":"<p>The MQTT topic value is based uses the MQTT topic prefix from above, and has the value update added to it. So for this example, the MQTT topic is:</p> <pre><code>    $aws/things/TestThing23/shadow/update\n</code></pre>"},{"location":"single_page/#client-name","title":"Client Name","text":"<p>This is the AWS IoT name of the thing. For the provided example, the value is TestThing23</p>"},{"location":"single_page/#ca-certificate-chain","title":"CA Certificate Chain","text":"<p>This value was downloaded as a file during the creation process. The contents of this file can be passed on to the DataLogger IoT by copying the file containing the data onto a devices SD Card and setting the filename property for the DataLogger IoT.</p>"},{"location":"single_page/#client-certificate","title":"Client Certificate","text":"<p>This value was downloaded as a file during the creation process. The contents of this file can be passed on to the DataLogger IoT by copying the file containing the data onto a devices SD Card and setting the filename property for the DataLogger IoT.</p>"},{"location":"single_page/#client-key","title":"Client Key","text":"<p>This value was downloaded as a file during the creation process. The contents of this file can be passed on to the DataLogger IoT by copying the file containing the data onto a devices SD Card and setting the filename property for the DataLogger IoT.</p>"},{"location":"single_page/#setting-properties","title":"Setting Properties","text":"<p>The above property values must be set on the DataLogger before use. They can be set manually by using the menu system like the previous MQTT example.</p> <p>For users that are interested in using the menu system, you will need to open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type &lt;<code>1</code> to enter the Settings menu. Then type <code>11</code> to enter the AWS IoT Menu. When the menu system for the AWS IoT connection is presented, you will need to configure the property values as listed in the JSON file. Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The alternative to using the menu system is a JSON file. These values can be set using a JSON file that is loaded by the system at startup. For the DataLogger IoT example outlined in this document, the entries in the settings JSON file are as follows:</p> <pre><code>\"AWS IoT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"avgpd2wdr5s6u-ats.iot.us-east-1.amazonaws.com\",\n    \"MQTT Topic\": \"$aws/things/TestThing23/shadow/update\",\n    \"Client Name\": \"TestThing23\",\n    \"Buffer Size\": 0,\n    \"Username\": \"\",\n    \"Password\": \"\",\n    \"CA Certificate\": \"\",\n    \"Client Certificate\": \"\",\n    \"Client Key\": \"\",\n    \"CA Cert Filename\": \"AmazonRootCA1.pem\",\n    \"Client Cert Filename\": \"TestThing23_DevCert.crt\",\n    \"Client Key Filename\": \"TestThing23_Private.key\"\n  },\n</code></pre> <p>Besides updating the <code>Server</code>, <code>MQTT Topic</code>, <code>Client Name</code>, <code>CA Cert Filename</code>, <code>Client Cert Filename</code>, and <code>Client Key Filename</code>, you will need to also ensure that the <code>port</code> is set to <code>8883</code>. The default in previous firmware versions was <code>1883</code>. As of firmware v01.00.04, the default is <code>8883</code>. You will need to adjust the port value to properly connect to the AWS IoT service. Don't forget to enable AWS IoT service by setting the value to <code>true</code>. If the JSON file is saved in the microSD card, you can load the credentials to the DataLogger IoT.</p> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the AWS IoT as well.</p>"},{"location":"single_page/#operation","title":"Operation","text":"<p>Once the device is configured and running, updates in AWS IoT are listed in the Activity tab of the devices page. For the test device in this document, this page looks like:</p> <p></p> <p>Opening up an update, you can see the data being set to AWS IoT in a JSON format.</p> <p></p>"},{"location":"single_page/#creating-and-connecting-to-thingspeak","title":"Creating and Connecting to ThingSpeak","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers. This document outlines how a ThinkSpeak output is used by the DataLogger IoT.</p> <p>The following is covered by this document:</p> <ul> <li>Creating a ThingSpeak Channel and MQTT Connection</li> <li>Securely connecting the ThingSpeak</li> <li>How data is posted from the DataLogger IoT to ThingSpeak</li> </ul>"},{"location":"single_page/#general-operation_3","title":"General Operation","text":""},{"location":"single_page/#thingspeak-structure","title":"ThingSpeak Structure","text":"<p>The structure of ThingSpeak is based off of the concept of Channels, with each channel supporting up to eight fields for data specific to the data source. Each channel is named, and has a unique ID associated with it.  One what to think of it is that a Channel is a grouping of associated data values or fields.</p> <p>The fields of a channel are enumerated as Field1, Field2, ..., Field8, but each field can be named to simplify data access and understanding.</p> <p>As data is reported to a ThingSpeak channel, the field values are accessible for further processing or visualization output.</p>"},{"location":"single_page/#data-structure_1","title":"Data Structure","text":"<p>The DataLogger IoT is constructed around the concept of Devices which are often a type of sensor that can output a set of data values per observation or sample.</p>"},{"location":"single_page/#mapping-data-to-thingspeak","title":"Mapping Data to ThingSpeak","text":"<p>The concept of Channels that contain Fields in ThingSpeak is similar to the Devices that contain Data within the DataLogger IoT, and this similarity is the mapping model used by the DataLogger IoT. Specifically:</p> <ul> <li>Devices == Channels</li> <li>Data == Fields</li> </ul> <p></p> <p>During configuration of the DataLogger IoT, the mapping between the Device and ThingSpeak channel is specified. The data to field mapping is automatically created by the DataLogger IoT following the data reporting order from the specific device driver.</p>"},{"location":"single_page/#creating-a-device-to-a-thingspeak-channel","title":"Creating a Device to a ThingSpeak Channel","text":"<p>The following discussion outlines the basic steps taken to create a Channel in ThingSpeak and then connect it to the DataLogger's Device. First step is to log into your ThingSpeak and create a Channel.</p> <p>Once logged into your ThingSpeak account, select Channels &gt; My Channels menu item and on the My Channel page, select the New Channel button.</p> <p></p> <p>On the presented channel page, name the channel and fill in the specific channel fields. The fields should map to the data fields reported from the Device being linked to this channel. Order is important, and is determined by looking at output of a device to the serial device (or reviewing the device driver code).</p> <p></p> <p>Once the values are entered, select Save Channel. ThingSpeak will now show list of Channel Stats, made up of line plots for each field specified for the channel.</p> <p>Key note - at the top of this page is listed the Channel ID. Note this number - it is used to map a Device to a ThingSpeak Channel.</p>"},{"location":"single_page/#setting-up-thingspeak-mqtt","title":"Setting Up ThingSpeak MQTT","text":"<p>The DataLogger IoT uses MQTT to post data to a channel. From the ThingSpeak menu, select Devices &gt; MQTT, which displays a list of your MQTT devices. From this page, select the Add a new device button.</p> <p>On the presented dialog, enter a name for the MQTT connection and in the Authorize channels to access, select the channel created earlier. Once you select a channel, click the Add Channel button.</p> <p>More channels can be added later.</p> <p></p> <p>When the MQTT device is created, a set of credentials (Client ID, Username, and Password) is provided. Copy or download these values, since the password in not accessible after this step.</p> <p>The selected Channel is then listed in the Authorized Channel table. Ensure that the Allow Publish and Allow Subscribe attributes are enabled for the added channel.</p> <p></p> <p>At this point, the ThingSpeak Channel is setup for access by the DataLogger IoT.</p>"},{"location":"single_page/#thingspeak-configuration","title":"ThingSpeak Configuration","text":"<p>Once the device is integrated into the application, the specifics for the ThingSpeak Channel(s) must be configured. This includes the following:</p> <ul> <li>Server Name/Hostname</li> <li>Client Name</li> <li>User Name</li> <li>Password</li> <li>Device to Channel mapping</li> <li>CA Certificate Chain</li> </ul>"},{"location":"single_page/#server-namehostname_1","title":"Server Name/Hostname","text":"<p>This value is hostname of the ThingSpeak mqtt connection, which is mqtt3.thingspeak.com as note at ThingSpeakMQTT Basics page. Note a secure connection is used, so the port for the connection is <code>8883</code>.</p>"},{"location":"single_page/#client-nameid","title":"Client Name/ID","text":"<p>The Client Name/ID is found under MQTT connection details listed in the Devices &gt; MQTT section of ThingSpeak.</p>"},{"location":"single_page/#username","title":"Username","text":"<p>The Username is found under MQTT connection details listed in the Devices &gt; MQTT section of ThingSpeak.</p>"},{"location":"single_page/#password","title":"Password","text":"<p>The connection password was provided when the MQTT device was created. If you lost this value, you can regenerate a password on the MQTT Device information page.</p>"},{"location":"single_page/#certificate-file","title":"Certificate File","text":"<p>You can download the cert file for ThingSpeak.com page using a web-browser. Click on the security details of this page, and navigate the dialog (browser dependent) to download the certificate. The downloaded file is the made available for the DataLogger IoT to use as a file that is loaded at runtime)</p>"},{"location":"single_page/#setting-properties_1","title":"Setting Properties","text":"<p>The above property values must be set on the DataLogger IoT before use. They can be manually by using the menu system like the previous MQTT example.</p> <p>For users that are interested in using the menu system, you will need to open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then enter the ThingSpeak MQTT Menu. When the menu system for the ThingSpeak MQTT connection is presented, you will need to configure the property values as listed in the JSON file.  Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The alternative to using the menu system is a JSON file. These values can be set using a JSON file that is loaded by the system at startup. For the ThingSpeak example outlined in this document, the entries in the settings JSON file are as follows:</p> <pre><code>\"ThingSpeak MQTT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"mqtt3.thingspeak.com\",\n    \"MQTT Topic\": \"\",\n    \"Client Name\": \"MQTT_Device_Client_ID\",\n    \"Buffer Size\": 0,\n    \"Username\": \"MQTT_Device_Username\",\n    \"Password\": \"MQTT_Device_Password\",\n    \"CA Cert Filename\": \"ThingspeakCA.cer\",\n    \"Channels\" : \"BME280=2054891\"\n  }\n</code></pre> <p>The Channels value is a list of [DEVICE NAME]=[Channel ID] pairs. Each pair is separated by a comma. In this case, the device name <code>BME280</code> and the channel ID was <code>2054891</code>. Make sure to match the device name that was loaded on start up with the unique channel ID that was generated when creating a ThingSpeak Channel.</p> <p>Besides updating the <code>Server</code>, <code>Client Name</code>, <code>Username</code>, <code>Password</code>, <code>CA Cert Filename</code>, and <code>Channels</code>, you will need to also ensure that the <code>port</code> is set to <code>8883</code>. The default in previous firmware versions was <code>1883</code>. As of firmware v01.00.04, the default is <code>8883</code>. You will need to adjust the port value to properly connect to the ThingSpeak service. Don't forget to enable ThingSpeak MQTT service by setting the value to <code>true</code>. If the JSON file is saved in the microSD card, you can load the credentials to the DataLogger IoT.</p> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the ThingSpeak MQTT as well.</p>"},{"location":"single_page/#monitoring-output","title":"Monitoring Output","text":"<p>Once the connector is configured and the DataLogger IoT is connected to ThingSpeak, as data is posted, the results are show on the Channel Stats page for your Channel. For the above example, the output of a SparkFun BME280 sensor produces the following output:</p> <p></p>"},{"location":"single_page/#setting-up-2x-or-more-devices","title":"Setting Up 2x or More Devices","text":"<p>For users that are setting up 2x or more devices on the DataLogger IoT, you will need to ensure that each device has their own ThingSpeak Channel. Unfortunately, you are not able to plot sensor readings from two devices in the same channel.</p> <p>The following example demonstrates how to set up two devices for ThingSpeak on the DataLogger IoT. In this case, we will use the BME688 and BME680 and their respective default I<sup>2</sup>C address. This is also a good example of what to do when two devices use the same device driver. Head to ThingSpeak to create a channel for each device connected to the DataLogger IoT. Include a field for each device data that the DataLogger provides. The name of the channel does not need to match the device name or I<sup>2</sup>C address.</p> <p>Creating a Channel for the BME688</p> <p></p> <p>Creating a Channel for the BME680</p> <p></p> <p>Once the channels are created, you will be provided with a unique channel ID for each channel. Make sure to take note of the number as explained earlier.</p> <p>The alternative I<sup>2</sup>C address for the BME688 and BME680 uses the same address as the default of the other sensor:</p> <ul> <li>BME680: 0x77 (Default) or 0x76</li> <li>BME688: 0x76 (Default) or 0x77</li> </ul> <p>Make sure to avoid using the same address when connecting the sensors to the same DataLogger IoT.</p> <p>When setting up the connection, you will need to authorize both channels. In this example, we included the channels for the BME688 [x076] and BME680 [x077].</p> <p>Authorizing 2x Channels through the Same Connection</p> <p></p> <p>Now that the ThingSpeak MQTT connection is setup, adjust the ThingSpeak configuration for the DataLogger IoT by including the credentials (i.e. Client Name, Username, and Password) and channels. We will assume that you have included the ThingSpeak CA certificate file in the root directory of the microSD card already. When including the device name with their respective channel, ensure that the device name matches the name that was loaded on startup. For example, the BME688 and BME680 were loaded on startup as <code>BME68x</code> and <code>BME68x [x77]</code>, respectively. Since we are only interested in plotting the BME688 and BME680, we will ignore the MAX17048 that was loaded on startup as well. Under /Settings/ThingSpeak MQTT/Channels, you will enter the string for the device names, each of their respective channel IDs, and a comma separating the two channels like so: <code>BME68x=2613826, BME68x [x77]=2613825</code>.</p> <p>DataLogger IoT Device Name Loaded during Startup</p> <p></p> <p>Device Name and Channel for Both Sensors</p> <p></p> <p>Whenever there are multiple devices using the same device driver (each with unique I<sup>2</sup>C addresses), the DataLogger IoT will display the device address for each additional device that is loading the same driver. As shown above, the first device name did not include the device's I<sup>2</sup>C address. The second device name using the same driver included its I<sup>2</sup>C address. Of course, there is an configuration that enables you to always include the address of all the device names.</p> <p>The alternative to using the menu system is the JSON file. In this case, we updated channels for the BME688 and BME680. Not shown are the ThingSpeak Client Name, Username, and Password.</p> <pre><code>\"ThingSpeak MQTT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"mqtt3.thingspeak.com\",\n    \"MQTT Topic\": \"\",\n    \"Client Name\": \"MQTT_Device_Client_ID\",\n    \"Buffer Size\": 0,\n    \"Username\": \"MQTT_Device_Username\",\n    \"Password\": \"MQTT_Device_Password\",\n    \"CA Cert Filename\": \"ThingspeakCA.cer\",\n    \"Channels\" : \"BME68x=2613826, BME68x [x77]=2613825\"\n  }\n</code></pre> <p>If users configure the DataLogger IoT to always include the device address with the device names (i.e. /Settings/Application Settings with Device Names=1), you will need to match the device names for BME688 and BME680 that were loaded on startup as <code>BME68x [x76]</code> and <code>BME68x [x77]</code>, respectively. Note the BME688 device name included a space and <code>[x76]</code> in this case. Remember, we are only interested in plotting hte BME688 and BME680 in this case so we will ignore the MAX17048 that was loaded on startup.</p> <p>DataLogger IoT Device Names Loaded during Startup</p> <p></p> <p>Device Name and Channel for Both Sensors with Respective Addresses</p> <p></p> <p>Again, the alternative to using the menu system is the JSON file. In this case, we updated channels for the BME688 and BME680. We also included the address name for the BME688 like the configuration menu. Not shown are the ThingSpeak Client Name, Username, and Password.</p> <pre><code>\"ThingSpeak MQTT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"mqtt3.thingspeak.com\",\n    \"MQTT Topic\": \"\",\n    \"Client Name\": \"MQTT_Device_Client_ID\",\n    \"Buffer Size\": 0,\n    \"Username\": \"MQTT_Device_Username\",\n    \"Password\": \"MQTT_Device_Password\",\n    \"CA Cert Filename\": \"ThingspeakCA.cer\",\n    \"Channels\" : \"BME68x [x76]=2613826, BME68x [x77]=2613825\"\n    }\n</code></pre> <p>Save the configuration to persistent memory and exit out of the configuration menu. Wait a few seconds for the DataLogger IoT to read the sensors and output the readings to the Serial Terminal. Open ThingSpeak channels in separate browser windows. In this case, we had the BME688 and the BME680 in private view. You should see sensor readings update and plot on the charts.</p> <p>ThingSpeak Graphing the BME688 and BME680 in Seperate Channels on Two Browser Windows</p> <p></p>"},{"location":"single_page/#creating-and-connecting-to-an-azure-iot-device","title":"Creating and Connecting to an Azure IoT Device","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers. This document outlines how an Azure IoT device is used by the DataLogger IoT.</p> <p>The following is covered by this document:</p> <ul> <li>Device creation Azure</li> <li>Securely connecting the device</li> <li>How data is posted from the DataLogger IoT to the Azure Device</li> </ul> <p>Currently, the Azure IoT device connection is a single direction - it is used to post data from the hardware to the Azure IoT Device. Configuration information from Azure IoT to the DataLogger IoT is currently not implemented.</p>"},{"location":"single_page/#general-operation_4","title":"General Operation","text":"<p>Azure IoT enables connectivity between an IoT / Edge device and the Azure Cloud Platform, implementing secure endpoints and device models within the Azure infrastructure. This infrastructure allows edge devices to post updates, status and state to the Azure infrastructure for analytics, monitoring and reporting.</p> <p>In Azure IoT, an virtual representation of an actual device is created and referred to as a Device. The virtual device is allocated a connection endpoint, security certificates and a device digital twin - a JSON document used to persist, communicate and manage device state within Azure. Unlike AWS IoT, data from the device isn't posted to the devices digital twin (AWS Shadow), but to the device directly.</p> <p>The actual IoT device communicates with it's Azure representation via a secure MQTT connection, posting JSON document payloads to a set of pre-defined topics. Updates are posted directly to the Azure device, which is then accessed within Azure for further process as defined by the users particular cloud implementation.</p> <p></p>"},{"location":"single_page/#creating-a-device-in-azure-iot","title":"Creating a Device in Azure IoT","text":"<p>The following discussion outlines the basic steps taken to create a Device in Azure IoT that the DataLogger IoT can connect to. First step is to log into your Azure account and create an IoT Hub for your device.</p> <p>Once logged into your Microsoft Azure account, select Internet of Things &gt; IoT Hub from the menu of services.</p> <p></p>"},{"location":"single_page/#create-an-iot-hub","title":"Create an IoT Hub","text":"<p>This IoT Hub page lists all the IoT hubs available for your account. To add a device, you need to create a new IoT Hub.</p> <p>Follow the Hub Creation workflow - key settings used for a DataLogger demo device:</p> <ul> <li>Used the \"Free Tier\" for testing and development.</li> <li>Networking</li> <li>Connectivity - Public Access</li> <li>Minimum TLS Version - 1.0</li> </ul> <p>The remaining settings were set at their default values.</p>"},{"location":"single_page/#create-a-device","title":"Create a Device","text":"<p>Once the IoT Hub is created, a Device needs to be created within the hub. The device represents the connection to the actual DataLogger IoT device.</p> <p>To create a device, select the Device management &gt; Devices from the IoT Hub menu and the select the + Add Device menu item</p> <p></p> <p>In the create device dialog:</p> <ul> <li>Enter a name for the device</li> <li>Select an Authentication type of Symmetric key</li> <li>Auto-generate keys enabled</li> </ul> <p></p> <p>Once created, the device is listed in the Devices list of the IoT Hub. Selecting the device gives you the device ID and keys used to communicate with the device. Note, when connecting to the device with the DataLogger IoT, the Primary Key value is used.</p> <p></p>"},{"location":"single_page/#azure-configuration","title":"Azure Configuration","text":"<p>Once the DataLogger IoT is integrated into the application, the specifics for the Azure IoT Thing must be configured. This includes the following:</p> <ul> <li>Server Name/Hostname</li> <li>Device Key</li> <li>Device ID</li> <li>CA Certificate Chain</li> </ul>"},{"location":"single_page/#server-namehostname_2","title":"Server Name/Hostname","text":"<p>This value is hostname of the created IoT Hub and is obtained from the Overview page of the IoT Hub. Note a secure connection is used, so the port for the connection is <code>8883</code>.</p> <p></p>"},{"location":"single_page/#device-id","title":"Device ID","text":"<p>The Device ID is obtained from the device detail page. This page is accessible via the Device listing page, which is accessed via the Device management &gt; Devices menu item. The selected device of interest (TestDevice2023 for this example) provides the device ID and Primary Key.</p> <p></p>"},{"location":"single_page/#device-primary-key","title":"Device Primary Key","text":"<p>This is obtained via the Device details page, as outlined in the previous section.</p> <p>You view and copy the key via the icons on the right of the key entry line.</p>"},{"location":"single_page/#root-certificate-authority-ca-file","title":"Root Certificate Authority - CA file","text":"<p>The Certificate Authority file for Azure is downloaded from this page:</p> <p></p> <p>The file to download is the Baltimore CyberTrust Root entry in the Root Certificate Authorities section of the page.</p> <p></p>"},{"location":"single_page/#setting-properties_2","title":"Setting Properties","text":"<p>The above property values must be set on the DataLogger IoT before use. They can be set manually by using the menu system like the previous MQTT example.</p> <p>For users that are interested in using the menu system, you will need to open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then type <code>13</code> to enter the Azure IoT Menu. When the menu system for the Azure IoT connection is presented, you will need to configure the property values as listed in the JSON file. Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The alternative to using the menu system is a JSON file. These values can be set using a JSON file that is loaded by the system at startup. For the example outlined in this document, the entries in the settings JSON file are as follows:</p> <pre><code>\"Azure IoT\": {\n    \"Enabled\": true,\n    \"Port\": 8883,\n    \"Server\": \"sparkfun-datalogger-hub.azure-devices.net\",\n    \"MQTT Topic\": \"\",\n    \"Client Name\": \"\",\n    \"Buffer Size\": 0,\n    \"Username\": \"\",\n    \"Password\": \"\",\n    \"Device Key\" : \"My-Super-Secret-Device-Key\",\n    \"Device ID\"  : \"TestDevice2023\",\n    \"CA Cert Filename\": \"AzureRootCA.pem\"\n  },\n</code></pre> <p>Besides updating the <code>Server</code>, <code>Device Key</code>, <code>Device ID</code>, and <code>CA Cert Filename</code>, you will need to also ensure that the <code>port</code> is set to <code>8883</code>. The default in previous firmware versions was <code>1883</code>. As of firmware v01.00.04, the default is <code>8883</code>. You will need to adjust the port value to properly connect to the Azure IoT service. Don't forget to enable Azure IoT service by setting the value to <code>true</code>. If the JSON file is saved in the microSD card, you can load the credentials to the DataLogger IoT.</p> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the Azure IoT as well.</p>"},{"location":"single_page/#operation-and-monitoring","title":"Operation and Monitoring","text":"<p>Once the DataLogger IoT device is configured and running, the Azure IoT capability in the DataLogger IoT posts messages via MQTT to the connected Azure Device via it's IoT Hub. Messages to the device are posted as Telemetry Data for the device.</p> <p>The easiest method to view the Telemetry data being sent to an Azure Iot Device is via the Azure IoT Hub extension for the Visual Studio Code editor.</p> <p></p> <p>Once installed, and connected to Azure via the Azure Account extension, you can connect to the target IoT Hub, and monitor telemetry data for a IoT device.</p>"},{"location":"single_page/#connect-to-your-azure-iot-hub","title":"Connect to Your Azure IoT Hub","text":"<p>On the Explorer panel of Visual Studio Code, click on the ... menu of the AZURE IOT HUB section. In the popup menu, select the Select IoT Hub menu entry.</p> <p></p> <p>The available IoT Hubs are displayed in the editors command prompt. Select the desired hub and press <code>Enter</code> (or click).</p> <p></p>"},{"location":"single_page/#select-iot-hub","title":"Select IoT Hub","text":"<p>The hub is then displayed in the AZURE IOT HUB section of the editor Explorer. Expanding the Devices section of the Hub will list the example device created above.</p> <p></p>"},{"location":"single_page/#monitoring","title":"Monitoring","text":"<p>To monitor the telemetry data send to a device, right click on the device, TestDevice2023 in this example, select the menu entry Start Monitoring Build-in Event Endpoint.</p> <p></p> <p>Once selected, the editor output console will start displaying output for the selected device. For the above example, with a device that has environmental sensors attached, the output appears as follows:</p> <p></p> <p>To stop monitoring, click the Stop Monitoring build-in event endpoint item that is displayed in the status bar of the editor.</p> <p></p> <p>A menu option to stop monitoring is also available from the ... menu of the AZURE IOT HUB section in the editor Explorer panel.</p>"},{"location":"single_page/#connecting-and-sending-output-to-an-http-server","title":"Connecting and Sending Output to an HTTP Server","text":"<p>One of the key features of the DataLogger IoT is it's simplified access to IoT service providers and servers. This document outlines how output from a DataLogger IoT device is sent to an HTTP server.</p> <p>The following is covered by this document:</p> <ul> <li>Overview of the HTTP connection</li> <li>How a user configures and uses the HTTP connection</li> <li>Use examples</li> </ul>"},{"location":"single_page/#general-operation_5","title":"General Operation","text":"<p>HTTP connectivity allows data generated by the DataLogger IoT to be sent to an HTTP server. An HTTP endpoint is provided to the HTTP action within the DataLogger IoT, and when data is output, a JSON representation of the data is published to the endpoint via an HTTP POST operation. The body of the POST operation contains the a JSON document that encapsulates the sent DataLogger IoT data.</p> <p></p>"},{"location":"single_page/#data-structure_2","title":"Data Structure","text":"<p>Data is sent to the HTTP server as a JSON object, which contains a collection of sub-object. Each sub-object represents a data source in the sensor, and contains the current readings from that source.</p> <p>The following is an example of the data posted - note, this representation was \"pretty printed\" for readability.</p> <pre><code>{\n  \"MAX17048\": {\n    \"Voltage (V)\": 4.304999828,\n    \"State Of Charge (%)\": 115.0625,\n    \"Change Rate (%/hr)\": 0\n  },\n  \"CCS811\": {\n    \"CO2\": 620,\n    \"VOC\": 33\n  },\n  \"BME280\": {\n    \"Humidity\": 25.03613281,\n    \"TemperatureF\": 79.64599609,\n    \"TemperatureC\": 26.46999931,\n    \"Pressure\": 85280.23438,\n    \"AltitudeM\": 1430.44104,\n    \"AltitudeF\": 4693.04834\n  },\n  \"ISM330\": {\n    \"Accel X (milli-g)\": -53.31399918,\n    \"Accel Y (milli-g)\": -34.03800201,\n    \"Accel Z (milli-g)\": 1017.236023,\n    \"Gyro X (milli-dps)\": 542.5,\n    \"Gyro Y (milli-dps)\": -1120,\n    \"Gyro Z (milli-dps)\": 262.5,\n    \"Temperature (C)\": 26\n  },\n  \"MMC5983\": {\n    \"X Field (Gauss)\": -0.200622559,\n    \"Y Field (Gauss)\": 0.076416016,\n    \"Z Field (Gauss)\": 0.447570801,\n    \"Temperature (C)\": 29\n  }\n}\n</code></pre>"},{"location":"single_page/#http-connection-setup","title":"HTTP Connection Setup","text":"<p>To connect to an HTTP server endpoint, the following information is needed:</p> <ul> <li>The URL of the endpoint</li> <li>The SSL certificate for the target server, if the connection is secure (HTTPS)</li> </ul> <p>These values are set using the standard DataLogger methods - the interactive menu system, or a JSON file.</p>"},{"location":"single_page/#menu-system","title":"Menu System","text":"<p>For users that are interested in using the menu system, you will need to open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then enter the HTTP IoT Menu. When the menu system for the HTTP IoT connection is presented, you will need to configure the property values as listed in the JSON file. Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The options are:</p> <ul> <li>Enable/Disable the connection</li> <li>Set the URL for the endpoint</li> <li>Set the name of the CA Cert file for a secure connection (HTTP)</li> </ul> <p>To set the HTTP URL/endpoint - select two (2) in the menu, and enter the URL. For this example, we'll enter: <code>http://mysparkfunexample.com:8091</code>.</p> <p></p> <p>In the above example, the URL/HTTP Endpoint is on a server called <code>mysparkfunexample.com</code>, on port <code>8091</code>. Once set, the system will post data to this URL.</p> <p>If the endpoint is a secure ssl (HTTPS) connection, the certificate for the server is required. Because of the size of the certificates, the value is provided as a file that is loaded into the system by the attached SD card.</p> <p></p> <p>The above example show providing a certificate filename of <code>example.cer</code>.</p> <p>Once all these values are set, the system will post data to the specified HTTP endpoint, following the JSON information structure noted earlier in this document.</p>"},{"location":"single_page/#json-file-entries_1","title":"JSON File Entries","text":"<p>If a JSON file is being used as an option to import settings into the DataLogger IoT, the following entries are used for the HTTP IoT connection:</p> <pre><code>\"HTTP IoT\": {\n    \"Enabled\": false,\n    \"URL\": \"&lt;the URL&gt;\",\n    \"CA Cert Filename\": \"&lt;certificate filename&gt;\"\n  }\n</code></pre> <p>Where:</p> <ul> <li><code>Enabled</code> - Set to <code>true</code> to enable the connection.</li> <li><code>URL</code> - Set to the URL for the connection.</li> <li><code>CA Cert Filename</code> - Set to the cert filename on the SD card if being used.</li> </ul> <p>If the JSON file is saved in the microSD card, you can load the credentials to the DataLogger IoT.</p> <p>Tip</p> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the HTTP IoT as well.</p>"},{"location":"single_page/#example-connecting-to-a-http-server","title":"Example - Connecting to a HTTP Server","text":"<p>In this example, a simple HTTP Server is creating using Node JS, and the HTTP connection in the DataLogger IoT is used to post data to this server. The received data is output to the console from there server.</p>"},{"location":"single_page/#the-server","title":"The Server","text":"<p>The following javascript/node code creates a HTTP server on port <code>8090</code>, and outputs received data to the console.</p> <pre><code>var http = require('http');\n\n// Setup the endpoint server\nvar myServer = http.createServer(function (req, res) {\n\n  // Initialize our body string\n  var body=\"\";\n\n  // on data callback, append chunk to our body string\n  req.on('data', function(chunk){\n body += chunk;\n  });\n\n  // On end callback, output the body to the console\n  req.on('end', function(){\n    // parse json string, then stringify it back for 'pretty printing'\n    console.log(\"payload: \" + JSON.stringify(JSON.parse(body),null,2));\n  });\n\n  // send a reply\n  res.writeHead(200, {'Content-Type': 'text/plain'});\n  res.end('n');\n  // Just listen on our port\n}).listen(8090);\n</code></pre> <p>The setup and use of node js is system dependant is beyond the scope of this document. However, Node JS is easily installed with your systems package manager (<code>brew</code> on macOS, Linux distribution package manager (apt, yum, ...etc), on Windows, the WSL is recommended).</p> <p>Once Node is setup, the above server is run via the following command (assuming the implementation is in a file called <code>simple_http.js</code>):</p> <pre><code>node ./simple_http.js\n</code></pre> <p>As data is sent by the DataLogger IoT, the following is output to the console from the server:</p> <p></p>"},{"location":"single_page/#obtaining-a-sites-security-certificate","title":"Obtaining a Sites Security Certificate","text":"<p>Accessing a sites SSL/Secure Certificate is done via a web browser. The method for each browser is different. The following example uses Edge, which is similar to the operation in Chrome.</p> <p>First, browse to the desired site/server. Click the Secure/Security area/button next to the URL to bring up the security detail page. On this page, select the Connection is secure menu option</p> <p></p> <p>Next, on the page shown, select the certificate button on the upper right of the dialog.</p> <p></p> <p>When you select this button, the certificate details dialog is displayed. On this page, select the Details tab, and select the Export... button on the lower right of the dialog. This will save the sites SSL/Security certificate to a location you specify.</p> <p></p> <p>Once saved, place this file on the SD card your system/DataLogger is using, and set the filename in the HTTP connection menu or settings JSON file.</p>"},{"location":"single_page/#creating-and-connecting-to-an-arduino-cloud-device","title":"Creating and Connecting to an Arduino Cloud Device","text":"<p>One of the key features of the SparkFun DataLogger IoT is it's simplified access to IoT service providers. This document outlines how an Arduino Cloud Device is used by the DataLogger IoT.</p> <p>The following is covered by this document:</p> <ul> <li>Structure of the Arduino Cloud Devices</li> <li>Device creation in the Arduino Cloud</li> <li>Setup of the Arduino Driver</li> <li>How data is posted from the DataLogger IoT to the Arduino Device</li> </ul> <p>Currently, the Arduino Cloud device connection is a single direction - used to post data from the DataLogger IoT to an Arduino Cloud device.</p> <p>NOTE To take advantage of the API's in Arduino Cloud, you will also need to have a service plan with your account.</p>"},{"location":"single_page/#general-operation_6","title":"General Operation","text":"<p>The Arduino Cloud enables connectivity between an IoT/Edge Arduino enabled device and the cloud. The edge device updates data in the Arduino Cloud by updating <code>variables</code> or parameters attached to a cloud device.</p> <p>In the Arduino Cloud, the edge device is represented by a Device which has a virtual Thing attached/associated with it. The Thing acts as a container for a list of parameters or variables which represent the data values received from the edge device. As values on the edge device update, they are transmitted to the Arduino Cloud.</p> <p>For a SparkFun DataLogger IoT connected to an Arduino Cloud device, the output parameters of a device connected to the DataLogger are mapped to variables within the Arduino Cloud Device's Thing using a simple pattern of DeviceName_ParameterName for the name of the variable in the Arduino Cloud.</p> <p></p>"},{"location":"single_page/#creating-a-device-in-arduino-cloud","title":"Creating a Device in Arduino Cloud","text":"<p>The first step connecting to the Arduino Cloud is setting up a device within the cloud. A device is a logical element that represents a physical device.</p> <p>Log into your Arduino Cloud account.</p> <p>Click on the expand menu icon on the upper left (e.g. the three lines stacked like a \"hamburger\"; \u2630) and select  Devices. If your window is big enough, then it will show up on the navigation bar.</p> <p></p> <p>This page lists your currently defined devices. If there are no defined devices, select the Add Device button. This will probably be at the bottom of the page. The location of this button will change once the page has a device (or if there is an update to Arduino's user interface).</p> <p></p> <p>A device type selection dialog is then shown. Since we are connecting a DataLogger IoT board to the system, and not connected a known device, select DIY - Any Device to manually include the DataLogger IoT.</p> <p></p> <p>Once selected, another dialog is presented. Just select Continue. At this point you can provide a name for your device. In this case we named it as \"MyDataLoggerIoT.\"</p> <p></p> <p>The next screen is the critical step of the device creation process. This step is the one time the Device Secret Key is available. The provided <code>Device ID</code> and Device <code>Secret Key</code> values are needed to connect to the Arduino Cloud. Once this step is completed, the Secret Key is no longer available.</p> <p></p> <p>The easiest way to capture these values is by downloading as a PDF file, which is offered on the setup page. Click on the download the PDF and save it to a safe location. When ready, click on the check box indicating that you have saved the values and select the Continue button.</p>"},{"location":"single_page/#arduino-cloud-api-keys","title":"Arduino Cloud API Keys","text":"<p>In addition to creating a device, to access the Arduino Cloud, the driver requires an API Key. This allows the DataLogger IoT's Arduino Cloud driver to access the web API of the Arduino Cloud. This API is used to setup the connection to the Arduino Cloud.</p> <p>To create an API key, click on the menu bar to expand and select your  Arduino account profile &gt; Personal Settings.</p> <p></p> <p>This menu takes you to a list of existing API Keys. If you have not created one yet, the list will have nothing in it like the image below. From this page, select the CREATE API KEY button.</p> <p></p> <p>NOTE Users will need a service plan in order to take advantage of the API.</p> <p>In the presented dialog, enter a name for the API key. In this case, we named it \"MyDataLoggerKey\".</p> <p></p> <p>Once the name is entered, click CONTINUE. A page with the new API key is presented. Like in Device Creation, this page contains a secret that is only available on this page during this process.</p> <p></p> <p>Make note of the Client ID and Client Secret values on this page. The best method to capture these values is to download the PDF file offered on this page. Click on the download the PDF and save it to a safe location. When ready, click on the check box indicating that you have saved the values and select the DONE button.</p> <p>At this point, the Arduino Cloud is setup for connection by the driver.</p>"},{"location":"single_page/#arduino-cloud-configuration","title":"Arduino Cloud Configuration","text":"<p>To add an Arduino Cloud Device as a destination DataLogger IoT, the Arduino Cloud connection is enabled via the DataLogger menu system and the connection values, obtained from the Arduino Cloud (see above), are set in the connection properties.</p> <p>The specifics for the Arduino Cloud must be configured. This includes the following:</p> <ul> <li>Thing Name</li> <li>Thing ID</li> <li>API Client ID</li> <li>API Secret</li> <li>Device Secret</li> <li>Device ID</li> </ul> <p>NOTE The Thing Name does not necessarily need to be configured. However, there will be less confusion if you set this up before connecting the DataLogger IoT to the Cloud. The Thing ID will automatically be generated and saved once there is a connection available.</p>"},{"location":"single_page/#thing-name","title":"Thing Name","text":"<p>The name of the Arduino Cloud <code>Thing</code> to use. If the Thing doesn't exist on startup, the driver will create a Thing and be named \"Untitled\" if you do not provide a name.</p> <p>NOTE Note satisfied with the default \"Untitled\" as the Thing's name? You can rename the Thing Name after creating the Thing. Note that you will need to manually rename the Thing Name on the Arduino Cloud and DataLogger IoT.</p>"},{"location":"single_page/#thing-id","title":"Thing ID","text":"<p>This is the ID of the Thing being used. This value is obtained by the following methods:</p> <ul> <li>If the driver creates a new Thing, the ID is obtained and used.</li> <li>If an existing Thing is connected to the DataLogger IoT, the driver retrieves it's ID.</li> <li>In this case, the driver cannot create any new variables until the system is restarted.</li> <li>The user creates a new Thing using the web interface of Arduino Cloud, and provides the Thing Name and Thing ID .</li> </ul>"},{"location":"single_page/#api-client-id-and-secret","title":"API Client ID and Secret","text":"<p>These values are used to provide API access by the driver. This access allows for the creation/use of a Thing and Variables within the Arduino Cloud. These are obtained via the steps outlined earlier in this document.</p>"},{"location":"single_page/#device-secret-and-id","title":"Device Secret and ID","text":"<p>These values are used to identify the Arduino device that is connected to. These are obtained via the steps outlined earlier in this document.</p>"},{"location":"single_page/#setting-properties_3","title":"Setting Properties","text":"<p>The above property values must be set in the DataLogger's Arduino Cloud driver before use. They can be manually by using the menu system like the previous MQTT example.</p> <p>For users that are interested in using the menu system, open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type ```1```` to enter the Settings menu. Then select the Arduino IoT Menu. When the menu system for the Arduino IoT is presented, you will need to configure the property values as listed in the JSON file. Saving the values through the menu system will save the credentials to the ESP32's persistent memory. The following options are displayed:</p> <p></p> <p>The alternative to using the menu system is a JSON file. These values can be set using a JSON file that is loaded by the system at startup. For the DataLogger Arduino Cloud example outlined in this document, the entries in the setting's JSON file are as follows:</p> <pre><code>\"Arduino IoT\": {\n    \"Enabled\": true,\n    \"Thing Name\": \"SparkFunThing1\",\n    \"API Client ID\": \"MY_API_ID\",\n    \"API Secret\": \"MY_API_SECRET\",\n    \"Device Secret\": \"MY_DEVICE_SECRET\",\n    \"Device ID\": \"MY_DEVICE_ID\"            \n  },\n</code></pre> <p>You will need to update the <code>API Client ID</code>, <code>API Secret</code>, <code>Device Secret</code>, and <code>Device ID</code> with the values that were obtained earlier. Don't forget to enable Arduino Cloud service by setting the value to <code>true</code>. If the JSON file is saved in the microSD card, you will need to load the credentials to the DataLogger IoT.</p> <p>TIP To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the Arduino IoT as well.</p>"},{"location":"single_page/#operation_1","title":"Operation","text":"<p>On startup, when the first values are written from the DataLogger IoT, the connection to the Arduino Cloud is made. During this connection, the system connects to the specified Thing and variables are mapped between the DataLogger Device values and Arduino Cloud Variables. If needed, variables can be created manually in the cloud.</p> <p>While this initial setup takes seconds to complete, updates to the values on the Arduino Cloud are rapid as soon as there is a connection available.</p>"},{"location":"single_page/#viewing-values","title":"Viewing Values","text":"<p>Once the DataLogger IoT device is configured and running, updates in Arduino Cloud are listed in the Things tab of the Arduino Cloud page. Clicking the target Thing provides access to the current variable values that are connected to the DataLogger IoT. Your mileage may vary depending on the compatible device that is connected to the DataLogger IoT. In this case, we were able to see the built-in sensors that were connected on the DataLogger IoT - 9DoF.</p> <p></p> <p>Having problems connecting new variables with the DataLogger IoT? When swapping out compatible Qwiic enabled devices, you may need to delete previous cloud variables so that the DataLogger IoT is able re-initialize them on the next power cycle.</p>"},{"location":"single_page/#create-a-dashboard","title":"Create a Dashboard","text":"<p>With the data now available in the Arduino Cloud as variables, it is a simple step create a dashboard that plots the data values.</p> <p>The general steps to create a simple dashboard include:</p> <ul> <li>Select the Dashboards section of the Arduino Cloud.</li> <li>Select the Build Dashboard button. If you have a dashboard already built, the location of the button will change and the button will be renamed: Create.</li> <li>Click the edit button (i.e. the icon that looks like a paper and pencil, this is next to the eye).</li> <li>Add an element to the dashboard -- for this example select ADD ^ &gt; Advanced Chart.</li> <li>On the Chart's Widget Settings select Link Variables to add readings.  </li> <li>The DataLogger IoT Variables are listed - select the variable to link.</li> <li>Continue this step until all the desired variables are linked to the chart. You can select up to 5x variables at a time. Click on the Link Variables button after selecting the variables.</li> <li>This will bring you back to the Chart's Widget Settings window. Configure any preferences that to display (i.e. variable colors, labels, etc.). When all variables are linked and the Chart Widget Settings is configured, select Done.</li> </ul> <p></p> <p>The created dashboard then displays the values posted from the SparkFun DataLogger IoT. You can continue adding additional readings on the dashboard that you were not able to fit on graph or even rename the Dashboard view. In this case, we displayed accelerometer values and temperature in degrees Celsius from the DataLogger IoT - 9DoF.</p> <p></p> <p>Not seeing any values on the LIVE view? Try clicking on the other time periods to see the values posted.</p> <p>Using compatible Qwiic enabled devices, you can also display additional readings that are not available with the built-in sensors. In this case, we were able to display humidity, temperature in degrees Fahrenheit, equivalent CO2, TVOC, and AQI with the DataLogger IoT and Environmental Combo Breakout (ENS160/BME280).</p> <p></p>"},{"location":"single_page/#the-datalogger-iot-web-server","title":"The DataLogger IoT Web Server","text":"<p>As of firmware v01.02.00, log files can be viewed and downloaded over a WiFi network! This saves you time by allowing you to download the files without the need to disconnect the DataLogger IoT and manually remove microSD card.</p> <p>The following is covered by this document:</p> <ul> <li>How a user configures and uses the HTTP connection</li> <li>Use examples</li> </ul>"},{"location":"single_page/#iot-web-server-connection-setup","title":"IoT Web Server Connection Setup","text":"<p>To connect to the ESP32's IoT Web Server, the following information is needed:</p> <ul> <li>The server name/address</li> <li>[optional] A username - if required</li> <li>[optional] A password - if required</li> </ul>"},{"location":"single_page/#iot-web-server-menu-system","title":"IoT Web Server Menu System","text":"<p>We'll need to adjust the settings for the IoT Web Server.</p> <p>For users that are interested in using the menu system, open a Serial Terminal, connect to the COM port that your DataLogger enumerated to, and set it to 115200 baud. In this case, we connected to COM13. Press any key to enter the Main Menu. Type <code>1</code> to enter the Settings menu. Then select the IoT Web Server Menu. When the menu system for the IoT Web Server is presented, the following options are displayed:</p> <p></p> <p>The options are:</p> <ul> <li>Enable/Disable the connection</li> <li>Username</li> <li>Password</li> <li>Enable/Disable mDNS support</li> <li>mDNS name</li> </ul> <p>At a minimum, you will just need to enable the connection. However, we recommend enabling mDNS support if it is supported in your network.</p> <p>Once all these values are set, the system will serve the log files in your local 2.4GHz WiFi network following the JSON information structure noted below in this document.</p>"},{"location":"single_page/#json-file-entries_2","title":"JSON File Entries","text":"<p>If a JSON file is being used as an option to import settings into the DataLogger IoT, the following entries are used for the IoT web server:</p> <pre><code>\"IoT Web Server\": {\n  \"Enabled\": false,\n  \"Username\": \"\",\n  \"Password\": \"\",\n  \"mDNS Support\": false,\n  \"mDNS Name\": \"dataloggerAD6B8\"\n},\n</code></pre> <p>Where:</p> <ul> <li><code>Enabled</code> - Set to <code>true</code> to enable the connection.</li> <li><code>Username</code> - Web server user name if being used.</li> <li><code>Password</code> - Web server password if being used.</li> <li><code>mDNS Support</code> - Set to <code>true</code> if multicast DNS is supported. This allows you to enter the address as \"<code>http://dataloggerXXXXX.local</code>\" (where <code>XXXXX</code> is generated from the last 5x characters from your board ID) rather than typing the exact IP address of the ESP32.</li> <li><code>mDNS Name</code> - Multicast DNS name. In this case, the default name was set to <code>dataloggerAD6B8</code>. This name will be different depending on your DataLogger IoT's board ID so <code>AD6B8</code> will be different for your board.</li> </ul> <p>To load the values by the system at startup using a JSON file and microSD card, you will need to configure the Save Settings. This JSON file will be created with the \"Save to Fallback\" option. Make sure to enable the MQTT Client as well.</p>"},{"location":"single_page/#connect-and-download-log-file","title":"Connect and Download Log File","text":"<p>To use this feature, ou will need to make sure that the ESP32 is on the same network as your computer in order to access the log files. Addionally, when authentication is enabled, some browsers might require a second login depending on user settings.</p>"},{"location":"single_page/#using-a-local-server-name","title":"Using a local server name","text":"<p>Once the web server is enabled and the settings are saved, you will need to reboot the DataLogger IoT. As the DatLogger initializes, it will connect to your WiFi Network. Take note of the mDNS address, in this case, it was \"<code>http://dataloggerAD6B8.local</code>\".</p> <p></p> <p>Once the DataLogger IoT has finished initializing, open web browser. Connect the DataLogger IoT by entering the address \"<code>http://dataloggerXXXXX.local</code>\", where <code>XXXX</code> is the last 5x characters of your board ID. You will be presented with the log files available on the microSD card. Click on a log file to download and save it to your computer.</p> <p></p>"},{"location":"single_page/#using-the-datalogger-iot-ip-address","title":"Using the DataLogger IoT IP Address","text":"<p>If mDNS is not supported on your network, you can also enter the IP address of the Datalogger IoT into a web browser to view and download the log files. You can view the IP address when the DataLogger IoT is initializing. If you have administrative privileges to the WiFi Network, you can also view the IP address through your  WiFi router as well.</p> <p></p> <p>Now that you have downloaded the log files, try graphing the data on a spreadsheet!</p>"},{"location":"single_page/#system-update","title":"System Update","text":"<p>This sections outline methods to update the firmware on the DataLoggerIoT.</p> <p>When this menu item is selected, the following menu is presented:</p> <p></p> <p>System Update Menu</p> <p>The following functionality is available from this menu:</p>"},{"location":"single_page/#functions_4","title":"Functions","text":""},{"location":"single_page/#device-restart","title":"Device Restart","text":"<p>This option is used to restart the device. When selected, the user is prompted to validate the selection. If <code>Y</code> is entered, the device is restarted.</p>"},{"location":"single_page/#factory-reset","title":"Factory Reset","text":"<p>A factory reset will move the boot firmware of the device to the firmware imaged installed at the factory and erase any on-board stored settings on the device. This is helpful if an update fails, or an update has issues that prevent proper operations.</p> <p>When selected, the user is presented a prompt to continue. To launch a factory reset, the value of <code>Y</code> should be entered. To abort the update, enter <code>n</code> or press the <code>Esc</code> key.</p> <p></p> <p>When a <code>Y</code> is entered, the system performs the following:</p> <ul> <li>Set the boot image to the Factory installed firmware</li> <li>Erase any settings stored in the on-board flash memory</li> <li>Reboot the device</li> </ul> <p></p> <p>Once complete, the DataLoggerIoT is running the original firmware it shipped with. To update to a later version, the <code>Firmware Update</code> options of this menu are used.</p>"},{"location":"single_page/#update-firmware-sd-card","title":"Update Firmware - SD Card","text":"<p>This action enables the ability to update the onboard firmware to an image file contained an SD card. This user is presented a list of available firmware images files contained in root directory of the on-board SD card, and updates the board to the selected file.</p> <p>To download the latest firmware and update through the microSD card, you will need to head to the GitHub repository containing the firmware. Select the firmware version and download.</p> <p>Once downloaded, insert the microSD card into a card reader or USB adapter. Then move the files into the memory card's root directory. Below shows an image of v01.00.01 and v01.00.02 on a Windows OS.</p> <p></p> <p>Once the files are copied to the memory card, eject the microSD card from your computer. Insert the card back into the DataLogger IoT's microSD card socket. Connect the DataLogger IoT to your computer using a USB cable and bring up the DataLoggerIoT menu system and navigate to the <code>System Update</code> options.</p> <p>To update from the SD card, select the <code>Update Firmware - SD Card</code> entry. The system will now list available firmware versions to update to.</p> <p></p> <p>Available Firmware Images on the SD Card</p> <p>The system will search the root directory of the on-board SD card for available firmware files. The firmware files are selected using the following criteria:</p> <ul> <li>The file is contained in the root \"/\" folder of the SD card.</li> <li>The filename has a \".bin\" extension.</li> <li>The filename starts with a specified name prefix. The prefix is optional and is set by the developers at SparkFun using this action.</li> </ul> <p>Once a file is selected, the system new firmware is read off the SD card and written to the device. When complete, the system is restarted using the new firmware image.</p> <p></p> <p>Firmware Updating from SD Card</p>"},{"location":"single_page/#update-firmware-ota","title":"Update Firmware - OTA","text":"<p>This action enables the ability to update the onboard firmware to an image file contained on an update server, which is accessed via the WiFi network the system is connected to. This Over-The-Air (OTA) capability contacts the systems update server and searches for newer firmware (later version) for the specific board.</p> <p>When this option is selected, the system will contact the update server and search for available upgrade firmware, selecting the latest version available. If a newer version is found, a prompt is presented to confirm the upgrade.</p> <p></p> <p>NOTE For the upgrade option to occur, a the system must be connected to a network and have access to the firmware OTA server.</p> <p>Typing <code>Y</code> (or hitting enter) starts the update operation. As the firmware is downloaded, the percent complete status is updated. If connectivity fails during the download, the operation is halted and the update aborted.</p> <p></p> <p>Once the update file is downloaded, it is verified as being the correct file. Once verified, the system is rebooted and starts using the new firmware image. You will notice the firmware version change as the DataLogger IoT initializes.</p> <p></p>"},{"location":"single_page/#if-the-firmware-is-overwritten-by-an-arduino-sketch","title":"If the Firmware is overwritten by an Arduino Sketch","text":"<p>Flashing an Arduino sketch to a DataLogger IoT board removes the ability for easy firmware updates and will require a full low-level flash of the latest software, which includes the bootloader and partition map for the device. These files are now provided as part of the DataLogger IoT firmware updates.</p> <p>To perform this level of update, please view the Build and Update Instructions</p>"},{"location":"single_page/#microsd-card-setup","title":"MicroSD Card Setup","text":"<p>Not all microSD cards are created equal. The capacity, read/write speed, and format vary depending on the manufacturer. In order to log data to the microSD card, you will need to ensure that your memory card is formatted as FAT32. You can also use FAT16. If the memory card is formatted as a different memory card, the DataLogger IoT will not be able to recognize the microSD card.</p>"},{"location":"single_page/#checking-microsd-card-format","title":"Checking MicroSD Card Format","text":"<p>While you can simply insert the microSD card into your DataLogger IoT and start logging, there may be a chance that the it will not recognize the memory card due to the format.</p>"},{"location":"single_page/#checking-microsd-card-format-windows","title":"Checking MicroSD Card Format - Windows","text":"<p>To check to see if it is the correct format on a Windows you could head to the drive, right click, and select Properties.</p> <p></p> <p>SD Card Properties Menu Entry on Windows</p> <p>Once the properties are open, you should be able to tell what file system that the memory card uses. In this case, it was exFAT which is not compatible with the DataLogger IoT. You will need to reformat the memory card since it is not formatted as FAT32.</p> <p></p> <p>Format of exFat - Not Compatable</p> <p>The format should be <code>FAT32</code></p> <p></p> <p>FAT32 Format - Compatable with the DataLogger IoT</p>"},{"location":"single_page/#checking-microsd-card-format-macos","title":"Checking MicroSD Card Format - macOS","text":"<p>To check to see if it is the correct format on a macOS, you could head to the drive on your desktop. Then right click, and select Get Info.</p> <p></p> <p>\"Get Info\" on MacOS</p> <p>A window will pop up indicating the microSD card properties. Under General: &gt; Format:, you should be able to tell what file system that the memory card uses. In this case, it was exFAT which is not compatible with the DataLogger IoT. You will need to reformat the memory card since it is not formatted as FAT32.</p> <p></p> <p>Showing Format as exFat</p> <p>To reformat the drive, the built in <code>Disk Utility</code> application on macOS can be used. Once the SD Card is reformatted, the <code>Get Info</code> dialog will show:</p> <p></p> <p>FAT32 Format on macOS</p>"},{"location":"single_page/#download-raspberry-pi-imager","title":"Download Raspberry Pi Imager","text":"<p>There are a few methods and programs available to reformat your microSD card as a FAT32. We found it easier to use the Raspberry Pi Imager Tool. Of course, you will only be using the tool to erase the contents of the microSD card and formatting it as a FAT32 system. You will not actually flash any image to the memory card. Click on the button below to download the tool from the Raspberry Pi Foundation. It is supported on Windows, macOS, and Ubuntu for x86.</p>"},{"location":"single_page/#formatting-as-fat32-using-the-raspberry-pi-imager","title":"Formatting as FAT32 using the Raspberry Pi Imager","text":"<p>After downloading and installing the software, open the Raspberry Pi Imager.</p> <p></p> <p>Raspberry Pi Imager</p> <p>Under \"Operating System\", select \"Erase\" to \"format card as FAT32.\"</p> <p></p> <p>Select 'ERASE' for Operating System</p> <p>Under \"Storage\", select the drive that the microSD card appeared as on your computer.</p> <p></p> <p>Storage is the SD Card</p> <p>When ready, select \"Write\". After a few minutes, the microSD card should be formatted with FAT32.</p> <p></p> <p>Writing/Reformatting the SD Card</p> <p>Once the memory card has finished formatting, eject the microSD from your computer. To check to see if the microSD card is formatted as FAT32, you can check its properties as explained earlier with your operating system.</p>"},{"location":"single_page/#serial-terminals","title":"Serial Terminals","text":"<p>The key to the setup and interactive operation of the  the SparkFun DataLoggerIoT is a modern, interactive Serial Terminal program. Keyboard input and text output are required to be immdiate, to support the interactive menu system of the IoT DataLoggerIoT. Luckily a majority of serial terminal support interactive use. The notible exeception is the build in Arduino IDE Serial Monitor, which requires text to be entered and \"submitted\" or sent to the device. The Arduino Serial Monitor is not supported for interactive use by the DataLoggerIoT</p>"},{"location":"single_page/#common-serial-terminal-softwareapplications","title":"Common Serial Terminal Software/Applications","text":"<p>There are plenty of free Serial Terminals out there to configure the DataLogger IoT.</p> <ul> <li>Minicom (Linux/Unix, MacOS)</li> <li>Screen (Linux/Unix, MacOS)</li> <li>Tera Term (Windows)</li> <li>RealTerm (Windows)</li> </ul> <p>Note</p> <p>A serial terminal client that supports edit characters is required. Most if not all modern serial terminal programs will have the ability to support interactive edits. We have tested the DataLogger IoT with the Tera Term application, <code>minicom</code> command, and the <code>screen</code> command.</p> <p>If this is the your first time using a terminal window, We recommend checking out the Serial Terminal Basics tutortial.</p> <p>The above guides will show you how to open the correct port for the DataLogger IoT and how to set the baud rate to 115200 baud. You can change the DataLogger IoT's baud rate through the configuration menus too should you need to.</p> <p>Arduino IDE Serial Monitor -  Not Recommended</p> <p>The Arduino IDE Serial Monitor is not intented for interacive user and should not be used with the DataLogger IoT. For users with an Arduino IDE, you could also use the Arduino Serial Monitor by setting the line ending to Newline. Users will also need to <code>CTRL</code> + <code>Enter</code> when sending any character to the DataLogger IoT. However, we recommend using one of the terminals mentioned earlier.</p>"},{"location":"single_page/#software-documentents-and-posts","title":"Software, Documentents and Posts","text":""},{"location":"single_page/#datalogger-iot-9dof","title":"DataLogger IoT - 9DoF","text":"<ul> <li>Schematic (PDF)</li> <li>Eagle Files (ZIP)</li> <li>Board Dimensions (PNG)</li> <li>Fritzing Part (FZPZ)</li> </ul>"},{"location":"single_page/#datalogger-iot","title":"DataLogger IoT","text":"<ul> <li>Schematic (PDF)</li> <li>Eagle Files (ZIP)</li> <li>Board Dimensions (PNG)</li> <li>Fritzing Part (FZPZ)</li> </ul>"},{"location":"single_page/#software","title":"Software","text":"<ul> <li>CH340 Drivers</li> <li>Firmware</li> </ul>"},{"location":"single_page/#github-hardware-repo","title":"GitHub Hardware Repo","text":"<ul> <li>SparkFun DataLogger IoT - 9DoF</li> <li>SparkFun DataLogger IoT</li> </ul>"},{"location":"single_page/#sfe-showcase","title":"SFE Showcase","text":"<ul> <li>DataLogger IoT - 9DoF</li> <li>DataLogger IoT</li> </ul>"},{"location":"single_page/#blog-posts","title":"Blog Posts","text":"<ul> <li>IoT Platforms and Protocols</li> <li>Send Sensor Data to AWS All In Under 15 Minutes</li> <li>Extending the Reach of Data Logging</li> </ul>"},{"location":"single_page/#datalogger-iot-supported-devices","title":"DataLogger IoT Supported Devices","text":"<p>The following lists the devices/boards supported by the DataLogger IoT boards. New drivers to support a device will be listed under the firmware version.</p>"},{"location":"single_page/#version-150","title":"Version 1.5.0","text":"<ul> <li>SparkFun Air Quality PM1/PM2.5/PM10 Sensor - BMV080 (Qwiic)</li> <li>SparkFun Spectral Sensor - AS7343 (Qwiic)</li> <li>SparkFun Soil Moisture Sensor - NON-qwiic version</li> <li>Log Analog Device/GPIO pin values</li> <li>Log text input from a Serial/UART Input device</li> </ul>"},{"location":"single_page/#version-110","title":"Version 1.1.0","text":"<ul> <li>SparkFun Indoor Air Quality Sensor - ENS160 (Qwiic)</li> <li>SparkFun Photoacoustic Spectroscopy CO2 Sensor - PASCO2V01 (Qwiic)</li> <li>SparkFun Human Presence and Motion Sensor - STHS34PF80 (Qwiic)</li> <li>SparkFun Tristimulus Color Sensor - OPT4048DTSR</li> <li>SparkFun Triad Spectroscopy Sensor - AS7265x</li> </ul>"},{"location":"single_page/#version-100","title":"Version 1.0.0","text":"<ul> <li>ACS37800 Power Meter</li> <li>SparkFun Qwiic 12 Bit ADC - 4 Channel (ADS1015)</li> <li>Qwiic PT100 - ADS122C04</li> <li>Qwiic Humidity AHT20</li> <li>SparkFun Grid-EYE Infrared Array Breakout - AMG8833 (Qwiic)</li> <li>SparkFun Pulse Oximeter and Heart Rate Sensor - MAX30101 &amp; MAX32664 (Qwiic)</li> <li>SparkFun Atmospheric Sensor Breakout - BME280 (Qwiic)</li> <li>SparkFun Environmental Combo Breakout - CCS811/BME280 (Qwiic)</li> <li>SparkFun Environmental Sensor Breakout - BME680 (Qwiic)</li> <li>SparkFun Environmental Sensor - BME688 (Qwiic)</li> <li>SparkFun Pressure Sensor - BMP384 (Qwiic)</li> <li>SparkFun Pressure Sensor - BMP581 (Qwiic)</li> <li>SparkFun Qwiic Button</li> <li>SparkFun Air Velocity Sensor Breakout - FS3000-1015 (Qwiic)</li> <li>SparkFun Air Velocity Sensor Breakout - FS3000-1005 (Qwiic)</li> <li>SparkFun GPS-RTK2 Board - ZED-F9P (Qwiic)</li> <li>SparkFun GPS-RTK-SMA Breakout - ZED-F9P (Qwiic)</li> <li>SparkFun GPS-RTK Board - NEO-M8P-2 (Qwiic)</li> <li>SparkFun GPS Breakout - Chip Antenna, SAM-M8Q (Qwiic)</li> <li>SparkFun GPS Breakout - NEO-M9N, Chip Antenna (Qwiic)</li> <li>SparkFun GPS Breakout - ZOE-M8Q (Qwiic)</li> <li>SparkFun 6DoF IMU Breakout - ISM330DHCX (Qwiic) and on-board SPI 9DOF</li> <li>SparkFun 9DoF IMU Breakout - ISM330DHCX, MMC5983MA (Qwiic)</li> <li>Qwiic Pressure Sensor - LPS25HB</li> <li>Qwiic Fuel Gauge - MAX17048</li> <li>SparkFun Qwiic Thermocouple Amplifier - MCP9600 (PCC Connector)</li> <li>SparkFun Qwiic Thermocouple Amplifier - MCP9600 (Screw Terminals)</li> <li>SparkFun Qwiic MicroPressure Sensor</li> <li>SparkFun Micro Magnetometer - MMC5983MA (Qwiic) and on-board SPI 9DOF</li> <li>Pressure Sensor (Qwiic) - MS5637</li> <li>Qwiic Pressure/Humidity/Temp (PHT) Sensor - MS8607</li> <li>SparkFun Qwiic Scale - NAU7802</li> <li>SparkFun Real Time Clock Module - RV-8803 (Qwiic)</li> <li>CO\u2082 Humidity and Temperature Sensor - SCD30</li> <li>CO\u2082 Humidity and Temperature Sensor - SCD40 (Qwiic)</li> <li>SparkX Differential Pressure Sensor - SDP31 (Qwiic)</li> <li>Particle, VOC, Humidity, and Temperature Sensor - SEN54</li> <li>SparkFun Air Quality Sensor - SGP30 (Qwiic)</li> <li>SparkFun Air Quality Sensor - SGP40 (Qwiic)</li> <li>SparkFun Humidity Sensor Breakout - SHTC3 (Qwiic)</li> <li>SparkFun Qwiic Dynamic NFC/RFID Tag</li> <li>CO\u2082 Sensor - STC31 (Qwiic)</li> <li>SparkFun Qwiic dToF Imager - TMF8821</li> <li>SparkFun Qwiic dToF Imager - TMF8820</li> <li>SparkFun High Precision Temperature Sensor - TMP117 (Qwiic)</li> <li>SparkFun Qwiic Twist - RGB Rotary Encoder Breakout</li> <li>SparkFun Proximity Sensor Breakout - 20cm, VCNL4040 (Qwiic)</li> <li>SparkFun UV Light Sensor Breakout - VEML6075 (Qwiic)</li> <li>Ambient Light Sensor - VEML7700 (Qwiic)</li> <li>SparkFun Distance Sensor Breakout - 4 Meter, VL53L1X (Qwiic)</li> <li>SparkFun Qwiic ToF Imager - VL53L5CX</li> </ul>"},{"location":"single_page/#release-notes","title":"Release Notes","text":""},{"location":"single_page/#sparkfun-datalogger-iot-firmware-version-15","title":"SparkFun DataLogger IoT Firmware - Version 1.5","text":"<p>January 2026</p>"},{"location":"single_page/#new-features-and-enhancements","title":"New Features and Enhancements","text":""},{"location":"single_page/#new-device-support","title":"New Device Support","text":"<p>Support for the following new SparkFun qwiic devices</p> <ul> <li>SparkFun Air Quality PM1/PM2.5/PM10 Sensor - BMV080 (Qwiic)</li> <li>SparkFun Spectral Sensor - AS7343 (Qwiic)</li> </ul>"},{"location":"single_page/#uart-data-logging","title":"UART Data Logging","text":"<p>Connect an external uart/serial device to the DataLogger IoT board and any input recieved from that device is output within the current logging stream (Serial console, SD Card, IoT endpoint ...)</p>"},{"location":"single_page/#log-values-from-an-analog-pin","title":"Log Values from an Analog Pin","text":"<p>Connect an anlog device/sensor to a specified DataLogger GPIO pin and the data value is written to the current log stream/output.</p>"},{"location":"single_page/#support-for-the-sparkfun-analog-soil-mosture-sensor","title":"Support for the SparkFun Analog Soil Mosture Sensor","text":"<p>Connect the SparkFun Soil Moisture Sensor to the specified/selected (via menu system) GPIO pins of the DataLogger IoT board and the senor values are output to the output log stream.</p> <p>Note - the qwiic Soil Moisture Sensor is not supported by the DataLogger IoT due to I2C bus incompatablity (i2c clock stretching)</p>"},{"location":"single_page/#trigger-logging-via-interrupt","title":"Trigger Logging via Interrupt","text":"<p>When enabled, with an interrupt connected to a specified (in the menu system) DataLogger IoT GPIO pin, a logging event is triggered when the interrupt is fired.</p>"},{"location":"single_page/#trigger-logging-using-the-pps-signal-from-a-gnss-device","title":"Trigger Logging using the PPS signal from a GNSS device","text":"<p>When enabld and the GNSS device PPS signal is connected to a specified GPIO pin on the DataLogger IoT, a logging event is triggered when the PPS signal is sent.</p>"},{"location":"single_page/#general-improvements","title":"General Improvements","text":"<ul> <li>Fixed issues with the ISO8601 date formatting in the logging system</li> <li>Improved support for verbose logging via the menu system</li> <li>Fixed issue with epoch tick output values</li> <li>Can now add the log-event trigger source to the log-stream output.</li> </ul> <p>And this new functionality is available today at the DataLogger repo as a beta release.  The update is free, available as a file uploaded via an SD Card.  Just select the \u201cSystem Update\u201d option within the DataLogger IoT menu system and select your desired upgrade option.</p>"},{"location":"single_page/#sparkfun-datalogger-iot-firmware-version-12","title":"SparkFun DataLogger IoT Firmware - Version 1.2","text":"<p>April 15th, 2024</p> <p>With the release of our version 1.2 software for our DataLogger IoT products, we continue to add additional functionally to the products capability, as well as fix a number of issues.</p> <p>And with the release, we feel we\u2019ve covered all aspects of a 1.1 release \u2013 new functionality, feature enhancements, and a wide variety of bug fixes.  </p>"},{"location":"single_page/#new-features-and-enhancements_1","title":"New Features and Enhancements","text":""},{"location":"single_page/#log-file-download-via-a-web-interface","title":"Log File Download via a Web Interface","text":"<p>To allow access to log files located on the DataLogger IoT device, without requiring the removal of the SD card, a new Web Interface is provided. Once enabled, you can browse the on-board log files of the DataLogger. Clicking on a a filename will download the file.</p> <p></p> <p>Currently file browse and download options are available, but we plan on expanding this feature in the future.</p> <p>Additionally, this feature has the following options:</p> <ul> <li>mDNS functionality allowing you to set a network name for a device if mDNS is supported on your network</li> <li>Username/Password authentication for the web interface.</li> </ul> <p>Note: For authentication use - currently some browsers might require a second login depending on settings.</p> <p>Note</p> <p>The datalogger requires restarting if the web interface is enabled</p> <p>This feature is enabled in settings under the Preview heading.</p>"},{"location":"single_page/#startup-command-menu-and-delay","title":"Startup Command Menu and Delay","text":"<p>To allow start-up time configuration and delay, a Startup Menu was added to the system. Now, at startup a short menu is presented for a brief period, allowing modification of the startup options of the DataLogger.</p> <p>Startup Menu options:</p> <p>Pressing the highlighted letter while the menu is active, will change the behavior of the system. This change only affects the current system session.</p> <p>The options include:</p> <ul> <li>'n' - Normal startup</li> <li>'a' - Disable I2C device auto load on startup</li> <li>'l' - List the I2C devices supported. This device table is discarded after auto-load</li> <li>'w' - Disable WiFi</li> <li>'s' - Disable preference restore during startup</li> </ul> <p>In addition, the amount of time the menu is displayed is adjustable.  This settings is on the Settings/Application Settings page, under the Advanced section.</p>"},{"location":"single_page/#quick-commands_1","title":"Quick (!) Commands","text":"<p>The addition of a quick (!) command system that allows for the direct execution of commands directly from the serial console, bypassing the serial menu system.</p> <p>An example of this is the display of the \"about\" page for the system. Normally this would require navigating the serial menu system. With the quick command system, entering the value of \"!about\" at the serial console will display the about page.</p> <p>The following commands are supported:</p> Command Description !about Display the system about page !clear-settings Clear the on board system preferences with a yes/no prompt !clear-settings-forced Clear the on board system preferences with no prompt !devices List the currently connected devices !factory-reset Perform a factory reset - presents a Y/N prompt !heap Display the current system heap memory usage !help List the available quick commands !json-settings For setting the device settings via a serial connection. When this command is sent, the system expects to receive a JSON settings file !log-now Perform a log observation event !log-rate If log rate measurement is enabled, the current log rate is printed !reset-device Reset the device - erasing any saved settings and restarting the device !reset-device-forced Reset the device, but without a Y/N prompt !restart Restart the device !restart-forced Restart the device without a Y/N prompt !save-settings Save the current settings to on-board flash !sdcard Output the current SD card usage statistics !systime Output current system time !uptime The uptime of the device !device-id The ID for the device !version The version of the firmware !wifi Output current system WiFi state"},{"location":"single_page/#log-data-rate","title":"Log Data Rate","text":"<p>The DataLogger system can now measure the data logging rate. Once this feature is enabled, the system will monitor the time between log events. This value is averaged over the latest 10 log events.</p>"},{"location":"single_page/#system-info-in-the-log-stream","title":"System Info in the log stream","text":"<p>The system operational parameters can now be added to log stream. This is useful to monitor system resource uses over time, or just perform general debugging.</p> <p>Currently the following information is provided:</p> <ul> <li>WiFi SSID</li> <li>WiFi RSSI</li> <li>Memory Heap free space in bytes</li> <li>SD Card free space in bytes</li> <li>Uptime in MS</li> </ul>"},{"location":"single_page/#feature-improvements","title":"Feature Improvements","text":"<p>In addition to the new functionality, we also took input from our customers (and our own use) to expand and enhance existing features. While a wide variety of small additions were made, a few notable additions include:</p> <p>Serial Console - Value Display \u2013 The serial console now shows the current setting value in the menu system. Previously this value was only show once that item was selected.</p> <p>Serial Console Color \u2013 Text highlighting and color were added to the serial console output. If your serial console application/command supports it, the menu system highlights key values. This setting is controlled in the Settings/Application Settings section of the settings menu.</p> <p>Startup Messages \u2013 Normally a verbose log of startup options and settings are displayed at system startup. The about of information is now controllable - with values of Normal, Compact, Disabled.</p> <p>Improved Device Auto-Load \u2013 A major update to the I2C auto-load device detection logic that improves device detection and address collision prevention.</p> <p>General System Enhancements \u2013 Internal system job dispatch subsystem update to increase performance throughput. Overall decrease in static and dynamic memory usage.</p>"},{"location":"single_page/#bug-fixes","title":"Bug Fixes","text":"<p>We also squashed a variety of defects in the firmware. Some of the more notable issued fixed in this release:</p> <ul> <li>Fixed issue with the LED display logic that caused a system crash if the log interval was less than 100ms</li> <li>Incorporate driver updates for greater NAU7802 device output value stability</li> <li>Incorporate driver update for the MMC5983MA device</li> </ul>"},{"location":"single_page/#in-summary","title":"In Summary","text":"<p>With the release of DataLogger IoT firmware version 1.2.0 we continue to enhance the capabilities of our DataLogger IoT line \u2013 adding to our IOT service, supported devices as well as improving the overall quality of the system.</p> <p>And this new functionality is available today at the DataLogger repo.  The update is free, available as an over-the-air upgrade, or as a file uploaded via an SD Card.  Just select the \u201cSystem Update\u201d option within the DataLogger IoT menu system and select your desired upgrade option.</p>"},{"location":"single_page/#sparkfun-datalogger-iot-firmware-version-11","title":"SparkFun DataLogger Iot Firmware - Version 1.1","text":"<p>November 11th, 2023</p> <p>Today we\u2019re releasing the latest firmware update for our line of DataLogger IoT products. While we\u2019ve released a services of small defect correct releases over the base 6 months, this release, officially version v1.01.00, is the first to include major new functionality.</p> <p>And with the release, we feel we\u2019ve covered all aspects of a 1.1 release \u2013 new functionality, feature enhancements, and a wide variety of bug fixes.  </p>"},{"location":"single_page/#new-feature-arduino-iot-cloud-connectivity","title":"New Feature \u2013 Arduino IoT Cloud Connectivity","text":"<p>Being an IoT focused product, one of our goals is to enable easy access to leading IoT data services. With this in mind, for this release we worked closely with the Arduino Team to enabled easy access to the Arduino IoT Cloud directly from a DataLogger IoT Device.</p> <p>Setup a device in the Arduino IoT Cloud, add the credentials to your DataLogger IoT and you have a IoT based dashboard up and running in minutes. Want to add an additional device to your dashboard \u2013 add the device to the DataLogger IoT and the combined system automatically adds the additional data to the Arduino Cloud \u2013 ready for use in your dashboard.</p> <p></p> <p>The above image shows data from a DataLogger IoT with an Environmental Combo attached to it and mapping data to a plot graphic on an Arduino IoT Cloud dashboard.</p> <p>And like all DataLogger IoT functionality, no programming is required to produces these plots \u2013 all settings are provided via the intuitive serial console menu interface or set via a settings JSON file.</p> <p>With the combination of the DataLogger IoT, qwiic and Arduino IoT Cloud, creating a IoT dashboard is as easy as Plug-in, Connect, Plot!</p>"},{"location":"single_page/#new-qwiic-sensor-board-support","title":"New qwiic Sensor Board Support","text":"<p>The original release of the DataLogger IoT firmware supported around 50 SparkFun qwiic development boards and with this release we\u2019ve added six boards additional qwiic boards.</p> <p>Selecting from our recently added qwiic products as well as from the list of popular products, the release of version 1.1 adds support for the following qwiic development boards.</p> <ul> <li>SparkFun Indoor Air Quality Sensor - ENS160</li> <li>SparkFun Photoacoustic Spectroscopy CO2 Sensor - PASCO2V01</li> <li>SparkFun Human Presence and Motion Sensor - STHS34PF80</li> <li>SparkFun Tristimulus Color Sensor - OPT4048DTSR</li> <li>SparkFun Triad Spectroscopy Sensor - AS7265x</li> <li>SparkFun 6DoF IMU Breakout - BMI270</li> </ul> <p>Like previously supported qwiic boards, the DataLogger IoT firmware automatically detects when a device is connected, making the new device automatically available to the logging, menu and IoT systems of the DataLogger IoT.</p> <p>All these new sensors are great adds on their own, but the ENS160 has the additional feature of supporting temperature and humidity calibration inputs. Connect an BME280 or an SHTC3 qwiic board along with an ENS160, and the DataLogger automatically connects the two devices!</p>"},{"location":"single_page/#feature-improvements_1","title":"Feature Improvements","text":"<p>In addition to the new functionality, we also took input from our customers (and our own use) to expand and enhance existing features. While a wide variety of small additions were made, a few notable additions include:</p> <p>Improved Reference Clock Management \u2013 the internal logic was reviewed and improved. Additionally, time zone support was moved out of the NTP system, and into the overall clock management subsystem.</p> <p>Internal JSON Buffer Limits \u2013 The initial firmware had fixed sizes for the internal JSON data buffers used for saving settings and log data output. These values are now user settable in the settings menu. This allows for larger buffer support, as well as reducing the internal buffers to what you need.</p> <p>Add Device IDs to the Device Names \u2013 As you add more devices to a DataLogger, it\u2019s difficult to match the device to the actual devices address. Addresses are now included in device listings and the option to include the address in the device name is now available.</p> <p>Board Information in the Log Stream \u2013 To improve identification of a data source within the data log stream, the Board Name and Board ID can now be added if desired. As part of this functionality, a configurable name is now available for each DataLogger IoT.</p>"},{"location":"single_page/#bug-fixes_1","title":"Bug Fixes","text":"<p>We also squashed a variety of defects in the firmware. Some of the more notable issued fixed in this release:</p> <ul> <li>Incorporated a fix in the RV8803 RTC Clock Arduino Library that resolved force ti*  shifts based on time zone. This was a \u201creal nasty one\u201d to resolve!</li> <li>Improved runtime memory (ram) consumption</li> <li>Resolved issues with devices having the same name. Now the second device adds it*  address to the name.</li> <li>Improvements to the Machinechat IoT driver</li> </ul>"},{"location":"single_page/#in-summary_1","title":"In Summary","text":"<p>With the release of DataLogger IoT firmware version 1.1.0 we continue to enhance the capabilities of our DataLogger IoT line \u2013 adding to our IOT service, supported devices as well as improving the overall quality of the system.</p> <p>And this new functionality is available today at the DataLogger repo.  The update is free, available as an over-the-air upgrade, or as a file uploaded via an SD Card.  Just select the \u201cSystem Update\u201d option within the DataLogger IoT menu system and select your desired upgrade option.</p>"},{"location":"single_page/#suggested-reading","title":"Suggested Reading","text":"<ul> <li>If you aren't familiar with the Qwiic system, we recommend reading here for an overview.</li> <li>Accelerometer Basics</li> <li>Gyroscopes</li> <li>Qwiic 9DoF - ISM330DHCX, MMC5983MA Hookup Guide</li> <li>Serial Terminal Basics</li> <li>I2C Communication</li> <li>Single Cell LiPo Battery Care</li> </ul>"},{"location":"single_page/#troubleshooting-and-support","title":"Troubleshooting and Support","text":""},{"location":"single_page/#support","title":"Support","text":"<p>If you need technical assistance and more information on a product that is not working as you expected, visit the SparkFun Community. The community forums are monitored by the SparkFun Technical Support Team and the SparkFun community as a whole.</p>"},{"location":"single_page/#issues-connecting-to-iot-service","title":"Issues Connecting to IoT Service","text":"<p>Having trouble connecting your DataLogger IoT to an IoT service? Make sure to check your credentials and ensure that the configuration matches the IoT Service (such as your WiFi network, port, server, topic, certificates, keys, etc. to name a few). Make sure to also include the associated certificates and keys in the microSD card as well. You may see an output similar to the following errors below.</p>"},{"location":"single_page/#aws-iot-error","title":"AWS IoT Error","text":"<p>The following error occurred when the DataLogger IoT was initializing with AWS.</p> <pre><code>[W] AWS IoT disconnected - reconnecting.......[E] AWS IoT: MQTT connection failed. Error Code: -2\n</code></pre> <p></p> <p>In this case, the DataLogger IoT failed to connect to AWS IoT service because the port was using the default value that was saved: <code>1883</code>. Ensure that the port is set to <code>8883</code> for your IoT service (e.g. AWS IoT, Azure, and ThingSpeak) and saved in persistent memory in order for the DataLogger IoT to successfully connect. As of firmware v01.00.04, the default is <code>8883</code>.</p>"},{"location":"single_page/#thinkspeak-iot-error","title":"ThinkSpeak IoT Error","text":"<p>The following error occurred when the DataLogger IoT was initializing with ThingSpeak.</p> <pre><code>[I] ThingSpeak MQTT: connecting to MQTT endpoint mqtt3.thingspeak.com:8883 .......[E] ThingSpeak MQTT: Connection Error [4]\n</code></pre> <p></p> <p>In this case, the DataLogger IoT failed to connect to ThingSpeak service because the credentials were entered incorrectly. Ensure that the  and saved in persistent memory in order for the DataLogger IoT to successfully connect.</p>"},{"location":"single_page/#arduino-cloud-error-1","title":"Arduino Cloud Error 1","text":"<p>The following error was occurred when the DataLogger IoT was initializing with Arduino Cloud.</p> <pre><code>[W] ArduinoIoT - Thing Name not provided\n.\n.\n.\n[I] Arduino IoT: setup variables...[E] ArduinoIoT HTTP communication error [401] - token request\n[E] Arduino IoT Cloud not available or account credentials incorrect\n</code></pre> <p></p> <p>In this case, the DataLogger IoT failed to connect to the Arduino Cloud service because the credentials were incorrect. Ensure that the credentials (i.e. API client ID, API secret, device secret, device ID) are entered correctly and saved in persistent memory in order for the DataLogger IoT to successfully connect.</p>"},{"location":"single_page/#arduino-cloud-error-2","title":"Arduino Cloud Error 2","text":"<p>The following error was occurred when the DataLogger IoT was initializing with Arduino Cloud.</p> <pre><code>[I] Arduino IoT: setup variables...[E] Arduino IoT: return code=400, failed to decode request body with content type \"application/json\": uuid: incorrect UUID length 37 in string \"a111aaa1-1111-1111-1a1a-1a11111a1111\\r\"\n</code></pre> <p>In this case, the DataLogger IoT failed to connect to the Arduino Cloud service because the credentials were incorrect. The string was supposed to be the device ID. When copying and pasting the device ID from a PDF that was generated with the Arduino Cloud, a carriage return (<code>\\r</code>) was also copied and entered in the serial terminal. By pasting the device ID into a text editor and then re-copying/pasting it into the serial terminal helped to ensure that the credentials were entered correctly.</p> <p>NOTE The device ID in this example was a randomly generated string. You will need to check to make sure that your device matches the one that the Arduino Cloud generated specifically for your account.</p>"},{"location":"single_page/#arduino-cloud-error-3","title":"Arduino Cloud Error 3","text":"<p>The following error was occurred when the DataLogger IoT was initializing with Arduino Cloud.</p> <pre><code>[I] Arduino IoT: setup variables...ArduinoIoTCloudTCP::handle_ConnectMqttBroker could not connect to mqtts-up.iot.arduino.cc:8884\nArduinoIoTCloudTCP::handle_ConnectMqttBroker 1 connection attempt at tick time 301939\nArduinoIoTCloudTCP::handle_ConnectMqttBroker could not connect to mqtts-up.iot.arduino.cc:8884\nArduinoIoTCloudTCP::handle_ConnectMqttBroker 2 connection attempt at tick time 307420\n[E] Arduino IoT: No Arduino Thing ID provided. Enter ID, delete Thing (SparkFunThing1) on Cloud, or enter new Thing Name.\n</code></pre> <p>In this case, the DataLogger IoT failed to connect to the Arduino Cloud service because there was already a Thing that was created. By deleting the Thing in the Arduino Cloud, the DataLogger IoT was able to automatically create another Thing and setup the variables.</p>"},{"location":"single_page/#thingspeak-data-points-not-updating","title":"ThingSpeak Data Points Not Updating","text":"<p>If your DataLogger IoT is connected to ThingSpeak but you do not see any data, ensure that the device name matches the Qwiic device that is connect to the DataLogger IoT. For example, the DataLogger IoT and Qwiic-enabled ENS160 was able to connect to ThingSpeak as shown in the following image:</p> <p></p> <p>However, there were no data points in any of the graphs as shown on ThingSpeak:</p> <p></p> <p>If you head back into the configuration menu for the DataLogger's ThingSpeak channel, make sure that the <code>&lt;device name&gt;</code> matches the connected Qwiic device's name that was shown during initialization.  In this case, the device that was loaded and detected was ENS160. Then add the channel ID before saving the system settings.</p> <p></p> <p>NOTE Only one device can be loaded per channel! ThingSpeak is not able graph two different devices in the same channel.</p> <p>Head back to your ThingSpeak Channel to verify that data is being plotted on the graphs.</p> <p></p>"},{"location":"single_page/#u-blox-device-disappears-when-iot-datalogger-initializes","title":"U-Blox Device Disappears when IoT DataLogger Initializes","text":"<p>If you have issues where a u-blox device that is connected via qwiic fails to connect a second time when the IoT DataLogger initializes, this is due to a bug in the firmware from an initial release. You may see an output similar to the following message and image shown below.</p> <pre><code>[W] GNSS::isConnected no traffic seen (first attempt)\n</code></pre> <p></p> <p>If you see the following output and the IoT DataLogger not loading your u-blox device, you will need to update the firmware to v01.00.03 and above. For more information, make sure to check out the tutorial on updating your IoT DataLogger's firmware.</p>"},{"location":"single_page/#submitting-an-issue-or-suggestion","title":"Submitting an Issue or Suggestion","text":""},{"location":"single_page/#support_1","title":"Support","text":"<p>If you need technical assistance and more information on a product that is not working as you expected, visit the SparkFun Community. The community forums are monitored by the SparkFun Technical Support Team and the SparkFun community as a whole.</p>"},{"location":"single_page/#existing-issue","title":"Existing Issue","text":"<p>Spot something wrong? Please check the list of reported and fixed issues  .  in this repository.</p>"},{"location":"single_page/#discrepancies-in-the-documentation","title":"Discrepancies in the Documentation","text":"<p>All of this documentation can be modified by you! Please help us make it better.</p> <ul> <li>The documentation files for these pages are contained in the <code>docs</code> folder of the SparkFun DataLogger IoT repository.</li> </ul>"},{"location":"single_page/#spot-something-wrong","title":"Spot something wrong?","text":"<p>If a section of the documentation is incorrect, please open an issue and let us know.</p>"},{"location":"single_page/#do-you-have-a-suggested-correction","title":"Do you have a suggested correction?","text":"<ol> <li>With a GitHub account, fork this repo</li> <li>Add your correction(s) or improvement(s) to the markdown file(s)</li> <li>File a pull request with your changes, and enjoy making the words worlds world a better place.<ul> <li>Once received, the documentation specialist will automatically be notified.</li> <li>We will review your suggested improvement(s) to make sure they are correct and fit within our documentation standards.</li> </ul> </li> </ol>"},{"location":"single_page/#problems-in-the-hardware-design","title":"Problems in the Hardware Design","text":"<p>All of our designs are open-source! Please help us make it better.</p> <ul> <li>Our board design files are contained in the <code>Hardware</code> folder of the SparkFun DataLogger IoT repository.</li> </ul>"},{"location":"single_page/#does-something-not-make-sense","title":"Does something not make sense?","text":"<p>If part of the design is confusing, please open an issue and let us know.</p>"},{"location":"single_page/#did-we-forget-to-include-an-important-function-of-the-board","title":"Did we forget to include an important function of the board?","text":"<p>Please keep in mind that we may intentionally exclude certain functions of the board to meet our product design requirements.</p> <p>If part of the board's functionality is missing, please open an issue and file a feature request.</p>"},{"location":"single_page/#do-you-wish-to-contribute-directly-to-improving-the-board-design","title":"Do you wish to contribute directly to improving the board design?","text":"<ol> <li>With a GitHub account, Fork this repo</li> <li>Add your design improvement(s)</li> <li>File a pull request with your changes, and enjoy making the words worlds world a better place.<ul> <li>Once received, the engineer in charge of the original design will automatically be notified.</li> <li>We will review your suggested improvement(s), if they are within our board design standards and meet our product design requirements, we will flag these changes for our next board revision. (Please note, that even if your suggestion is accepted, these changes may not be immediate. We may have to cycle through our current product inventory first.)</li> </ul> </li> </ol>"},{"location":"single_page/#contribute","title":"Contribute","text":""},{"location":"single_page/#improve-our-documentation","title":"Improve our Documentation","text":"<p>All of this documentation can be modified by you! Please help us make it better.</p> <ul> <li>These pages are contained in the <code>docs</code> folder of the SparkFun DataLogger IoT repository.</li> </ul>"},{"location":"single_page/#submit-a-correction","title":"Submit a Correction","text":"<ol> <li>Fork this repo</li> <li>Add your corrections or improvements to the markdown file</li> <li>File a pull request with your changes, and enjoy making the words worlds world a better place.<ul> <li>Once received, the documentation specialist will automatically be notified.</li> <li>We will review your suggested improvements to make sure they are correct and fit within our documentation standards.</li> </ul> </li> </ol>"},{"location":"single_page/#improve-our-hardware-design","title":"Improve our Hardware Design","text":"<p>This hardware design is open-source! Please help us make it better.</p> <ul> <li>Our board design files are contained in the <code>Hardware</code> folder of the SparkFun DataLogger IoT repository.</li> </ul>"},{"location":"single_page/#submit-a-design-improvement","title":"Submit a Design Improvement","text":"<ol> <li>Fork this repo</li> <li>Add your design improvements</li> <li>File a pull request with your changes, and enjoy making the words worlds world a better place.<ul> <li>Once received, the engineer in charge of the original design will automatically be notified.</li> <li>We will review your suggested improvements, if they are within our board design standards and meet our product design requirements, we will flag these changes for our next board revision. (Please note, that even if your suggestion is accepted, these changes may not be immediate. We may have to cycle through our current product inventory first.)</li> </ul> </li> </ol>"},{"location":"suggested-reading/","title":"Suggested Reading","text":""},{"location":"suggested-reading/#suggested-reading","title":"Suggested Reading","text":"<ul> <li>If you aren't familiar with the Qwiic system, we recommend reading here for an overview.</li> <li>Accelerometer Basics</li> <li>Gyroscopes</li> <li>Qwiic 9DoF - ISM330DHCX, MMC5983MA Hookup Guide</li> <li>Serial Terminal Basics</li> <li>I2C Communication</li> <li>Single Cell LiPo Battery Care</li> </ul>"},{"location":"supported_devices/","title":"Supported Devices","text":""},{"location":"supported_devices/#datalogger-iot-supported-devices","title":"DataLogger IoT Supported Devices","text":"<p>The following lists the devices/boards supported by the DataLogger IoT boards. New drivers to support a device will be listed under the firmware version.</p>"},{"location":"supported_devices/#version-150","title":"Version 1.5.0","text":"<ul> <li>SparkFun Air Quality PM1/PM2.5/PM10 Sensor - BMV080 (Qwiic)</li> <li>SparkFun Spectral Sensor - AS7343 (Qwiic)</li> <li>SparkFun Soil Moisture Sensor - NON-qwiic version</li> <li>Log Analog Device/GPIO pin values</li> <li>Log text input from a Serial/UART Input device</li> </ul>"},{"location":"supported_devices/#version-110","title":"Version 1.1.0","text":"<ul> <li>SparkFun Indoor Air Quality Sensor - ENS160 (Qwiic)</li> <li>SparkFun Photoacoustic Spectroscopy CO2 Sensor - PASCO2V01 (Qwiic)</li> <li>SparkFun Human Presence and Motion Sensor - STHS34PF80 (Qwiic)</li> <li>SparkFun Tristimulus Color Sensor - OPT4048DTSR</li> <li>SparkFun Triad Spectroscopy Sensor - AS7265x</li> </ul>"},{"location":"supported_devices/#version-100","title":"Version 1.0.0","text":"<ul> <li>ACS37800 Power Meter</li> <li>SparkFun Qwiic 12 Bit ADC - 4 Channel (ADS1015)</li> <li>Qwiic PT100 - ADS122C04</li> <li>Qwiic Humidity AHT20</li> <li>SparkFun Grid-EYE Infrared Array Breakout - AMG8833 (Qwiic)</li> <li>SparkFun Pulse Oximeter and Heart Rate Sensor - MAX30101 &amp; MAX32664 (Qwiic)</li> <li>SparkFun Atmospheric Sensor Breakout - BME280 (Qwiic)</li> <li>SparkFun Environmental Combo Breakout - CCS811/BME280 (Qwiic)</li> <li>SparkFun Environmental Sensor Breakout - BME680 (Qwiic)</li> <li>SparkFun Environmental Sensor - BME688 (Qwiic)</li> <li>SparkFun Pressure Sensor - BMP384 (Qwiic)</li> <li>SparkFun Pressure Sensor - BMP581 (Qwiic)</li> <li>SparkFun Qwiic Button</li> <li>SparkFun Air Velocity Sensor Breakout - FS3000-1015 (Qwiic)</li> <li>SparkFun Air Velocity Sensor Breakout - FS3000-1005 (Qwiic)</li> <li>SparkFun GPS-RTK2 Board - ZED-F9P (Qwiic)</li> <li>SparkFun GPS-RTK-SMA Breakout - ZED-F9P (Qwiic)</li> <li>SparkFun GPS-RTK Board - NEO-M8P-2 (Qwiic)</li> <li>SparkFun GPS Breakout - Chip Antenna, SAM-M8Q (Qwiic)</li> <li>SparkFun GPS Breakout - NEO-M9N, Chip Antenna (Qwiic)</li> <li>SparkFun GPS Breakout - ZOE-M8Q (Qwiic)</li> <li>SparkFun 6DoF IMU Breakout - ISM330DHCX (Qwiic) and on-board SPI 9DOF</li> <li>SparkFun 9DoF IMU Breakout - ISM330DHCX, MMC5983MA (Qwiic)</li> <li>Qwiic Pressure Sensor - LPS25HB</li> <li>Qwiic Fuel Gauge - MAX17048</li> <li>SparkFun Qwiic Thermocouple Amplifier - MCP9600 (PCC Connector)</li> <li>SparkFun Qwiic Thermocouple Amplifier - MCP9600 (Screw Terminals)</li> <li>SparkFun Qwiic MicroPressure Sensor</li> <li>SparkFun Micro Magnetometer - MMC5983MA (Qwiic) and on-board SPI 9DOF</li> <li>Pressure Sensor (Qwiic) - MS5637</li> <li>Qwiic Pressure/Humidity/Temp (PHT) Sensor - MS8607</li> <li>SparkFun Qwiic Scale - NAU7802</li> <li>SparkFun Real Time Clock Module - RV-8803 (Qwiic)</li> <li>CO\u2082 Humidity and Temperature Sensor - SCD30</li> <li>CO\u2082 Humidity and Temperature Sensor - SCD40 (Qwiic)</li> <li>SparkX Differential Pressure Sensor - SDP31 (Qwiic)</li> <li>Particle, VOC, Humidity, and Temperature Sensor - SEN54</li> <li>SparkFun Air Quality Sensor - SGP30 (Qwiic)</li> <li>SparkFun Air Quality Sensor - SGP40 (Qwiic)</li> <li>SparkFun Humidity Sensor Breakout - SHTC3 (Qwiic)</li> <li>SparkFun Qwiic Dynamic NFC/RFID Tag</li> <li>CO\u2082 Sensor - STC31 (Qwiic)</li> <li>SparkFun Qwiic dToF Imager - TMF8821</li> <li>SparkFun Qwiic dToF Imager - TMF8820</li> <li>SparkFun High Precision Temperature Sensor - TMP117 (Qwiic)</li> <li>SparkFun Qwiic Twist - RGB Rotary Encoder Breakout</li> <li>SparkFun Proximity Sensor Breakout - 20cm, VCNL4040 (Qwiic)</li> <li>SparkFun UV Light Sensor Breakout - VEML6075 (Qwiic)</li> <li>Ambient Light Sensor - VEML7700 (Qwiic)</li> <li>SparkFun Distance Sensor Breakout - 4 Meter, VL53L1X (Qwiic)</li> <li>SparkFun Qwiic ToF Imager - VL53L5CX</li> </ul>"},{"location":"system-operation/","title":"Operation Overview","text":"<p>The main interface for the DataLogger IoT is a menuing system accessed via a serial terminal. You can use any interactive serial terminal emulator to quickly and easily change and store the DataLoggerIoT settings via its USB-C interface.</p> <p>Before proceeding - ensure you are using an appropriate Serial Terminal application to communicate with the DataLoggerIoT.</p>"},{"location":"system-operation/#general-operation","title":"General Operation","text":"<p>When connected to a Serial Terminal, the displayed output has the following sequence of events when the DataLoggerIoT is stared:</p> <p>1) Startup Menu - A startup menu is displayed to change operation of the datalogger. 2) System Startup - messages are output as the system initialized and begings operation 3) Logging Output - sent to the Serial Monitor 4) Settings Menu - displayed with the touch of any key 5) Quick Commands - simple commands entered at the console - they start with a <code>!</code></p>"},{"location":"system-operation/#startup-menu","title":"Startup Menu","text":"<p>Connect the DataLogger IoT to a USB cable and connect to your computer. The addressable RGB LED will light up green as it initializes. In the Serial Terminal,  a Startup Menu is presented, which allows you to change the behavior of the DataLogger at start-up. This change only affects the current system session.</p> <p></p> <p>Startup Menu Options</p> <ul> <li>'n' - Normal startup</li> <li>'a' - Disable I2C device auto load on startup</li> <li>'l' - List the I2C devices supported. This device table is discarded after auto-load</li> <li>'w' - Disable WiFi</li> <li>'s' - Disable preference restore during startup</li> </ul> <p>The amount of time the start-up menu is displayed is adjustable. This settings can be configured in the Settings/Application Settings page, under the Advanced section.</p>"},{"location":"system-operation/#system-startup","title":"System Startup","text":"<p>As the system starts up you will see the following output when the board initializes:</p> <p></p> <p>Startup Output Information</p> <p>The messages in the serial terminal provide us with the DataLogger's configuration and will vary depending on the firmware version that is loaded on the board and the boards configuration settings.</p> <p>In general, the output will include the following:</p> <ul> <li>The DataLogger IoT software version</li> <li>As the DataLogger IoT is initializing, the system settings are being restored from the last saved preference.</li> <li>There no WiFi credentials and the board has failed to connect. This output will change once you provide the WiFi credentials and are able to connect to the network.</li> <li>There are 3x devices currently detected and they are connected through I<sup>2</sup>C through the Qwiic port and SPI. These are the on-board sensors for the DataLogger IoT. There may be more devices that are detected depending on the firmware and what is connected to the ports. Since these were recognized, they were loaded onto the DataLogger IoT.</li> <li>The current date and time is shown (by default), the date and time is set to 1-1-1970 and 00:00:00). This value will change depending on the clock source through NTP, RTC, or a u-blox GNSS module.</li> <li>The time the board has been running will be shown in the uptime.</li> <li>The primary external time source that the board syncs is currently through the NTP client. This can be configured depending on your clock source.</li> <li>The board name</li> <li>The board ID</li> <li>The microSD card has been found, the type of memory card it is, the size of the memory card, how much memory is used, and how much is available.</li> <li>If there is a WiFi network name saved, the SSID will be shown along with information indicating whether the board was able to connect to the WiFi network. By default there is no SSID saved in memory.</li> <li>If there is a battery connected, the LiPo Battery Fuel Guage will indicate if there is one attached to the board.</li> <li>Parameters for low power mode will be provided indicating if deep sleep is enabled, sleep interval, and wake interval.</li> <li>Parameters for logging are also provided for the logging interval, the format for the serial output, format for the microSD card, current saved filename, and file rotation period.</li> <li>The board will also show the available IoT services that are enabled for the DataLogger IoT.</li> <li>Current settings to download log files via a web interface (included in firmware v01.02.00)</li> <li>Supported devices through Qwiic or SPI will be listed if they are connected.</li> <li>The output will finish by telling you what devices are connected to the DataLogger IoT again.</li> </ul> <p>As of firmware v01.02.00, there is also a compact mode! By adjusting the setting, the datalogger will output less at startup. This settings can be configured in the Settings/Application Settings page, under the Advanced section.</p> <p></p> <p>Compact Startup Mode Output</p>"},{"location":"system-operation/#logging-output","title":"Logging Output","text":"<p>Once the DataLogger IoT has initialized, the DataLogger IoT will begin outputting comma separated values (CSV). This is the default output that is set for the DataLogger IoT - 9DoF. Of course, you will not have as many readings on the DataLogger IoT since the 6DoF IMU and magnetometer are not populated on that version of the board.</p> <p></p> <p>CSV Output to the Serial Console</p> <p>Depending on your DataLogger IoT preferences, your device may output as a JSON format like the image shown below.</p> <p></p> <p>JSON Output to the Serial Console</p> <p>The data scrolling up the screen show what each device's output is along with their associated unit if it is available. Your mileage will vary depending on the board version that you have and what device is connected:</p> <ul> <li><code>MAX17048.Voltage (V)</code></li> <li><code>MAX17048.State of Charge (%)</code></li> <li><code>MAX17048.Charge Rate (%/hr)</code></li> <li><code>ISM330.Accel X (milli-g)</code></li> <li><code>ISM330.Accel Y (milli-g)</code></li> <li><code>ISM330.Accel Z (milli-g)</code></li> <li><code>ISM330.Gyro X (milli-dps)</code></li> <li><code>ISM330.Gyro Y (milli-dps)</code></li> <li><code>ISM330.Gyro Z (milli-dps)</code></li> <li><code>ISM330.Temperature (C)</code></li> <li><code>MMC5983.X Field (Gauss)</code></li> <li><code>MMC5983.Y Field (Gauss)</code></li> <li><code>MMC5983.Z Field (Gauss)</code></li> <li><code>MMC5983.Temperature (C)</code></li> </ul> <p>The output will vary depending on what is connected so you may get additional readings in the output and it may not be in the following order listed above. The logging rate defaults to about 0.067Hz (or 15000ms), so as the data scrolls past, you will see the last value settle at about 0.067Hz.</p>"},{"location":"system-operation/#settings-menu","title":"Settings Menu","text":"<p>Right! Let's open the main menu by pressing on any key in the serial terminal program.</p> <p> /// Main Menu ///</p> <p>You will be prompted with a few options. Once in the configuration menu, all three colors of the addressable RGB LED will turn on to produce the color white indicating that you are navigating through the menu.</p>"},{"location":"system-operation/#selecting-a-menu-item","title":"Selecting a Menu Item","text":"<p>Menus items are entered by pressing the number next to the menu item desired. For example, at the main menu, pressing <code>1</code> will bring up the overall Settings Menu. You will have the option to adjust various settings ranging from the your preferences, time source to synchronize the date and time, WiFi network, how the device logs data, which IoT service to use, and firmware updates.</p> <p></p> <p>The Settings Menu</p> <p>Note</p> <p>You may notice after entering a <code>1</code> with long menus there is a slight delay before the system responds. The delay was added to allow some time for an additional digit for any option greater than 9. If you want to head to option 1 immediately without the slight delay, you can hit the <code>Enter</code> key.</p> <p>Hitting the <code>ESC</code> returns to the previous menu. From here you can enter a <code>2</code> which brings up the Device menu - which lists all devices currently connected to the datalogger</p>"},{"location":"system-operation/#exiting-and-saving","title":"Exiting and Saving","text":"<p>When exiting the menus, you will be prompted with either an <code>x</code> or <code>b</code>. You can use either character when exiting the menus as well as <code>X</code> or <code>B</code>. Note that you will need to use either of these keys when making a change in order for the DataLogger IoT to save any changes in memory. Make sure that you receive the following message indicating that the settings were saved: <code>[I] Saving System Settings</code>. The DataLogger IoT will the continue reading the devices and outputting the readings through the serial terminal.</p> <p></p> <p>Save Settings When Exiting the Menu</p>"},{"location":"system-operation/#cancelling-changes","title":"Cancelling Changes","text":"<p>You can also use any of your <code>Esc</code> to exit. However, using the escape will not save any changes in memory once the reset button is hit or whenever power is cycled.</p> <p></p> <p>Escape to Exit a Menu</p>"},{"location":"system-operation/#timeout-from-inactivity","title":"Timeout from Inactivity","text":"<p>The menus will slowly exit out after 2 minutes of inactivity, so if you do not press a key the DataLogger IoT will return to its previous menu. It will continue to move back until it reaches the main menu. After another additional 2 minutes of inactivity, the board will exit begin logging data again. When the menu exits from inactivity, any changes will not be saved in memory as well.</p> <p></p> <p>Timeout in the Menu</p>"},{"location":"system-operation/#quick-commands","title":"Quick Commands","text":"<p>As of firmware v01.02.00, when not in the menu system, commands can be executed directly from the serial console - these are called quick commands. When you enter a <code>!</code>, you will see a prompt appear for quick command entry.</p> <p>The following commands are available:</p> Command Description !about Display the system about page !clear-settings Clear the on board system preferences with a yes/no prompt !clear-settings-forced Clear the on board system preferences with no prompt !devices List the currently connected devices !factory-reset Perform a factory reset - presents a Y/N prompt !heap Display the current system heap memory usage !json-settings For setting the device settings via a serial connection. When this command is sent, the system expects to receive a JSON settings file !log-now Perform a log observation event !log-rate If log rate measurement is enabled, the current log rate is printed !reset-device Reset the device - erasing any saved settings and restarting the device !reset-device-forced Reset the device, but without a Y/N prompt !restart Restart the device !restart-forced Restart the device without a Y/N prompt !save-settings Save the current settings to on-board flash !sdcard Output the current SD card usage statistics !systime Output current system time !uptime The uptime of the device !device-id The ID for the device !version The version of the firmware !wifi Output current system WiFi state <p>Typing a quick command and hitting the <code>Enter</code> button will result in the DataLogger IoT executing the command without the need to go through the menu system. Below is an example showing the <code>!about</code> quick command being sent and then executing the command as the DataLogger IoT is outputting CSV values to the serial terminal.</p> <p></p> <p>Enter a quick command</p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":""},{"location":"troubleshooting/#troubleshooting-and-support","title":"Troubleshooting and Support","text":""},{"location":"troubleshooting/#support","title":"Support","text":"<p>If you need technical assistance and more information on a product that is not working as you expected, visit the SparkFun Community. The community forums are monitored by the SparkFun Technical Support Team and the SparkFun community as a whole.</p>"},{"location":"troubleshooting/#issues-connecting-to-iot-service","title":"Issues Connecting to IoT Service","text":"<p>Having trouble connecting your DataLogger IoT to an IoT service? Make sure to check your credentials and ensure that the configuration matches the IoT Service (such as your WiFi network, port, server, topic, certificates, keys, etc. to name a few). Make sure to also include the associated certificates and keys in the microSD card as well. You may see an output similar to the following errors below.</p>"},{"location":"troubleshooting/#aws-iot-error","title":"AWS IoT Error","text":"<p>The following error occurred when the DataLogger IoT was initializing with AWS.</p> <pre><code>[W] AWS IoT disconnected - reconnecting.......[E] AWS IoT: MQTT connection failed. Error Code: -2\n</code></pre> <p></p> <p>In this case, the DataLogger IoT failed to connect to AWS IoT service because the port was using the default value that was saved: <code>1883</code>. Ensure that the port is set to <code>8883</code> for your IoT service (e.g. AWS IoT, Azure, and ThingSpeak) and saved in persistent memory in order for the DataLogger IoT to successfully connect. As of firmware v01.00.04, the default is <code>8883</code>.</p>"},{"location":"troubleshooting/#thinkspeak-iot-error","title":"ThinkSpeak IoT Error","text":"<p>The following error occurred when the DataLogger IoT was initializing with ThingSpeak.</p> <pre><code>[I] ThingSpeak MQTT: connecting to MQTT endpoint mqtt3.thingspeak.com:8883 .......[E] ThingSpeak MQTT: Connection Error [4]\n</code></pre> <p></p> <p>In this case, the DataLogger IoT failed to connect to ThingSpeak service because the credentials were entered incorrectly. Ensure that the  and saved in persistent memory in order for the DataLogger IoT to successfully connect.</p>"},{"location":"troubleshooting/#arduino-cloud-error-1","title":"Arduino Cloud Error 1","text":"<p>The following error was occurred when the DataLogger IoT was initializing with Arduino Cloud.</p> <pre><code>[W] ArduinoIoT - Thing Name not provided\n.\n.\n.\n[I] Arduino IoT: setup variables...[E] ArduinoIoT HTTP communication error [401] - token request\n[E] Arduino IoT Cloud not available or account credentials incorrect\n</code></pre> <p></p> <p>In this case, the DataLogger IoT failed to connect to the Arduino Cloud service because the credentials were incorrect. Ensure that the credentials (i.e. API client ID, API secret, device secret, device ID) are entered correctly and saved in persistent memory in order for the DataLogger IoT to successfully connect.</p>"},{"location":"troubleshooting/#arduino-cloud-error-2","title":"Arduino Cloud Error 2","text":"<p>The following error was occurred when the DataLogger IoT was initializing with Arduino Cloud.</p> <pre><code>[I] Arduino IoT: setup variables...[E] Arduino IoT: return code=400, failed to decode request body with content type \"application/json\": uuid: incorrect UUID length 37 in string \"a111aaa1-1111-1111-1a1a-1a11111a1111\\r\"\n</code></pre> <p>In this case, the DataLogger IoT failed to connect to the Arduino Cloud service because the credentials were incorrect. The string was supposed to be the device ID. When copying and pasting the device ID from a PDF that was generated with the Arduino Cloud, a carriage return (<code>\\r</code>) was also copied and entered in the serial terminal. By pasting the device ID into a text editor and then re-copying/pasting it into the serial terminal helped to ensure that the credentials were entered correctly.</p> <p>NOTE The device ID in this example was a randomly generated string. You will need to check to make sure that your device matches the one that the Arduino Cloud generated specifically for your account.</p>"},{"location":"troubleshooting/#arduino-cloud-error-3","title":"Arduino Cloud Error 3","text":"<p>The following error was occurred when the DataLogger IoT was initializing with Arduino Cloud.</p> <pre><code>[I] Arduino IoT: setup variables...ArduinoIoTCloudTCP::handle_ConnectMqttBroker could not connect to mqtts-up.iot.arduino.cc:8884\nArduinoIoTCloudTCP::handle_ConnectMqttBroker 1 connection attempt at tick time 301939\nArduinoIoTCloudTCP::handle_ConnectMqttBroker could not connect to mqtts-up.iot.arduino.cc:8884\nArduinoIoTCloudTCP::handle_ConnectMqttBroker 2 connection attempt at tick time 307420\n[E] Arduino IoT: No Arduino Thing ID provided. Enter ID, delete Thing (SparkFunThing1) on Cloud, or enter new Thing Name.\n</code></pre> <p>In this case, the DataLogger IoT failed to connect to the Arduino Cloud service because there was already a Thing that was created. By deleting the Thing in the Arduino Cloud, the DataLogger IoT was able to automatically create another Thing and setup the variables.</p>"},{"location":"troubleshooting/#thingspeak-data-points-not-updating","title":"ThingSpeak Data Points Not Updating","text":"<p>If your DataLogger IoT is connected to ThingSpeak but you do not see any data, ensure that the device name matches the Qwiic device that is connect to the DataLogger IoT. For example, the DataLogger IoT and Qwiic-enabled ENS160 was able to connect to ThingSpeak as shown in the following image:</p> <p></p> <p>However, there were no data points in any of the graphs as shown on ThingSpeak:</p> <p></p> <p>If you head back into the configuration menu for the DataLogger's ThingSpeak channel, make sure that the <code>&lt;device name&gt;</code> matches the connected Qwiic device's name that was shown during initialization.  In this case, the device that was loaded and detected was ENS160. Then add the channel ID before saving the system settings.</p> <p></p> <p>NOTE Only one device can be loaded per channel! ThingSpeak is not able graph two different devices in the same channel.</p> <p>Head back to your ThingSpeak Channel to verify that data is being plotted on the graphs.</p> <p></p>"},{"location":"troubleshooting/#u-blox-device-disappears-when-iot-datalogger-initializes","title":"U-Blox Device Disappears when IoT DataLogger Initializes","text":"<p>If you have issues where a u-blox device that is connected via qwiic fails to connect a second time when the IoT DataLogger initializes, this is due to a bug in the firmware from an initial release. You may see an output similar to the following message and image shown below.</p> <pre><code>[W] GNSS::isConnected no traffic seen (first attempt)\n</code></pre> <p></p> <p>If you see the following output and the IoT DataLogger not loading your u-blox device, you will need to update the firmware to v01.00.03 and above. For more information, make sure to check out the tutorial on updating your IoT DataLogger's firmware.</p>"},{"location":"javascript/","title":"javascript directory","text":"<p>This folder should contain the files for the custom javascript that is enabled in the product documentation</p>"},{"location":"relnotes/","title":"Latest DataLogger IoT Firmware Release Notes","text":"<ul> <li>Version 01.1.01 - Overview of the Release</li> <li>Version 01.2.00 - Overview of the Release</li> <li>Version 01.5.00 - Overview of the Release</li> </ul>"},{"location":"relnotes/rn_v010101/","title":"Rn v010101","text":""},{"location":"relnotes/rn_v010101/#sparkfun-datalogger-iot-firmware-version-11","title":"SparkFun DataLogger Iot Firmware - Version 1.1","text":"<p>November 11th, 2023</p> <p>Today we\u2019re releasing the latest firmware update for our line of DataLogger IoT products. While we\u2019ve released a services of small defect correct releases over the base 6 months, this release, officially version v1.01.00, is the first to include major new functionality.</p> <p>And with the release, we feel we\u2019ve covered all aspects of a 1.1 release \u2013 new functionality, feature enhancements, and a wide variety of bug fixes.  </p>"},{"location":"relnotes/rn_v010101/#new-feature-arduino-iot-cloud-connectivity","title":"New Feature \u2013 Arduino IoT Cloud Connectivity","text":"<p>Being an IoT focused product, one of our goals is to enable easy access to leading IoT data services. With this in mind, for this release we worked closely with the Arduino Team to enabled easy access to the Arduino IoT Cloud directly from a DataLogger IoT Device.</p> <p>Setup a device in the Arduino IoT Cloud, add the credentials to your DataLogger IoT and you have a IoT based dashboard up and running in minutes. Want to add an additional device to your dashboard \u2013 add the device to the DataLogger IoT and the combined system automatically adds the additional data to the Arduino Cloud \u2013 ready for use in your dashboard.</p> <p></p> <p>The above image shows data from a DataLogger IoT with an Environmental Combo attached to it and mapping data to a plot graphic on an Arduino IoT Cloud dashboard.</p> <p>And like all DataLogger IoT functionality, no programming is required to produces these plots \u2013 all settings are provided via the intuitive serial console menu interface or set via a settings JSON file.</p> <p>With the combination of the DataLogger IoT, qwiic and Arduino IoT Cloud, creating a IoT dashboard is as easy as Plug-in, Connect, Plot!</p>"},{"location":"relnotes/rn_v010101/#new-qwiic-sensor-board-support","title":"New qwiic Sensor Board Support","text":"<p>The original release of the DataLogger IoT firmware supported around 50 SparkFun qwiic development boards and with this release we\u2019ve added six boards additional qwiic boards.</p> <p>Selecting from our recently added qwiic products as well as from the list of popular products, the release of version 1.1 adds support for the following qwiic development boards.</p> <ul> <li>SparkFun Indoor Air Quality Sensor - ENS160</li> <li>SparkFun Photoacoustic Spectroscopy CO2 Sensor - PASCO2V01</li> <li>SparkFun Human Presence and Motion Sensor - STHS34PF80</li> <li>SparkFun Tristimulus Color Sensor - OPT4048DTSR</li> <li>SparkFun Triad Spectroscopy Sensor - AS7265x</li> <li>SparkFun 6DoF IMU Breakout - BMI270</li> </ul> <p>Like previously supported qwiic boards, the DataLogger IoT firmware automatically detects when a device is connected, making the new device automatically available to the logging, menu and IoT systems of the DataLogger IoT.</p> <p>All these new sensors are great adds on their own, but the ENS160 has the additional feature of supporting temperature and humidity calibration inputs. Connect an BME280 or an SHTC3 qwiic board along with an ENS160, and the DataLogger automatically connects the two devices!</p>"},{"location":"relnotes/rn_v010101/#feature-improvements","title":"Feature Improvements","text":"<p>In addition to the new functionality, we also took input from our customers (and our own use) to expand and enhance existing features. While a wide variety of small additions were made, a few notable additions include:</p> <p>Improved Reference Clock Management \u2013 the internal logic was reviewed and improved. Additionally, time zone support was moved out of the NTP system, and into the overall clock management subsystem.</p> <p>Internal JSON Buffer Limits \u2013 The initial firmware had fixed sizes for the internal JSON data buffers used for saving settings and log data output. These values are now user settable in the settings menu. This allows for larger buffer support, as well as reducing the internal buffers to what you need.</p> <p>Add Device IDs to the Device Names \u2013 As you add more devices to a DataLogger, it\u2019s difficult to match the device to the actual devices address. Addresses are now included in device listings and the option to include the address in the device name is now available.</p> <p>Board Information in the Log Stream \u2013 To improve identification of a data source within the data log stream, the Board Name and Board ID can now be added if desired. As part of this functionality, a configurable name is now available for each DataLogger IoT.</p>"},{"location":"relnotes/rn_v010101/#bug-fixes","title":"Bug Fixes","text":"<p>We also squashed a variety of defects in the firmware. Some of the more notable issued fixed in this release:</p> <ul> <li>Incorporated a fix in the RV8803 RTC Clock Arduino Library that resolved force ti*  shifts based on time zone. This was a \u201creal nasty one\u201d to resolve!</li> <li>Improved runtime memory (ram) consumption</li> <li>Resolved issues with devices having the same name. Now the second device adds it*  address to the name.</li> <li>Improvements to the Machinechat IoT driver</li> </ul>"},{"location":"relnotes/rn_v010101/#in-summary","title":"In Summary","text":"<p>With the release of DataLogger IoT firmware version 1.1.0 we continue to enhance the capabilities of our DataLogger IoT line \u2013 adding to our IOT service, supported devices as well as improving the overall quality of the system.</p> <p>And this new functionality is available today at the DataLogger repo.  The update is free, available as an over-the-air upgrade, or as a file uploaded via an SD Card.  Just select the \u201cSystem Update\u201d option within the DataLogger IoT menu system and select your desired upgrade option.</p>"},{"location":"relnotes/rn_v010200/","title":"Rn v010200","text":""},{"location":"relnotes/rn_v010200/#sparkfun-datalogger-iot-firmware-version-12","title":"SparkFun DataLogger IoT Firmware - Version 1.2","text":"<p>April 15th, 2024_</p> <p>With the release of our version 1.2 software for our DataLogger IoT products, we continue to add additional functionally to the products capability, as well as fix a number of issues.</p> <p>And with the release, we feel we\u2019ve covered all aspects of a 1.1 release \u2013 new functionality, feature enhancements, and a wide variety of bug fixes.  </p>"},{"location":"relnotes/rn_v010200/#new-features-and-enhancements","title":"New Features and Enhancements","text":""},{"location":"relnotes/rn_v010200/#log-file-download-via-a-web-interface","title":"Log File Download via a Web Interface","text":"<p>To allow access to log files located on the DataLogger IoT device, without requiring the removal of the SD card, a new Web Interface is provided. Once enabled, you can browse the on-board log files of the DataLogger. Clicking on a a filename will download the file.</p> <p></p> <p>Currently file browse and download options are available, but we plan on expanding this feature in the future.</p> <p>Additionally, this feature has the following options:</p> <ul> <li>mDNS functionality allowing you to set a network name for a device if mDNS is supported on your network</li> <li>Username/Password authentication for the web interface.</li> </ul> <p>Note: For authentication use - currently some browsers might require a second login depending on settings.</p> <p>Note: The datalogger requires restarting if the web interface is enabled</p> <p>This feature is enabled in settings under the Preview heading.</p>"},{"location":"relnotes/rn_v010200/#startup-command-menu-and-delay","title":"Startup Command Menu and Delay","text":"<p>To allow start-up time configuration and delay, a Startup Menu was added to the system. Now, at startup a short menu is presented for a brief period, allowing modification of the startup options of the DataLogger.</p> <p>Startup Menu options:</p> <p>Pressing the highlighted letter while the menu is active, will change the behavior of the system. This change only affects the current system session.</p> <p>The options include:</p> <ul> <li>'n' - Normal startup</li> <li>'a' - Disable I2C device auto load on startup</li> <li>'l' - List the I2C devices supported. This device table is discarded after auto-load</li> <li>'w' - Disable WiFi</li> <li>'s' - Disable preference restore during startup</li> </ul> <p>In addition, the amount of time the menu is displayed is adjustable.  This settings is on the Settings/Application Settings page, under the Advanced section.</p>"},{"location":"relnotes/rn_v010200/#quick-commands","title":"Quick (!) Commands","text":"<p>The addition of a quick (!) command system that allows for the direct execution of commands directly from the serial console, bypassing the serial menu system.</p> <p>An example of this is the display of the \"about\" page for the system. Normally this would require navigating the serial menu system. With the quick command system, entering the value of \"!about\" at the serial console will display the about page.</p> <p>The following commands are supported:</p> command Description !about Display the system about page !clear-settings Clear the on board system preferences with a yes/no prompt !clear-settings-forced Clear the on board system preferences with no prompt !devices List the currently connected devices !factory-reset Perform a factory reset - presents a Y/N prompt !heap Display the current system heap memory usage !help List the available quick commands !json-settings For setting the device settings via a serial connection. When this command is sent, the system expects to receive a JSON settings file !log-now Perform a log observation event !log-rate If log rate measurement is enabled, the current log rate is printed !reset-device Reset the device - erasing any saved settings and restarting the device !reset-device-forced Reset the device, but without a Y/N prompt !restart Restart the device !restart-forced Restart the device without a Y/N prompt !save-settings Save the current settings to on-board flash !sdcard Output the current SD card usage statistics !systime Output current system time !uptime The uptime of the device !device-id The ID for the device !version The version of the firmware !wifi Output current system WiFi state"},{"location":"relnotes/rn_v010200/#log-data-rate","title":"Log Data Rate","text":"<p>The DataLogger system can now measure the data logging rate. Once this feature is enabled, the system will monitor the time between log events. This value is averaged over the latest 10 log events.</p>"},{"location":"relnotes/rn_v010200/#system-info-in-the-log-stream","title":"System Info in the log stream","text":"<p>The system operational parameters can now be added to log stream. This is useful to monitor system resource uses over time, or just perform general debugging.</p> <p>Currently the following information is provided:</p> <ul> <li>WiFi SSID</li> <li>WiFi RSSI</li> <li>Memory Heap free space in bytes</li> <li>SD Card free space in bytes</li> <li>Uptime in MS</li> </ul>"},{"location":"relnotes/rn_v010200/#feature-improvements","title":"Feature Improvements","text":"<p>In addition to the new functionality, we also took input from our customers (and our own use) to expand and enhance existing features. While a wide variety of small additions were made, a few notable additions include:</p> <p>Serial Console - Value Display \u2013 The serial console now shows the current setting value in the menu system. Previously this value was only show once that item was selected.</p> <p>Serial Console Color \u2013 Text highlighting and color were added to the serial console output. If your serial console application/command supports it, the menu system highlights key values. This setting is controlled in the Settings/Application Settings section of the settings menu.</p> <p>Startup Messages \u2013 Normally a verbose log of startup options and settings are displayed at system startup. The about of information is now controllable - with values of Normal, Compact, Disabled.</p> <p>Improved Device Auto-Load \u2013 A major update to the I2C auto-load device detection logic that improves device detection and address collision prevention.</p> <p>General System Enhancements \u2013 Internal system job dispatch subsystem update to increase performance throughput. Overall decrease in static and dynamic memory usage.</p>"},{"location":"relnotes/rn_v010200/#bug-fixes","title":"Bug Fixes","text":"<p>We also squashed a variety of defects in the firmware. Some of the more notable issued fixed in this release:</p> <ul> <li>Fixed issue with the LED display logic that caused a system crash if the log interval was less than 100ms</li> <li>Incorporate driver updates for greater NAU7802 device output value stability</li> <li>Incorporate driver update for the MMC5983MA device</li> </ul>"},{"location":"relnotes/rn_v010200/#in-summary","title":"In Summary","text":"<p>With the release of DataLogger IoT firmware version 1.2.0 we continue to enhance the capabilities of our DataLogger IoT line \u2013 adding to our IOT service, supported devices as well as improving the overall quality of the system.</p> <p>And this new functionality is available today at the DataLogger repo.  The update is free, available as an over-the-air upgrade, or as a file uploaded via an SD Card.  Just select the \u201cSystem Update\u201d option within the DataLogger IoT menu system and select your desired upgrade option.</p>"},{"location":"relnotes/rn_v010500/","title":"Rn v010500","text":""},{"location":"relnotes/rn_v010500/#sparkfun-datalogger-iot-firmware-version-15","title":"SparkFun DataLogger IoT Firmware - Version 1.5","text":"<p>January 2026</p>"},{"location":"relnotes/rn_v010500/#new-features-and-enhancements","title":"New Features and Enhancements","text":""},{"location":"relnotes/rn_v010500/#new-device-support","title":"New Device Support","text":"<p>Support for the following new SparkFun qwiic devices</p> <ul> <li>SparkFun Air Quality PM1/PM2.5/PM10 Sensor - BMV080 (Qwiic)</li> <li>SparkFun Spectral Sensor - AS7343 (Qwiic)</li> </ul>"},{"location":"relnotes/rn_v010500/#uart-data-logging","title":"UART Data Logging","text":"<p>Connect an external uart/serial device to the DataLogger IoT board and any input recieved from that device is output within the current logging stream (Serial console, SD Card, IoT endpoint ...)</p>"},{"location":"relnotes/rn_v010500/#log-values-from-an-analog-pin","title":"Log Values from an Analog Pin","text":"<p>Connect an anlog device/sensor to a specified DataLogger GPIO pin and the data value is written to the current log stream/output.</p>"},{"location":"relnotes/rn_v010500/#support-for-the-sparkfun-analog-soil-mosture-sensor","title":"Support for the SparkFun Analog Soil Mosture Sensor","text":"<p>Connect the SparkFun Soil Moisture Sensor to the specified/selected (via menu system) GPIO pins of the DataLogger IoT board and the senor values are output to the output log stream.</p> <p>Note - the qwiic Soil Moisture Sensor is not supported by the DataLogger IoT due to I2C bus incompatablity (i2c clock stretching)</p>"},{"location":"relnotes/rn_v010500/#trigger-logging-via-interrupt","title":"Trigger Logging via Interrupt","text":"<p>When enabled, with an interrupt connected to a specified (in the menu system) DataLogger IoT GPIO pin, a logging event is triggered when the interrupt is fired.</p>"},{"location":"relnotes/rn_v010500/#trigger-logging-using-the-pps-signal-from-a-gnss-device","title":"Trigger Logging using the PPS signal from a GNSS device","text":"<p>When enabld and the GNSS device PPS signal is connected to a specified GPIO pin on the DataLogger IoT, a logging event is triggered when the PPS signal is sent.</p>"},{"location":"relnotes/rn_v010500/#general-improvements","title":"General Improvements","text":"<ul> <li>Fixed issues with the ISO8601 date formatting in the logging system</li> <li>Improved support for verbose logging via the menu system</li> <li>Fixed issue with epoch tick output values</li> <li>Can now add the log-event trigger source to the log-stream output.</li> </ul> <p>And this new functionality is available today at the DataLogger repo as a beta release.  The update is free, available as a file uploaded via an SD Card.  Just select the \u201cSystem Update\u201d option within the DataLogger IoT menu system and select your desired upgrade option.</p>"}]}